/shared/nas/data/m1/jk100/.conda/envs/llava/lib/python3.10/site-packages/torch/nn/modules/transformer.py:306: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")

Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.89s/it]
Some weights of PLUMForCausalLM were not initialized from the model checkpoint at /shared/nas2/jk100/partonomy_private/weights/liuhaotian/llava-llama-2-7b-chat-lightning-lora-preview and are newly initialized: ['bio_encoder.encoder.layers.0.linear1.bias', 'bio_encoder.encoder.layers.0.linear2.bias', 'bio_encoder.encoder.layers.0.linear2.weight', 'bio_encoder.encoder.layers.0.self_attn.in_proj_weight', 'bio_encoder.encoder.layers.0.self_attn.out_proj.bias', 'bio_encoder.encoder.layers.0.norm1.weight', 'bio_encoder.encoder.layers.0.self_attn.out_proj.weight', 'bio_encoder.encoder.layers.0.self_attn.in_proj_bias', 'bio_encoder.encoder.layers.0.norm2.bias', 'bio_encoder.encoder.layers.0.norm2.weight', 'bio_encoder.encoder.layers.0.norm1.bias', 'bio_encoder.encoder.layers.0.linear1.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
trainable params: 4,194,304 || all params: 7,809,627,443 || trainable%: 0.05370683852223295
n:  base_model.model.model.embed_tokens.weight p.shape:  torch.Size([32002, 4096])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.q_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.q_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.k_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.k_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.v_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.v_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.out_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.self_attn.out_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm1.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm1.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.q_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.q_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.k_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.k_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.v_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.v_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.out_proj.weight p.shape:  torch.Size([256, 128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_token_to_image.out_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm2.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm2.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.mlp.lin1.weight p.shape:  torch.Size([2048, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.mlp.lin1.bias p.shape:  torch.Size([2048])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.mlp.lin2.weight p.shape:  torch.Size([256, 2048])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.mlp.lin2.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm3.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm3.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm4.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.norm4.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.q_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.q_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.k_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.k_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.v_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.v_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.out_proj.weight p.shape:  torch.Size([256, 128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.0.cross_attn_image_to_token.out_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.q_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.q_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.k_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.k_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.v_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.v_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.out_proj.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.self_attn.out_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm1.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm1.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.q_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.q_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.k_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.k_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.v_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.v_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.out_proj.weight p.shape:  torch.Size([256, 128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_token_to_image.out_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm2.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm2.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.mlp.lin1.weight p.shape:  torch.Size([2048, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.mlp.lin1.bias p.shape:  torch.Size([2048])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.mlp.lin2.weight p.shape:  torch.Size([256, 2048])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.mlp.lin2.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm3.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm3.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm4.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.norm4.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.q_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.q_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.k_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.k_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.v_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.v_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.out_proj.weight p.shape:  torch.Size([256, 128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.layers.1.cross_attn_image_to_token.out_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.q_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.q_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.k_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.k_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.v_proj.weight p.shape:  torch.Size([128, 256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.v_proj.bias p.shape:  torch.Size([128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.out_proj.weight p.shape:  torch.Size([256, 128])
n:  base_model.model.model.visual_model.mask_decoder.transformer.final_attn_token_to_image.out_proj.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.norm_final_attn.weight p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.transformer.norm_final_attn.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.iou_token.weight p.shape:  torch.Size([1, 256])
n:  base_model.model.model.visual_model.mask_decoder.mask_tokens.weight p.shape:  torch.Size([4, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_upscaling.0.weight p.shape:  torch.Size([256, 64, 2, 2])
n:  base_model.model.model.visual_model.mask_decoder.output_upscaling.0.bias p.shape:  torch.Size([64])
n:  base_model.model.model.visual_model.mask_decoder.output_upscaling.1.weight p.shape:  torch.Size([64])
n:  base_model.model.model.visual_model.mask_decoder.output_upscaling.1.bias p.shape:  torch.Size([64])
n:  base_model.model.model.visual_model.mask_decoder.output_upscaling.3.weight p.shape:  torch.Size([64, 32, 2, 2])
n:  base_model.model.model.visual_model.mask_decoder.output_upscaling.3.bias p.shape:  torch.Size([32])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.0.layers.0.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.0.layers.0.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.0.layers.1.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.0.layers.1.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.0.layers.2.weight p.shape:  torch.Size([32, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.0.layers.2.bias p.shape:  torch.Size([32])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.1.layers.0.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.1.layers.0.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.1.layers.1.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.1.layers.1.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.1.layers.2.weight p.shape:  torch.Size([32, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.1.layers.2.bias p.shape:  torch.Size([32])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.2.layers.0.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.2.layers.0.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.2.layers.1.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.2.layers.1.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.2.layers.2.weight p.shape:  torch.Size([32, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.2.layers.2.bias p.shape:  torch.Size([32])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.3.layers.0.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.3.layers.0.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.3.layers.1.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.3.layers.1.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.3.layers.2.weight p.shape:  torch.Size([32, 256])
n:  base_model.model.model.visual_model.mask_decoder.output_hypernetworks_mlps.3.layers.2.bias p.shape:  torch.Size([32])
n:  base_model.model.model.visual_model.mask_decoder.iou_prediction_head.layers.0.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.iou_prediction_head.layers.0.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.iou_prediction_head.layers.1.weight p.shape:  torch.Size([256, 256])
n:  base_model.model.model.visual_model.mask_decoder.iou_prediction_head.layers.1.bias p.shape:  torch.Size([256])
n:  base_model.model.model.visual_model.mask_decoder.iou_prediction_head.layers.2.weight p.shape:  torch.Size([4, 256])
n:  base_model.model.model.visual_model.mask_decoder.iou_prediction_head.layers.2.bias p.shape:  torch.Size([4])
n:  base_model.model.model.text_hidden_fcs.0.0.weight p.shape:  torch.Size([4096, 4096])
n:  base_model.model.model.text_hidden_fcs.0.0.bias p.shape:  torch.Size([4096])
n:  base_model.model.model.text_hidden_fcs.0.2.weight p.shape:  torch.Size([256, 4096])
n:  base_model.model.model.text_hidden_fcs.0.2.bias p.shape:  torch.Size([256])
n:  base_model.model.model.token_to_mask_fcs.0.0.weight p.shape:  torch.Size([4096, 4096])
n:  base_model.model.model.token_to_mask_fcs.0.0.bias p.shape:  torch.Size([4096])
n:  base_model.model.model.token_to_mask_fcs.0.2.weight p.shape:  torch.Size([3, 4096])
n:  base_model.model.model.token_to_mask_fcs.0.2.bias p.shape:  torch.Size([3])
n:  base_model.model.lm_head.weight p.shape:  torch.Size([32002, 4096])
n:  base_model.model.bio_encoder.encoder.layers.0.self_attn.in_proj_weight p.shape:  torch.Size([12288, 4096])
n:  base_model.model.bio_encoder.encoder.layers.0.self_attn.in_proj_bias p.shape:  torch.Size([12288])
n:  base_model.model.bio_encoder.encoder.layers.0.self_attn.out_proj.weight p.shape:  torch.Size([4096, 4096])
n:  base_model.model.bio_encoder.encoder.layers.0.self_attn.out_proj.bias p.shape:  torch.Size([4096])
n:  base_model.model.bio_encoder.encoder.layers.0.linear1.weight p.shape:  torch.Size([2048, 4096])
n:  base_model.model.bio_encoder.encoder.layers.0.linear1.bias p.shape:  torch.Size([2048])
n:  base_model.model.bio_encoder.encoder.layers.0.linear2.weight p.shape:  torch.Size([4096, 2048])
n:  base_model.model.bio_encoder.encoder.layers.0.linear2.bias p.shape:  torch.Size([4096])
n:  base_model.model.bio_encoder.encoder.layers.0.norm1.weight p.shape:  torch.Size([4096])
n:  base_model.model.bio_encoder.encoder.layers.0.norm1.bias p.shape:  torch.Size([4096])
n:  base_model.model.bio_encoder.encoder.layers.0.norm2.weight p.shape:  torch.Size([4096])
n:  base_model.model.bio_encoder.encoder.layers.0.norm2.bias p.shape:  torch.Size([4096])
ade20k:  20210
cocostuff:  118287
loading annotations into memory...
Done (t=0.51s)
creating index...
index created!
pascal_part:  4366
loading annotations into memory...
Done (t=7.35s)
creating index...
index created!
paco_lvis:  45790
mapillary:  18000
loading dataset refclef into memory...
ref_file:  /shared/nas/data/m1/jk100/code/OpenAttrLibrary/LISA/dataset/refer_seg/refclef/refs(unc).p
creating index...
index created.
DONE (t=2.58s)
dataset refclef (refs unc) (train split) has 17978 images and 99523 annotations.
loading dataset refcoco into memory...
ref_file:  /shared/nas/data/m1/jk100/code/OpenAttrLibrary/LISA/dataset/refer_seg/refcoco/refs(unc).p
creating index...
index created.
DONE (t=4.97s)
dataset refcoco (refs unc) (train split) has 16994 images and 196771 annotations.
loading dataset refcoco+ into memory...
ref_file:  /shared/nas/data/m1/jk100/code/OpenAttrLibrary/LISA/dataset/refer_seg/refcoco+/refs(unc).p
creating index...
index created.
DONE (t=5.82s)
dataset refcoco+ (refs unc) (train split) has 16992 images and 196737 annotations.
loading dataset refcocog into memory...
ref_file:  /shared/nas/data/m1/jk100/code/OpenAttrLibrary/LISA/dataset/refer_seg/refcocog/refs(umd).p
creating index...
index created.
DONE (t=3.34s)
dataset refcocog (refs umd) (train split) has 21899 images and 208960 annotations.
vqa_data:  157712
number of reason_seg samples:  239
len(self.img_to_explanation):  239
Training with 10000 examples and validating with 200 examples.
[2025-04-04 18:39:13,450] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.9.5, git-hash=unknown, git-branch=unknown
[2025-04-04 18:39:13,450] [WARNING] [comm.py:152:init_deepspeed_backend] NCCL backend in DeepSpeed not yet implemented
[2025-04-04 18:39:13,450] [INFO] [comm.py:594:init_distributed] cdb=None
[2025-04-04 18:39:13,451] [INFO] [comm.py:625:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-04-04 18:39:26,433] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /shared/nas/data/m1/jk100/.cache/torch_extensions/py310_cu118 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /shared/nas/data/m1/jk100/.cache/torch_extensions/py310_cu118/fused_adam/build.ninja...
/shared/nas/data/m1/jk100/.conda/envs/llava/lib/python3.10/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation.
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Loading extension module fused_adam...
/shared/nas/data/m1/jk100/.conda/envs/llava/lib/python3.10/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/conda/conda-bld/pytorch_1712608839953/work/torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Time to load fused_adam op: 0.5629034042358398 seconds
[2025-04-04 18:39:27,196] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-04-04 18:39:27,367] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-04-04 18:39:27,368] [INFO] [utils.py:54:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-04-04 18:39:27,368] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2025-04-04 18:39:27,368] [INFO] [stage_1_and_2.py:133:__init__] Reduce bucket size 500000000
[2025-04-04 18:39:27,368] [INFO] [stage_1_and_2.py:134:__init__] Allgather bucket size 500000000
[2025-04-04 18:39:27,368] [INFO] [stage_1_and_2.py:135:__init__] CPU Offload: False
[2025-04-04 18:39:27,368] [INFO] [stage_1_and_2.py:136:__init__] Round robin gradient partitioning: False
Rank: 0 partition count [1] and sizes[(388961768, False)]
[2025-04-04 18:39:31,670] [INFO] [utils.py:785:see_memory_usage] Before initializing optimizer states
[2025-04-04 18:39:31,671] [INFO] [utils.py:786:see_memory_usage] MA 16.03 GB         Max_MA 16.75 GB         CA 17.12 GB         Max_CA 17 GB
[2025-04-04 18:39:31,671] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 167.98 GB, percent = 16.7%
[2025-04-04 18:39:34,903] [INFO] [utils.py:785:see_memory_usage] After initializing optimizer states
[2025-04-04 18:39:34,904] [INFO] [utils.py:786:see_memory_usage] MA 18.93 GB         Max_MA 20.38 GB         CA 21.47 GB         Max_CA 21 GB
[2025-04-04 18:39:34,904] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 167.9 GB, percent = 16.7%
[2025-04-04 18:39:34,905] [INFO] [stage_1_and_2.py:488:__init__] optimizer state initialized
[2025-04-04 18:39:37,769] [INFO] [utils.py:785:see_memory_usage] After initializing ZeRO optimizer
[2025-04-04 18:39:37,770] [INFO] [utils.py:786:see_memory_usage] MA 18.93 GB         Max_MA 18.93 GB         CA 21.47 GB         Max_CA 21 GB
[2025-04-04 18:39:37,770] [INFO] [utils.py:793:see_memory_usage] CPU Virtual Memory:  used = 167.84 GB, percent = 16.7%
[2025-04-04 18:39:37,776] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adamw
[2025-04-04 18:39:37,776] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupDecayLR
[2025-04-04 18:39:37,776] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupDecayLR object at 0x7f84cb08e260>
[2025-04-04 18:39:37,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0003], mom=[(0.9, 0.95)]
[2025-04-04 18:39:37,779] [INFO] [config.py:960:print] DeepSpeedEngine configuration:
[2025-04-04 18:39:37,779] [INFO] [config.py:964:print]   activation_checkpointing_config  {
    "partition_activations": false,
    "contiguous_memory_optimization": false,
    "cpu_checkpointing": false,
    "number_checkpoints": null,
    "synchronize_checkpoint_boundary": false,
    "profile": false
}
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   amp_enabled .................. False
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   amp_params ................... False
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   autotuning_config ............ {
    "enabled": false,
    "start_step": null,
    "end_step": null,
    "metric_path": null,
    "arg_mappings": null,
    "metric": "throughput",
    "model_info": null,
    "results_dir": "autotuning_results",
    "exps_dir": "autotuning_exps",
    "overwrite": true,
    "fast": true,
    "start_profile_step": 3,
    "end_profile_step": 5,
    "tuner_type": "gridsearch",
    "tuner_early_stopping": 5,
    "tuner_num_trials": 50,
    "model_info_path": null,
    "mp_size": 1,
    "max_train_batch_size": null,
    "min_train_batch_size": 1,
    "max_train_micro_batch_size_per_gpu": 1.024000e+03,
    "min_train_micro_batch_size_per_gpu": 1,
    "num_tuning_micro_batch_sizes": 3
}
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   bfloat16_enabled ............. True
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   checkpoint_parallel_write_pipeline  False
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   checkpoint_tag_validation_enabled  True
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   checkpoint_tag_validation_fail  False
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f827e55f280>
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   communication_data_type ...... None
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   curriculum_enabled_legacy .... False
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   curriculum_params_legacy ..... False
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-04-04 18:39:37,780] [INFO] [config.py:964:print]   data_efficiency_enabled ...... False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   dataloader_drop_last ......... False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   disable_allgather ............ False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   dump_state ................... False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   dynamic_loss_scale_args ...... None
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_enabled ........... False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_gas_boundary_resolution  1
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_layer_num ......... 0
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_max_iter .......... 100
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_stability ......... 1e-06
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_tol ............... 0.01
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   eigenvalue_verbose ........... False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   elasticity_enabled ........... False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   flops_profiler_config ........ {
    "enabled": false,
    "recompute_fwd_factor": 0.0,
    "profile_step": 1,
    "module_depth": -1,
    "top_modules": 1,
    "detailed": true,
    "output_file": null
}
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   fp16_auto_cast ............... None
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   fp16_enabled ................. False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   fp16_master_weights_and_gradients  False
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   global_rank .................. 0
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   grad_accum_dtype ............. None
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   gradient_accumulation_steps .. 10
[2025-04-04 18:39:37,781] [INFO] [config.py:964:print]   gradient_clipping ............ 1.0
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   gradient_predivide_factor .... 1.0
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   initial_dynamic_scale ........ 1
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   load_universal_checkpoint .... False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   loss_scale ................... 1.0
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   memory_breakdown ............. False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   mics_hierarchial_params_gather  False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   mics_shard_size .............. -1
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   nebula_config ................ {
    "enabled": false,
    "persistent_storage_path": null,
    "persistent_time_interval": 100,
    "num_of_version_in_retention": 2,
    "enable_nebula_load": true,
    "load_path": null
}
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   optimizer_legacy_fusion ...... False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   optimizer_name ............... adamw
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   optimizer_params ............. {'lr': 0.0003, 'weight_decay': 0.0, 'betas': (0.9, 0.95)}
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   pld_enabled .................. False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   pld_params ................... False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   prescale_gradients ........... False
[2025-04-04 18:39:37,782] [INFO] [config.py:964:print]   scheduler_name ............... WarmupDecayLR
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   scheduler_params ............. {'total_num_steps': 25000, 'warmup_min_lr': 0, 'warmup_max_lr': 0.0003, 'warmup_num_steps': 100, 'warmup_type': 'linear'}
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   sparse_attention ............. None
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   sparse_gradients_enabled ..... False
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   steps_per_print .............. 10
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   train_batch_size ............. 20
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   train_micro_batch_size_per_gpu  2
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   use_node_local_storage ....... False
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   wall_clock_breakdown ......... False
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   world_size ................... 1
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   zero_allow_untested_optimizer  False
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   zero_enabled ................. True
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   zero_force_ds_cpu_optimizer .. True
[2025-04-04 18:39:37,783] [INFO] [config.py:964:print]   zero_optimization_stage ...... 2
[2025-04-04 18:39:37,783] [INFO] [config.py:950:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2,
    "gradient_accumulation_steps": 10,
    "optimizer": {
        "type": "AdamW",
        "params": {
            "lr": 0.0003,
            "weight_decay": 0.0,
            "betas": [0.9, 0.95]
        }
    },
    "scheduler": {
        "type": "WarmupDecayLR",
        "params": {
            "total_num_steps": 2.500000e+04,
            "warmup_min_lr": 0,
            "warmup_max_lr": 0.0003,
            "warmup_num_steps": 100,
            "warmup_type": "linear"
        }
    },
    "fp16": {
        "enabled": false
    },
    "bf16": {
        "enabled": true
    },
    "gradient_clipping": 1.0,
    "zero_optimization": {
        "stage": 2,
        "contiguous_gradients": true,
        "overlap_comm": true,
        "reduce_scatter": true,
        "reduce_bucket_size": 5.000000e+08,
        "allgather_bucket_size": 5.000000e+08
    }
}
(train) >> AFTER DEEPSPEED
>> (train) Auto-resume from:  ./runs/plum-7b_kld_0_dice_0_v1_partonomy/plum-7b_kld_0_dice_0_v1_partonomy_accum_10_maxlen512_epochs50_segloss_0_bce_loss_2_kld_loss_0_dice_loss_0_bidir_bio_ckpt_model
>> (train) resume exists:  False
/shared/nas/data/m1/jk100/.conda/envs/llava/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Applied workaround for CuDNN issue, install nvrtc.so (Triggered internally at /opt/conda/conda-bld/pytorch_1712608839953/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:84.)
  return F.conv2d(input, weight, bias, self.stride,
/shared/nas/data/m1/jk100/.conda/envs/llava/lib/python3.10/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/shared/nas/data/m1/jk100/.conda/envs/llava/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at /opt/conda/conda-bld/pytorch_1712608839953/work/torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/shared/nas/data/m1/jk100/.conda/envs/llava/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608839953/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2448, 3264]) | end - start: 5
mask_positions_in_input_ids:  [[323], [321], [323], [327], [320], [317], [319], [320], [319], [319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 321, 408]) | end - start: 5
mask_positions_in_input_ids:  [[323], [321], [323], [327], [320], [317], [319], [320], [319], [319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 321, 408])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 321, 408])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 321, 408])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 321, 408])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 321, 408])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 376, 500]) | end - start: 5
mask_positions_in_input_ids:  [[320], [322], [322], [323], [323], [321], [322], [319], [326], [321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 376, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 376, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 376, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 376, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 376, 500])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 375, 500]) | end - start: 5
mask_positions_in_input_ids:  [[320], [322], [322], [323], [323], [321], [322], [319], [326], [321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> offset:  tensor([0, 5, 6], device='cuda:0')
>> is_mask_per_conv: False | masks_list[batch_idx].shape: torch.Size([0, 1552, 2592]) | end - start: 5
mask_positions_in_input_ids:  [[], [], [], [], [], []]
>> offset:  tensor([0, 5, 6], device='cuda:0')
>> is_mask_per_conv: False | masks_list[batch_idx].shape: torch.Size([0, 427, 640]) | end - start: 1
mask_positions_in_input_ids:  [[], [], [], [], [], []]
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 360, 640]) | end - start: 5
mask_positions_in_input_ids:  [[321], [323], [321], [318], [320], [350], [347], [348], [352], []]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 360, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 360, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 360, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 360, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 360, 640])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 4224, 3000]) | end - start: 5
mask_positions_in_input_ids:  [[321], [323], [321], [318], [320], [350], [347], [348], [352], []]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 4224, 3000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 4224, 3000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 4224, 3000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 4224, 3000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 4224, 3000])
>> offset:  tensor([0, 5, 6], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2160, 3840]) | end - start: 5
mask_positions_in_input_ids:  [[320], [317], [320], [317], [319], []]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2160, 3840])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2160, 3840])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2160, 3840])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2160, 3840])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2160, 3840])
>> offset:  tensor([0, 5, 6], device='cuda:0')
>> is_mask_per_conv: False | masks_list[batch_idx].shape: torch.Size([0, 480, 640]) | end - start: 1
mask_positions_in_input_ids:  [[320], [317], [320], [317], [319], []]
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2448, 3264]) | end - start: 5
mask_positions_in_input_ids:  [[322], [319], [321], [320], [], [319], [321], [316], [321], [318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 640, 425]) | end - start: 5
mask_positions_in_input_ids:  [[322], [319], [321], [320], [], [319], [321], [316], [321], [318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 425])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 425])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 425])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 425])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 425])
>> offset:  tensor([0, 2, 7], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([2, 427, 640]) | end - start: 2
mask_positions_in_input_ids:  [[324], [323], [368], [357], [351], [353], [349]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 427, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 427, 640])
>> offset:  tensor([0, 2, 7], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 533, 685]) | end - start: 5
mask_positions_in_input_ids:  [[324], [323], [368], [357], [351], [353], [349]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 685])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 685])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 685])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 685])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 685])
>> offset:  tensor([0, 5, 8], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2592, 3888]) | end - start: 5
mask_positions_in_input_ids:  [[339], [341], [341], [339], [341], [330], [333], [322]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 3888])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 3888])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 3888])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 3888])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 3888])
>> offset:  tensor([0, 5, 8], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([3, 640, 426]) | end - start: 3
mask_positions_in_input_ids:  [[339], [341], [341], [339], [341], [330], [333], [322]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2988, 3984]) | end - start: 5
mask_positions_in_input_ids:  [[320], [317], [316], [318], [319], [348], [347], [350], [350], [347]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2988, 3984])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2988, 3984])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2988, 3984])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2988, 3984])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2988, 3984])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 612, 612]) | end - start: 5
mask_positions_in_input_ids:  [[320], [317], [316], [318], [319], [348], [347], [350], [350], [347]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 612, 612])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 612, 612])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 612, 612])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 612, 612])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 612, 612])
>> offset:  tensor([0, 1, 6], device='cuda:0')
>> is_mask_per_conv: False | masks_list[batch_idx].shape: torch.Size([0, 375, 500]) | end - start: 1
mask_positions_in_input_ids:  [[], [319], [320], [319], [320], [318]]
>> offset:  tensor([0, 1, 6], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 630, 472]) | end - start: 5
mask_positions_in_input_ids:  [[], [319], [320], [319], [320], [318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 630, 472])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 630, 472])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 630, 472])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 630, 472])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 630, 472])
Epoch: [0][  1/500]	Time 21.088 (21.088)	Loss 0.2118 (0.3013)	CeLoss 0.1650 (0.1844)	SegCLSLoss 0.1465 (0.1273)	KLLoss 0.0000 (0.0000)	MaskLoss 0.1214 (0.1391)	MaskBCELoss 0.0235 (0.0585)	MaskDICELoss 0.0980 (0.0806)
>> offset:  tensor([0, 1, 6], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 425, 640]) | end - start: 1
mask_positions_in_input_ids:  [[331], [321], [323], [], [322], [325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 425, 640])
>> offset:  tensor([0, 1, 6], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2448, 3264]) | end - start: 5
mask_positions_in_input_ids:  [[331], [321], [323], [], [322], [325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 750, 1000]) | end - start: 5
mask_positions_in_input_ids:  [[362], [357], [359], [358], [357], [318], [321], [320], [319], [317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 750, 1000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 750, 1000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 750, 1000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 750, 1000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 750, 1000])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 480, 640]) | end - start: 5
mask_positions_in_input_ids:  [[362], [357], [359], [358], [357], [318], [321], [320], [319], [317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 1036, 1197]) | end - start: 5
mask_positions_in_input_ids:  [[360], [358], [362], [], [362], [323], [324], [326], [324], [319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1036, 1197])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1036, 1197])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1036, 1197])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1036, 1197])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1036, 1197])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 640, 426]) | end - start: 5
mask_positions_in_input_ids:  [[360], [358], [362], [], [362], [323], [324], [326], [324], [319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 426])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 1325, 2000]) | end - start: 5
mask_positions_in_input_ids:  [[346], [348], [349], [345], [], [337], [362], [356], [357], [358]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1325, 2000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1325, 2000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1325, 2000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1325, 2000])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1325, 2000])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 530, 800]) | end - start: 5
mask_positions_in_input_ids:  [[346], [348], [349], [345], [], [337], [362], [356], [357], [358]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 530, 800])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 530, 800])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 530, 800])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 530, 800])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 530, 800])
>> offset:  tensor([0, 5, 9], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2448, 3264]) | end - start: 5
mask_positions_in_input_ids:  [[323], [328], [319], [318], [320], [348], [348], [351], [349]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> offset:  tensor([0, 5, 9], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([4, 1200, 1600]) | end - start: 4
mask_positions_in_input_ids:  [[323], [328], [319], [318], [320], [348], [348], [351], [349]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 640, 427]) | end - start: 5
mask_positions_in_input_ids:  [[321], [321], [320], [318], [318], [322], [320], [318], [318], [320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 427])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 427])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 427])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 427])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 640, 427])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 480, 640]) | end - start: 5
mask_positions_in_input_ids:  [[321], [321], [320], [318], [318], [322], [320], [318], [318], [320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> offset:  tensor([0, 3, 8], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([3, 375, 500]) | end - start: 3
mask_positions_in_input_ids:  [[321], [325], [325], [321], [318], [322], [319], [319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> offset:  tensor([0, 3, 8], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 480, 640]) | end - start: 5
mask_positions_in_input_ids:  [[321], [325], [325], [321], [318], [322], [319], [319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 1836, 3264]) | end - start: 5
mask_positions_in_input_ids:  [[326], [322], [317], [], [317], [], [322], [327], [], [320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1836, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1836, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1836, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1836, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1836, 3264])
>> offset:  tensor([ 0,  5, 10], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 2448, 3264]) | end - start: 5
mask_positions_in_input_ids:  [[326], [322], [317], [], [317], [], [322], [327], [], [320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
>> offset:  tensor([0, 1, 2], device='cuda:0')
>> is_mask_per_conv: False | masks_list[batch_idx].shape: torch.Size([0, 375, 500]) | end - start: 1
mask_positions_in_input_ids:  [[], []]
>> offset:  tensor([0, 1, 2], device='cuda:0')
>> is_mask_per_conv: False | masks_list[batch_idx].shape: torch.Size([0, 427, 640]) | end - start: 1
mask_positions_in_input_ids:  [[], []]
  0%|          | 0/200 [00:00<?, ?it/s]
>> offset:  tensor([0, 3, 8], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([3, 375, 500]) | end - start: 3
mask_positions_in_input_ids:  [[322], [322], [321], [337], [337], [339], [335], [338]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 375, 500])
>> offset:  tensor([0, 3, 8], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([5, 3456, 2592]) | end - start: 5
mask_positions_in_input_ids:  [[322], [322], [321], [337], [337], [339], [335], [338]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 2592])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 2592])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 2592])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 2592])
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 2592])
Epoch: [0][  2/500]	Time 18.733 (18.733)	Loss 0.2476 (0.3655)	CeLoss 0.1221 (0.1659)	SegCLSLoss 0.1309 (0.1224)	KLLoss 0.0000 (0.0000)	MaskLoss 0.1330 (0.1779)	MaskBCELoss 0.0629 (0.0999)	MaskDICELoss 0.0701 (0.0780)
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something showing that the man is playing sports in this image? Please output segmentation mask. ASSISTANT: something showing that the man is playing sports</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3168, 4416]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3168, 4416])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3168, 4416])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]

(PLUM.py) >> pred_masks (shape: torch.Size([1, 3168, 4416])):  [tensor([[[-0.8555, -0.8555, -0.8555,  ..., -0.9492, -0.9492, -0.9492],
         [-0.8555, -0.8555, -0.8555,  ..., -0.9492, -0.9492, -0.9492],
         [-0.8555, -0.8555, -0.8555,  ..., -0.9492, -0.9492, -0.9492],
         ...,
         [-2.1782, -2.1782, -2.1782,  ..., -2.4424, -2.4424, -2.4424],
         [-2.2324, -2.2324, -2.2324,  ..., -2.5205, -2.5205, -2.5205],
         [-2.2324, -2.2324, -2.2324,  ..., -2.5205, -2.5205, -2.5205]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Horses can be trained to follow commands and be controlled while being ridden. What object in the picture is used for controlling and guiding a horse? Please output segmentation mask. ASSISTANT: horses can be trained to follow commands and be controlled while being ridden. what object in the picture is used for controlling and guiding a horse</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[84]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1024, 768]) | end - start: 1
mask_positions_in_input_ids:  [[339]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1024, 768])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1024, 768])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1024, 768])):  [tensor([[[-1.4453, -1.4453, -1.4004,  ..., -1.7188, -1.7646, -1.9033],
         [-1.4453, -1.4453, -1.4004,  ..., -1.7188, -1.7646, -1.9033],
         [-1.4111, -1.4111, -1.3730,  ..., -1.7515, -1.7949, -1.9199],
         ...,
         [-0.4866, -0.4866, -0.3501,  ..., -0.3330, -0.5344, -0.8345],
         [-0.4746, -0.4746, -0.3381,  ..., -0.3396, -0.5356, -0.8179],
         [-0.4746, -0.4746, -0.3381,  ..., -0.3396, -0.5356, -0.8179]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that allows people to drink without touching the rim of the cup in this image? Please output segmentation mask. ASSISTANT: something that allows people to drink without touching the rim of the cup</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[71]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1600, 1200]) | end - start: 1
mask_positions_in_input_ids:  [[326]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1600, 1200])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1600, 1200])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1600, 1200])):  [tensor([[[-2.8750, -2.8750, -2.8686,  ..., -3.5779, -3.7159, -3.8184],
         [-2.8750, -2.8750, -2.8686,  ..., -3.5779, -3.7159, -3.8184],
         [-2.8754, -2.8754, -2.8690,  ..., -3.5806, -3.7185, -3.8208],
         ...,
         [-1.6177, -1.6177, -1.6078,  ..., -1.8926, -2.2844, -2.5762],
         [-1.6172, -1.6172, -1.6073,  ..., -1.8922, -2.2831, -2.5742],
         [-1.6172, -1.6172, -1.6073,  ..., -1.8922, -2.2831, -2.5742]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In the picture, there seems to be a symbiotic relationship between two species, where one provides protection for the other. What animal in the picture is known to seek refuge in the tentacles of another creature for safety? Please output segmentation mask. ASSISTANT: in the picture, there seems to be a symbiotic relationship between two species, where one provides protection for the other. what animal in the picture is known to seek refuge in the tentacles of another creature for safety</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[96]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2736, 3648]) | end - start: 1
mask_positions_in_input_ids:  [[351]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2736, 3648])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2736, 3648])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2736, 3648])):  [tensor([[[-1.3359, -1.3359, -1.3359,  ...,  0.1299,  0.1299,  0.1299],
         [-1.3359, -1.3359, -1.3359,  ...,  0.1299,  0.1299,  0.1299],
         [-1.3359, -1.3359, -1.3359,  ...,  0.1299,  0.1299,  0.1299],
         ...,
         [-0.9932, -0.9932, -0.9932,  ..., -1.0040, -1.0040, -1.0040],
         [-1.1430, -1.1430, -1.1430,  ..., -1.1157, -1.1157, -1.1157],
         [-1.1430, -1.1430, -1.1430,  ..., -1.1157, -1.1157, -1.1157]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the slogan for welcoming in this image? Please output segmentation mask. ASSISTANT: the slogan for welcoming</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[-7.5938, -7.5938, -7.5715,  ..., -5.6106, -5.5938, -5.5938],
         [-7.5938, -7.5938, -7.5715,  ..., -5.6106, -5.5938, -5.5938],
         [-7.6043, -7.6043, -7.5824,  ..., -5.6516, -5.6348, -5.6348],
         ...,
         [-2.0101, -2.0101, -1.9824,  ..., -1.5164, -1.5063, -1.5063],
         [-2.3908, -2.3908, -2.3684,  ..., -2.1807, -2.1723, -2.1723],
         [-2.6846, -2.6846, -2.6665,  ..., -2.7014, -2.6943, -2.6943]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n For the safety of newborns, they are often placed in a secure and comfortable space when they sleep. What furniture in the picture is commonly used to provide a safe sleeping environment for babies? Please output segmentation mask. ASSISTANT: for the safety of newborns, they are often placed in a secure and comfortable space when they sleep. what furniture in the picture is commonly used to provide a safe sleeping environment for babies</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[94]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1002, 1455]) | end - start: 1
mask_positions_in_input_ids:  [[349]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1002, 1455])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1002, 1455])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1002, 1455])):  [tensor([[[-0.9297, -0.9297, -0.9143,  ..., -0.3294, -0.3203, -0.3203],
         [-0.9297, -0.9297, -0.9143,  ..., -0.3294, -0.3203, -0.3203],
         [-0.9218, -0.9218, -0.9064,  ..., -0.3101, -0.3011, -0.3011],
         ...,
         [-0.6554, -0.6554, -0.6458,  ..., -0.7413, -0.7421, -0.7421],
         [-0.9147, -0.9147, -0.9078,  ..., -0.9613, -0.9613, -0.9613],
         [-1.1193, -1.1193, -1.1145,  ..., -1.1349, -1.1343, -1.1343]]],

  4%|▍         | 8/200 [00:03<01:09,  2.77it/s]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When using a film camera to take photos, what part of the camera helps focus the light on the film to capture the image? Please output segmentation mask. ASSISTANT: when using a film camera to take photos, what part of the camera helps focus the light on the film to capture the image</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[77]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1067, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[332]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1067, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1067, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1067, 1600])):  [tensor([[[-1.3594, -1.3594, -1.3607,  ..., -1.6956, -1.7031, -1.7031],
         [-1.3594, -1.3594, -1.3607,  ..., -1.6956, -1.7031, -1.7031],
         [-1.3351, -1.3351, -1.3364,  ..., -1.6645, -1.6720, -1.6720],
         ...,
         [-2.0285, -2.0285, -2.0300,  ..., -1.8942, -1.8957, -1.8957],
         [-2.9091, -2.9091, -2.9121,  ..., -2.8776, -2.8786, -2.8786],
         [-3.5391, -3.5391, -3.5432,  ..., -3.5851, -3.5859, -3.5859]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Birds have various ways of searching for food. What part of their body helps them to grab and pick up food from the ground in the picture? Please output segmentation mask. ASSISTANT: birds have various ways of searching for food. what part of their body helps them to grab and pick up food from the ground in the picture</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2570, 2229]) | end - start: 1
mask_positions_in_input_ids:  [[336]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2570, 2229])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2570, 2229])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2570, 2229])):  [tensor([[[-0.1650, -0.1650, -0.1650,  ..., -0.5347, -0.6329, -0.6570],
         [-0.1650, -0.1650, -0.1650,  ..., -0.5347, -0.6329, -0.6570],
         [-0.1650, -0.1650, -0.1650,  ..., -0.5347, -0.6329, -0.6570],
         ...,
         [-0.9766, -0.9766, -0.9766,  ..., -1.2809, -1.4388, -1.4775],
         [-0.9766, -0.9766, -0.9766,  ..., -1.2809, -1.4388, -1.4775],
         [-0.9766, -0.9766, -0.9766,  ..., -1.2809, -1.4388, -1.4775]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the sour food in this image? Please output segmentation mask. ASSISTANT: the sour food</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[61]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 480, 640]) | end - start: 1
mask_positions_in_input_ids:  [[316]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[-6.9375, -6.8320, -6.4688,  ..., -4.8984, -4.1900, -3.9844],
         [-6.8777, -6.7924, -6.4986,  ..., -5.0101, -4.3636, -4.1760],
         [-6.6719, -6.6561, -6.6016,  ..., -5.3945, -4.9616, -4.8359],
         ...,
         [-4.6094, -4.6111, -4.6172,  ..., -1.5371, -1.2480, -1.1641],
         [-4.3934, -4.3812, -4.3391,  ..., -1.6007, -1.3803, -1.3163],
         [-5.7500, -5.7567, -5.7797,  ..., -4.3348, -3.9615, -3.8532]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that protects the woman's eyes from getting wet in this image? Please output segmentation mask. ASSISTANT: something that protects the woman's eyes from getting wet</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[69]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2112, 2370]) | end - start: 1
mask_positions_in_input_ids:  [[324]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2112, 2370])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2112, 2370])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2112, 2370])):  [tensor([[[-0.3613, -0.3613, -0.3613,  ..., -0.7500, -0.7500, -0.7500],
         [-0.3613, -0.3613, -0.3613,  ..., -0.7500, -0.7500, -0.7500],
         [-0.3613, -0.3613, -0.3613,  ..., -0.7500, -0.7500, -0.7500],
         ...,
         [-1.1083, -1.1083, -1.1083,  ..., -0.4249, -0.4249, -0.4249],
         [-1.3910, -1.3910, -1.3910,  ..., -0.6126, -0.6126, -0.6126],
         [-1.4880, -1.4880, -1.4880,  ..., -0.6770, -0.6770, -0.6770]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When participating in water activities such as kayaking, it is important to ensure personal safety. What item in the picture is designed to provide buoyancy and keep the person afloat in case of an accident? Please output segmentation mask. ASSISTANT: when participating in water activities such as kayaking, it is important to ensure personal safety. what item in the picture is designed to provide buoyancy and keep the person afloat in case of an accident</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[95]]

  6%|▌         | 12/200 [00:05<01:15,  2.47it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1037, 1322]) | end - start: 1
mask_positions_in_input_ids:  [[350]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1037, 1322])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1037, 1322])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1037, 1322])):  [tensor([[[-0.8633, -0.8633, -0.8586,  ..., -0.6574, -0.6602, -0.6602],
         [-0.8633, -0.8633, -0.8586,  ..., -0.6574, -0.6602, -0.6602],
         [-0.8533, -0.8533, -0.8483,  ..., -0.6487, -0.6510, -0.6510],
         ...,
         [-1.4732, -1.4732, -1.4696,  ..., -1.1660, -1.1663, -1.1663],
         [-1.6489, -1.6489, -1.6459,  ..., -1.3450, -1.3415, -1.3415],
         [-1.7900, -1.7900, -1.7864,  ..., -1.4789, -1.4727, -1.4727]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the sewage outlet in this image? Please output segmentation mask. ASSISTANT: the sewage outlet</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 4032, 3024]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 4032, 3024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 4032, 3024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 4032, 3024])):  [tensor([[[-0.4844, -0.4844, -0.4844,  ..., -0.2349, -0.2756, -0.2756],
         [-0.4844, -0.4844, -0.4844,  ..., -0.2349, -0.2756, -0.2756],
         [-0.4844, -0.4844, -0.4844,  ..., -0.2349, -0.2756, -0.2756],
         ...,
         [-0.6680, -0.6680, -0.6680,  ..., -0.8437, -0.8657, -0.8657],
         [-0.6680, -0.6680, -0.6680,  ..., -0.8437, -0.8657, -0.8657],
         [-0.6680, -0.6680, -0.6680,  ..., -0.8437, -0.8657, -0.8657]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In some circus performances, gymnasts perform aerial acrobatics using long pieces of fabric that hang from the ceiling. What in the picture could be used for this type of performance? Please output segmentation mask. ASSISTANT: in some circus performances, gymnasts perform aerial acrobatics using long pieces of fabric that hang from the ceiling. what in the picture could be used for this type of performance</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[92]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1064, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[347]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1064, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1064, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1064, 1600])):  [tensor([[[-3.5000, -3.5000, -3.4879,  ..., -0.8900, -0.8750, -0.8750],
         [-3.5000, -3.5000, -3.4879,  ..., -0.8900, -0.8750, -0.8750],
         [-3.5000, -3.5000, -3.4879,  ..., -0.8972, -0.8823, -0.8823],
         ...,
         [-2.3847, -2.3847, -2.3844,  ..., -1.8878, -1.8801, -1.8801],
         [-2.6785, -2.6785, -2.6771,  ..., -1.9114, -1.9038, -1.9038],
         [-2.8896, -2.8896, -2.8875,  ..., -1.9284, -1.9209, -1.9209]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the stacked cookies in this image? Please output segmentation mask. ASSISTANT: the stacked cookies</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[61]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1402, 2102]) | end - start: 1
mask_positions_in_input_ids:  [[316]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1402, 2102])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1402, 2102])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1402, 2102])):  [tensor([[[-2.7500, -2.7500, -2.7500,  ..., -3.4531, -3.4531, -3.4531],
         [-2.7500, -2.7500, -2.7500,  ..., -3.4531, -3.4531, -3.4531],
         [-2.7500, -2.7500, -2.7500,  ..., -3.4531, -3.4531, -3.4531],
         ...,
         [-5.5248, -5.5248, -5.5248,  ...,  0.4094,  0.4094,  0.4094],
         [-6.0937, -6.0937, -6.0937,  ..., -0.0168, -0.0168, -0.0168],
         [-6.3633, -6.3633, -6.3633,  ..., -0.2188, -0.2188, -0.2188]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n If a person wanted to charge their electric car while parked in the street, what object in the picture could they use to connect the car to an electrical power source? Please output segmentation mask. ASSISTANT: if a person wanted to charge their electric car while parked in the street, what object in the picture could they use to connect the car to an electrical power source</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[86]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2016, 3032]) | end - start: 1
mask_positions_in_input_ids:  [[341]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2016, 3032])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2016, 3032])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2016, 3032])):  [tensor([[[-4.3438, -4.3438, -4.3438,  ..., -2.5000, -2.5000, -2.5000],
         [-4.3438, -4.3438, -4.3438,  ..., -2.5000, -2.5000, -2.5000],
         [-4.3438, -4.3438, -4.3438,  ..., -2.5000, -2.5000, -2.5000],
         ...,
         [-0.8356, -0.8356, -0.8356,  ..., -2.5344, -2.5344, -2.5344],
         [-1.1404, -1.1404, -1.1404,  ..., -2.6941, -2.6941, -2.6941],
         [-1.1465, -1.1465, -1.1465,  ..., -2.6973, -2.6973, -2.6973]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Where do people put their dirty hygiene products to keep the bathroom clean? Please output segmentation mask. ASSISTANT: where do people put their dirty hygiene products to keep the bathroom clean</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]

  8%|▊         | 17/200 [00:08<01:22,  2.22it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-4.4979, -3.6171, -3.6854,  ..., -4.4285, -4.4263, -4.3838],
         [-3.5527, -3.2702, -3.1375,  ..., -3.0750, -3.1255, -3.1051],
         [-3.4265, -2.8195, -2.5977,  ..., -2.0371, -2.1195, -2.3397],
         ...,
         [-2.0877, -1.9695, -1.5127,  ..., -2.2539, -2.0789, -2.1702],
         [-2.1353, -2.1412, -2.0066,  ..., -2.3641, -2.2414, -2.3435],
         [-2.8933, -2.9819, -3.0512,  ..., -3.6873, -3.6386, -3.4494]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When the wind blows, small white objects are blown away and scattered in the air. What in the picture is responsible for this phenomenon? Please output segmentation mask. ASSISTANT: when the wind blows, small white objects are blown away and scattered in the air. what in the picture is responsible for this phenomenon</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 533, 800]) | end - start: 1
mask_positions_in_input_ids:  [[336]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[-0.3652, -0.3574, -0.3204,  ..., -0.1654, -0.1756, -0.1777],
         [-0.3698, -0.3625, -0.3280,  ..., -0.1701, -0.1761, -0.1774],
         [-0.3916, -0.3867, -0.3639,  ..., -0.1921, -0.1786, -0.1757],
         ...,
         [-0.4057, -0.4241, -0.5111,  ..., -0.5711, -0.5744, -0.5751],
         [-0.6262, -0.6360, -0.6820,  ..., -0.6925, -0.6895, -0.6888],
         [-0.8468, -0.8478, -0.8528,  ..., -0.8139, -0.8045, -0.8025]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that the dog's food should be put into in this image? Please output segmentation mask. ASSISTANT: something that the dog's food should be put into</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 480, 640]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[-0.9023, -0.8641, -0.7324,  ..., -0.2050, -0.0868, -0.0525],
         [-0.8667, -0.8340, -0.7210,  ..., -0.1114, -0.0077,  0.0224],
         [-0.7441, -0.7301, -0.6816,  ...,  0.2110,  0.2648,  0.2804],
         ...,
         [-0.6855, -0.6851, -0.6836,  ...,  0.2085,  0.1665,  0.1543],
         [-0.7826, -0.7828, -0.7835,  ..., -0.2223, -0.2085, -0.2045],
         [-1.2621, -1.2690, -1.2926,  ..., -1.1849, -1.1460, -1.1348]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the food that makes people feel spicy or hot in this image? Please output segmentation mask. ASSISTANT: the food that makes people feel spicy or hot</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[67]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 679, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[322]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 679, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 679, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 679, 1024])):  [tensor([[[-2.2344, -2.2344, -2.1787,  ..., -0.3740, -0.3555, -0.3555],
         [-2.2344, -2.2344, -2.1787,  ..., -0.3740, -0.3555, -0.3555],
         [-2.2070, -2.2070, -2.1600,  ..., -0.3231, -0.3083, -0.3083],
         ...,
         [-0.7441, -0.7441, -0.7554,  ..., -0.1823, -0.2026, -0.2026],
         [-0.7559, -0.7559, -0.7668,  ..., -0.4486, -0.4712, -0.4712],
         [-0.9478, -0.9478, -0.9550,  ..., -0.7638, -0.7729, -0.7729]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the object used to protect the ears in this image? Please output segmentation mask. ASSISTANT: the object used to protect the ears</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2112, 2816]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2112, 2816])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2112, 2816])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2112, 2816])):  [tensor([[[-6.6562, -6.6562, -6.6562,  ..., -6.1250, -6.1250, -6.1250],
         [-6.6562, -6.6562, -6.6562,  ..., -6.1250, -6.1250, -6.1250],
         [-6.6562, -6.6562, -6.6562,  ..., -6.1250, -6.1250, -6.1250],
         ...,
         [-1.7472, -1.7472, -1.7472,  ..., -3.7983, -3.7983, -3.7983],
         [-2.6148, -2.6148, -2.6148,  ..., -4.1790, -4.1790, -4.1790],
         [-2.7231, -2.7231, -2.7231,  ..., -4.2266, -4.2266, -4.2266]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the place where piano players should sit in this image? Please output segmentation mask. ASSISTANT: the place where piano players should sit</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]

 11%|█         | 22/200 [00:10<01:21,  2.18it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 960, 1280]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 960, 1280])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 960, 1280])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 960, 1280])):  [tensor([[[-2.7656, -2.7656, -2.7432,  ..., -3.5781, -3.5781, -3.5781],
         [-2.7656, -2.7656, -2.7432,  ..., -3.5781, -3.5781, -3.5781],
         [-2.7900, -2.7900, -2.7690,  ..., -3.5869, -3.5869, -3.5869],
         ...,
         [-0.4490, -0.4490, -0.4346,  ..., -0.4730, -0.5260, -0.5260],
         [-1.3578, -1.3578, -1.3617,  ..., -1.7656, -1.8086, -1.8086],
         [-2.3938, -2.3938, -2.4203,  ..., -3.2166, -3.2450, -3.2450]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the person who is shooting a free throw in this image? Please output segmentation mask. ASSISTANT: the person who is shooting a free throw</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2287, 1831]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2287, 1831])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2287, 1831])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2287, 1831])):  [tensor([[[-3.0156, -3.0156, -3.0156,  ..., -2.0181, -1.9796, -1.9648],
         [-3.0156, -3.0156, -3.0156,  ..., -2.0181, -1.9796, -1.9648],
         [-3.0156, -3.0156, -3.0156,  ..., -2.0181, -1.9796, -1.9648],
         ...,
         [-2.1875, -2.1875, -2.1875,  ..., -1.3078, -1.5081, -1.5850],
         [-2.1875, -2.1875, -2.1875,  ..., -1.3078, -1.5081, -1.5850],
         [-2.1875, -2.1875, -2.1875,  ..., -1.3078, -1.5081, -1.5850]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When soldiers gather for a group photo, what object in the picture is usually held by one of them to represent their unit or country? Please output segmentation mask. ASSISTANT: when soldiers gather for a group photo, what object in the picture is usually held by one of them to represent their unit or country</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[78]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 431, 600]) | end - start: 1
mask_positions_in_input_ids:  [[333]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 431, 600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 431, 600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 431, 600])):  [tensor([[[-7.5312, -7.3081, -6.6281,  ..., -5.8333, -5.3000, -5.1250],
         [-7.4786, -7.2886, -6.7097,  ..., -6.0322, -5.5737, -5.4233],
         [-7.3185, -7.2294, -6.9579,  ..., -6.6370, -6.4062, -6.3305],
         ...,
         [-3.4699, -3.4363, -3.3339,  ..., -4.4459, -4.0032, -3.8580],
         [-3.3632, -3.2792, -3.0230,  ..., -3.7501, -3.7259, -3.7179],
         [-4.9713, -4.8744, -4.5792,  ..., -4.9578, -4.8897, -4.8673]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Sometimes, water leaks from faulty plumbing or faucets. What part of the plumbing system in the picture can be a potential source of the water leak? Please output segmentation mask. ASSISTANT: sometimes, water leaks from faulty plumbing or faucets. what part of the plumbing system in the picture can be a potential source of the water leak</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3872, 2592]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3872, 2592])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3872, 2592])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3872, 2592])):  [tensor([[[-1.3438, -1.3438, -1.3438,  ..., -2.5345, -2.5176, -2.5176],
         [-1.3438, -1.3438, -1.3438,  ..., -2.5345, -2.5176, -2.5176],
         [-1.3438, -1.3438, -1.3438,  ..., -2.5345, -2.5176, -2.5176],
         ...,
         [-2.4062, -2.4062, -2.4062,  ..., -2.2814, -2.3721, -2.3721],
         [-2.4062, -2.4062, -2.4062,  ..., -2.2814, -2.3721, -2.3721],
         [-2.4062, -2.4062, -2.4062,  ..., -2.2814, -2.3721, -2.3721]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the part of the persons that is above the water in this image? Please output segmentation mask. ASSISTANT: the part of the persons that is above the water</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[67]]

 14%|█▎        | 27/200 [00:12<00:59,  2.89it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2304, 3072]) | end - start: 1
mask_positions_in_input_ids:  [[322]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2304, 3072])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2304, 3072])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2304, 3072])):  [tensor([[[-2.2500, -2.2500, -2.2500,  ..., -1.7578, -1.7578, -1.7578],
         [-2.2500, -2.2500, -2.2500,  ..., -1.7578, -1.7578, -1.7578],
         [-2.2500, -2.2500, -2.2500,  ..., -1.7578, -1.7578, -1.7578],
         ...,
         [-2.5726, -2.5726, -2.5726,  ..., -3.2124, -3.2124, -3.2124],
         [-3.1045, -3.1045, -3.1045,  ..., -3.9595, -3.9595, -3.9595],
         [-3.1045, -3.1045, -3.1045,  ..., -3.9595, -3.9595, -3.9595]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When we need to access or store things above our reach, what would be helpful to stand on? Please output segmentation mask. ASSISTANT: when we need to access or store things above our reach, what would be helpful to stand on</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[71]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[326]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-4.9581, -4.1562, -4.3197,  ..., -8.0805, -8.4459, -8.5673],
         [-6.9062, -6.9019, -7.2953,  ..., -9.0688, -9.2537, -8.9616],
         [-6.9553, -7.0734, -7.3750,  ..., -9.1562, -9.4500, -9.1922],
         ...,
         [-8.1445, -8.3594, -8.1641,  ..., -6.8672, -7.1969, -7.3258],
         [-9.2104, -9.2695, -9.0586,  ..., -7.3391, -7.7216, -7.9214],
         [-5.5556, -5.4318, -5.7233,  ..., -6.5393, -6.8390, -6.6902]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What structure can be used to drain the water from the bathroom floor and prevent the accumulation of wastewater? Please output segmentation mask. ASSISTANT: what structure can be used to drain the water from the bathroom floor and prevent the accumulation of wastewater</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[75]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[330]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-1.4142e+00, -1.3770e+00, -1.3142e+00,  ..., -1.1323e+00,
          -1.1607e+00, -1.2395e+00],
         [-1.4576e+00, -1.4463e+00, -1.4082e+00,  ..., -1.1068e+00,
          -1.1924e+00, -1.1715e+00],
         [-1.3086e+00, -1.3086e+00, -1.3105e+00,  ..., -1.0479e+00,
          -1.1055e+00, -1.1055e+00],
         ...,
         [-6.0941e-01, -7.7256e-01, -7.9492e-01,  ...,  5.1514e-02,
          -1.3183e-03,  2.3743e-03],
         [-8.3384e-01, -9.1199e-01, -9.2305e-01,  ..., -3.6548e-01,
          -4.2650e-01, -3.2835e-01],
         [-1.2066e+00, -1.2728e+00, -1.3150e+00,  ..., -1.0156e+00,
          -1.0055e+00, -1.1227e+00]]], device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the dog that puts its tongue out in this image? Please output segmentation mask. ASSISTANT: the dog that puts its tongue out</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1600, 1200]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1600, 1200])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1600, 1200])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1600, 1200])):  [tensor([[[-5.7500, -5.7500, -5.7434,  ..., -5.0922, -5.1275, -5.1562],
         [-5.7500, -5.7500, -5.7434,  ..., -5.0922, -5.1275, -5.1562],
         [-5.7535, -5.7535, -5.7469,  ..., -5.0942, -5.1327, -5.1641],
         ...,
         [-7.6418, -7.6418, -7.6151,  ..., -6.7125, -6.8527, -6.9685],
         [-7.6562, -7.6562, -7.6289,  ..., -6.7145, -6.8537, -6.9688],
         [-7.6562, -7.6562, -7.6289,  ..., -6.7145, -6.8537, -6.9688]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a rural landscape, what objects in the picture could provide shade and shelter for animals or humans? Please output segmentation mask. ASSISTANT: in a rural landscape, what objects in the picture could provide shade and shelter for animals or humans</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[72]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 480, 640]) | end - start: 1
mask_positions_in_input_ids:  [[327]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[-3.9531, -3.9865, -4.1016,  ..., -3.9141, -3.9201, -3.9219],
         [-3.9057, -3.9351, -4.0365,  ..., -3.7849, -3.8025, -3.8076],
         [-3.7422, -3.7580, -3.8125,  ..., -3.3398, -3.3974, -3.4141],
         ...,
         [-0.5332, -0.5091, -0.4261,  ...,  0.7566,  0.6955,  0.6777],
         [-0.7949, -0.7872, -0.7610,  ...,  0.0054, -0.1154, -0.1504],
         [-2.3778, -2.4021, -2.4860,  ..., -2.2611, -2.3594, -2.3879]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something used for playing videos or music in this image? Please output segmentation mask. ASSISTANT: something used for playing videos or music</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]

 16%|█▌        | 31/200 [00:13<01:02,  2.71it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[-2.4219, -2.4219, -2.3965,  ..., -3.3984, -3.4219, -3.4219],
         [-2.4219, -2.4219, -2.3965,  ..., -3.3984, -3.4219, -3.4219],
         [-2.4043, -2.4043, -2.3816,  ..., -3.4536, -3.4746, -3.4746],
         ...,
         [-0.6860, -0.6860, -0.6786,  ..., -0.7475, -0.7502, -0.7502],
         [-1.2529, -1.2529, -1.2536,  ..., -1.3919, -1.3945, -1.3945],
         [-2.0557, -2.0557, -2.0684,  ..., -2.3759, -2.3711, -2.3711]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When celebrating birthdays, it is common to have a cake with decorations. What part of the cake in the picture is typically used to write birthday greetings or the name of the person celebrating? Please output segmentation mask. ASSISTANT: when celebrating birthdays, it is common to have a cake with decorations. what part of the cake in the picture is typically used to write birthday greetings or the name of the person celebrating</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[97]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 480, 640]) | end - start: 1
mask_positions_in_input_ids:  [[352]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[-1.0312, -0.9917, -0.8555,  ..., -0.9277, -0.8475, -0.8242],
         [-1.0198, -0.9853, -0.8665,  ..., -0.9394, -0.8695, -0.8493],
         [-0.9805, -0.9633, -0.9043,  ..., -0.9795, -0.9454, -0.9355],
         ...,
         [-1.3125, -1.3020, -1.2656,  ..., -1.1836, -1.1806, -1.1797],
         [-1.1530, -1.1519, -1.1479,  ..., -1.0833, -1.1121, -1.1204],
         [-1.3352, -1.3335, -1.3277,  ..., -1.3879, -1.4027, -1.4070]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that allow pedestrians to cross the canyon in this image? Please output segmentation mask. ASSISTANT: something that allow pedestrians to cross the canyon</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1989, 5815]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1989, 5815])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1989, 5815])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1989, 5815])):  [tensor([[[-7.3750, -7.3750, -7.3750,  ..., -5.0312, -5.0312, -5.0312],
         [-7.3750, -7.3750, -7.3750,  ..., -5.0312, -5.0312, -5.0312],
         [-7.3750, -7.3750, -7.3750,  ..., -5.0312, -5.0312, -5.0312],
         ...,
         [-2.2021, -2.2021, -2.2021,  ..., -2.5957, -2.5957, -2.5957],
         [-2.2021, -2.2021, -2.2021,  ..., -2.5957, -2.5957, -2.5957],
         [-2.2021, -2.2021, -2.2021,  ..., -2.5957, -2.5957, -2.5957]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the place where the dishes and meals should be put for eating in this image? Please output segmentation mask. ASSISTANT: the place where the dishes and meals should be put for eating</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[72]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 601, 800]) | end - start: 1
mask_positions_in_input_ids:  [[327]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 601, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 601, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 601, 800])):  [tensor([[[-2.1562, -2.1505, -2.1234,  ..., -1.5977, -1.7040, -1.7266],
         [-2.1341, -2.1300, -2.1104,  ..., -1.5951, -1.6985, -1.7204],
         [-2.0298, -2.0332, -2.0490,  ..., -1.5829, -1.6724, -1.6914],
         ...,
         [ 0.5331,  0.5512,  0.6363,  ...,  1.2110,  1.0204,  0.9800],
         [-1.3336, -1.3420, -1.3816,  ..., -1.1765, -1.3120, -1.3408],
         [-3.6666, -3.7079, -3.9030,  ..., -4.1207, -4.1900, -4.2047]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that the persons use to cross the water in this image? Please output segmentation mask. ASSISTANT: something that the persons use to cross the water</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[-1.7109, -1.7109, -1.7051,  ..., -0.8825, -0.8750, -0.8750],
         [-1.7109, -1.7109, -1.7051,  ..., -0.8825, -0.8750, -0.8750],
         [-1.7070, -1.7070, -1.7012,  ..., -0.8904, -0.8829, -0.8829],
         ...,
         [-0.6389, -0.6389, -0.6386,  ..., -0.9153, -0.9203, -0.9203],
         [-1.1505, -1.1505, -1.1494,  ..., -1.4794, -1.4826, -1.4826],
         [-1.5618, -1.5618, -1.5603,  ..., -1.9208, -1.9224, -1.9224]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Driving at night can be very dangerous due to poor visibility, which can lead to accidents. What part of the car needs to be turned on when driving at night? Please output segmentation mask. ASSISTANT: driving at night can be very dangerous due to poor visibility, which can lead to accidents. what part of the car needs to be turned on when driving at night</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]

 18%|█▊        | 36/200 [00:15<01:03,  2.57it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 864, 1152]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 864, 1152])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 864, 1152])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 864, 1152])):  [tensor([[[-0.8086, -0.8086, -0.8054,  ..., -0.3339, -0.3203, -0.3203],
         [-0.8086, -0.8086, -0.8054,  ..., -0.3339, -0.3203, -0.3203],
         [-0.8030, -0.8030, -0.8005,  ..., -0.3060, -0.2939, -0.2939],
         ...,
         [-1.0137, -1.0137, -1.0171,  ..., -0.5630, -0.5727, -0.5727],
         [-1.1419, -1.1419, -1.1463,  ..., -0.8964, -0.9069, -0.9069],
         [-1.3389, -1.3389, -1.3434,  ..., -1.3240, -1.3325, -1.3325]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n This rocky terrain can be challenging to navigate. What object in the picture could provide information to guide travelers through this area? Please output segmentation mask. ASSISTANT: this rocky terrain can be challenging to navigate. what object in the picture could provide information to guide travelers through this area</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[78]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2592, 3888]) | end - start: 1
mask_positions_in_input_ids:  [[333]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 3888])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2592, 3888])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2592, 3888])):  [tensor([[[-5.5312, -5.5312, -5.5312,  ..., -5.0000, -5.0000, -5.0000],
         [-5.5312, -5.5312, -5.5312,  ..., -5.0000, -5.0000, -5.0000],
         [-5.5312, -5.5312, -5.5312,  ..., -5.0000, -5.0000, -5.0000],
         ...,
         [-4.9964, -4.9964, -4.9964,  ..., -4.6484, -4.6484, -4.6484],
         [-5.0430, -5.0430, -5.0430,  ..., -4.6875, -4.6875, -4.6875],
         [-5.0430, -5.0430, -5.0430,  ..., -4.6875, -4.6875, -4.6875]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is The fastest sinking ship in this image? Please output segmentation mask. ASSISTANT: the fastest sinking ship</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 333, 500]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 333, 500])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 333, 500])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 333, 500])):  [tensor([[[-5.4375, -5.5631, -5.8031,  ..., -4.6869, -4.8309, -4.9062],
         [-4.8093, -4.9114, -5.1064,  ..., -3.9212, -4.2324, -4.3953],
         [-3.6093, -3.6663, -3.7753,  ..., -2.4584, -3.0892, -3.4193],
         ...,
         [ 1.7513,  1.9523,  2.3363,  ...,  2.9412,  2.5076,  2.2807],
         [-0.4693, -0.3433, -0.1025,  ...,  0.5239,  0.3495,  0.2581],
         [-4.7814, -4.7561, -4.7079,  ..., -3.3416, -3.3891, -3.4139]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In some regions, people raise certain animals for their milk, meat, and skin. What animal in the picture could be domesticated for such purposes? Please output segmentation mask. ASSISTANT: in some regions, people raise certain animals for their milk, meat, and skin. what animal in the picture could be domesticated for such purposes</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1365, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[336]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1365, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1365, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1365, 2048])):  [tensor([[[-2.2656, -2.2656, -2.2656,  ..., -1.5547, -1.5547, -1.5547],
         [-2.2656, -2.2656, -2.2656,  ..., -1.5547, -1.5547, -1.5547],
         [-2.2656, -2.2656, -2.2656,  ..., -1.5547, -1.5547, -1.5547],
         ...,
         [-0.7710, -0.7710, -0.7710,  ..., -1.0543, -1.0543, -1.0543],
         [-1.0778, -1.0778, -1.0778,  ..., -1.1990, -1.1990, -1.1990],
         [-1.2314, -1.2314, -1.2314,  ..., -1.2715, -1.2715, -1.2715]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the place where the child is about to slip/fall off in this image? Please output segmentation mask. ASSISTANT: the place where the child is about to slip/fall off</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2152, 1704]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2152, 1704])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2152, 1704])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2152, 1704])):  [tensor([[[-2.1094, -2.1094, -2.1094,  ..., -2.1313, -2.1633, -2.1777],
         [-2.1094, -2.1094, -2.1094,  ..., -2.1313, -2.1633, -2.1777],
         [-2.1094, -2.1094, -2.1094,  ..., -2.1313, -2.1633, -2.1777],
         ...,
         [-0.5625, -0.5625, -0.5625,  ..., -0.0933, -0.1569, -0.1855],
         [-0.5625, -0.5625, -0.5625,  ..., -0.0933, -0.1569, -0.1855],
         [-0.5625, -0.5625, -0.5625,  ..., -0.0933, -0.1569, -0.1855]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In order to facilitate transportation and connect different regions, what structure in the picture was built across the water? Please output segmentation mask. ASSISTANT: in order to facilitate transportation and connect different regions, what structure in the picture was built across the water</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[74]]

 20%|██        | 40/200 [00:17<01:02,  2.55it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3264, 4928]) | end - start: 1
mask_positions_in_input_ids:  [[329]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3264, 4928])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3264, 4928])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3264, 4928])):  [tensor([[[-3.4375, -3.4375, -3.4375,  ..., -3.3906, -3.3906, -3.3906],
         [-3.4375, -3.4375, -3.4375,  ..., -3.3906, -3.3906, -3.3906],
         [-3.4375, -3.4375, -3.4375,  ..., -3.3906, -3.3906, -3.3906],
         ...,
         [-0.8894, -0.8894, -0.8894,  ..., -0.5693, -0.5693, -0.5693],
         [-0.8950, -0.8950, -0.8950,  ..., -0.5801, -0.5801, -0.5801],
         [-0.8950, -0.8950, -0.8950,  ..., -0.5801, -0.5801, -0.5801]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the cesspit in this image? Please output segmentation mask. ASSISTANT: the cesspit</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[61]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1712, 2288]) | end - start: 1
mask_positions_in_input_ids:  [[316]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1712, 2288])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1712, 2288])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1712, 2288])):  [tensor([[[-2.5469, -2.5469, -2.5469,  ..., -0.8984, -0.8984, -0.8984],
         [-2.5469, -2.5469, -2.5469,  ..., -0.8984, -0.8984, -0.8984],
         [-2.5469, -2.5469, -2.5469,  ..., -0.8984, -0.8984, -0.8984],
         ...,
         [-2.0850, -2.0850, -2.0850,  ..., -0.8895, -0.8895, -0.8895],
         [-2.0885, -2.0885, -2.0885,  ..., -0.9306, -0.9306, -0.9306],
         [-2.0898, -2.0898, -2.0898,  ..., -0.9463, -0.9463, -0.9463]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the goat nearest to the bottom stone in this image? Please output segmentation mask. ASSISTANT: the goat nearest to the bottom stone</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2344, 3190]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2344, 3190])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2344, 3190])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2344, 3190])):  [tensor([[[-11.3750, -11.3750, -11.3750,  ...,  -9.5000,  -9.5000,  -9.5000],
         [-11.3750, -11.3750, -11.3750,  ...,  -9.5000,  -9.5000,  -9.5000],
         [-11.3750, -11.3750, -11.3750,  ...,  -9.5000,  -9.5000,  -9.5000],
         ...,
         [ -7.4105,  -7.4105,  -7.4105,  ...,  -8.4667,  -8.4667,  -8.4667],
         [ -7.7031,  -7.7031,  -7.7031,  ...,  -8.7734,  -8.7734,  -8.7734],
         [ -7.7031,  -7.7031,  -7.7031,  ...,  -8.7734,  -8.7734,  -8.7734]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the objects that can protect the snail and prevent it from getting injured in this image? Please output segmentation mask. ASSISTANT: the objects that can protect the snail and prevent it from getting injured</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[71]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1350, 1800]) | end - start: 1
mask_positions_in_input_ids:  [[326]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1350, 1800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1350, 1800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1350, 1800])):  [tensor([[[-1.0312, -1.0312, -1.0312,  ..., -1.2500, -1.2500, -1.2500],
         [-1.0312, -1.0312, -1.0312,  ..., -1.2500, -1.2500, -1.2500],
         [-1.0312, -1.0312, -1.0312,  ..., -1.2500, -1.2500, -1.2500],
         ...,
         [-0.6823, -0.6823, -0.6823,  ..., -0.2964, -0.2964, -0.2964],
         [-0.8637, -0.8637, -0.8637,  ..., -0.5017, -0.5017, -0.5017],
         [-0.9763, -0.9763, -0.9763,  ..., -0.6292, -0.6292, -0.6292]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n If a person wants to watch TV or a movie, which furniture is the most suitable for them to sit and watch? Please output segmentation mask. ASSISTANT: if a person wants to watch tv or a movie, which furniture is the most suitable for them to sit and watch</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[76]]
>> (validate) sampled_classes_list:  [None]

 22%|██▎       | 45/200 [00:19<00:54,  2.85it/s]
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[331]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 1., 1., 0.],
         [0., 0., 0.,  ..., 1., 1., 0.],
         [0., 0., 0.,  ..., 1., 1., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-2.2721, -1.9826, -1.9189,  ..., -2.9321, -3.0213, -2.9022],
         [-2.0578, -1.8016, -1.5402,  ..., -2.6367, -2.7302, -2.5594],
         [-1.8886, -1.5609, -1.0840,  ..., -2.4141, -2.5828, -2.4861],
         ...,
         [-1.1182, -1.0658, -0.1992,  ..., -1.4512, -1.8609, -2.2047],
         [-0.9331, -0.9253, -0.2953,  ..., -1.5648, -1.9674, -2.2526],
         [-1.4764, -1.4737, -1.1078,  ..., -2.0070, -2.3877, -2.6202]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In historical buildings, there are often signs or symbols displayed on the walls or floors to represent a specific meaning or identity. What in the picture could be used to display such signs or symbols? Please output segmentation mask. ASSISTANT: in historical buildings, there are often signs or symbols displayed on the walls or floors to represent a specific meaning or identity. what in the picture could be used to display such signs or symbols</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[90]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[345]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[-1.5312, -1.5312, -1.5078,  ..., -1.3213, -1.3359, -1.3359],
         [-1.5312, -1.5312, -1.5078,  ..., -1.3213, -1.3359, -1.3359],
         [-1.5264, -1.5264, -1.5114,  ..., -1.3188, -1.3271, -1.3271],
         ...,
         [-1.2422, -1.2422, -1.2622,  ..., -1.4402, -1.4297, -1.4297],
         [-1.6143, -1.6143, -1.6388,  ..., -1.8545, -1.8418, -1.8418],
         [-2.3584, -2.3584, -2.3949,  ..., -2.6416, -2.6191, -2.6191]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Insects can help pollinate flowers effectively, but some insects also collect pollen and nectar to produce honey. What in the picture does not make honey? Please output segmentation mask. ASSISTANT: insects can help pollinate flowers effectively, but some insects also collect pollen and nectar to produce honey. what in the picture does not make honey</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[89]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 651, 500]) | end - start: 1
mask_positions_in_input_ids:  [[344]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 651, 500])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 651, 500])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 651, 500])):  [tensor([[[-3.6094, -3.4669, -2.9686,  ..., -3.0361, -3.1495, -3.2477],
         [-3.5641, -3.4346, -2.9815,  ..., -3.0281, -3.1480, -3.2528],
         [-3.4056, -3.3214, -3.0270,  ..., -3.0001, -3.1427, -3.2707],
         ...,
         [-2.8681, -2.6440, -1.8599,  ..., -1.8109, -2.1927, -2.5593],
         [-2.7155, -2.5106, -1.7937,  ..., -1.8218, -2.1408, -2.4324],
         [-2.6719, -2.4725, -1.7747,  ..., -1.8249, -2.1260, -2.3962]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Flowers are often used to decorate tables during special occasions or events. What item in the picture can be used to hold the flowers and keep them fresh by providing water to them? Please output segmentation mask. ASSISTANT: flowers are often used to decorate tables during special occasions or events. what item in the picture can be used to hold the flowers and keep them fresh by providing water to them</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1370, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1370, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1370, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1370, 2048])):  [tensor([[[-2.6875, -2.6875, -2.6875,  ..., -0.3477, -0.3477, -0.3477],
         [-2.6875, -2.6875, -2.6875,  ..., -0.3477, -0.3477, -0.3477],
         [-2.6875, -2.6875, -2.6875,  ..., -0.3477, -0.3477, -0.3477],
         ...,
         [-2.5400, -2.5400, -2.5400,  ..., -0.8503, -0.8503, -0.8503],
         [-2.5068, -2.5068, -2.5068,  ..., -1.0780, -1.0780, -1.0780],
         [-2.4902, -2.4902, -2.4902,  ..., -1.1918, -1.1918, -1.1918]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Bamboo is very hard, and its sharp edges can easily scratch people. What tool in the picture can I use to split the bamboo and cross this bamboo forest? Please output segmentation mask. ASSISTANT: bamboo is very hard, and its sharp edges can easily scratch people. what tool in the picture can i use to split the bamboo and cross this bamboo forest</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[92]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[347]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[-2.9531, -2.9531, -2.9455,  ..., -2.5865, -2.5938, -2.5938],
         [-2.9531, -2.9531, -2.9455,  ..., -2.5865, -2.5938, -2.5938],
         [-2.9561, -2.9561, -2.9484,  ..., -2.5907, -2.5977, -2.5977],
         ...,
         [-3.8580, -3.8580, -3.8488,  ..., -2.4896, -2.4777, -2.4777],
         [-4.4334, -4.4334, -4.4253,  ..., -3.0872, -3.0759, -3.0759],
         [-4.8809, -4.8809, -4.8736,  ..., -3.5557, -3.5449, -3.5449]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the damaged part on the pants in this image? Please output segmentation mask. ASSISTANT: the damaged part on the pants</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2304, 3072]) | end - start: 1
mask_positions_in_input_ids:  [[320]]

 25%|██▌       | 50/200 [00:21<00:51,  2.93it/s]
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2304, 3072])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2304, 3072])):  [tensor([[[-1.5469, -1.5469, -1.5469,  ..., -0.3887, -0.3887, -0.3887],
         [-1.5469, -1.5469, -1.5469,  ..., -0.3887, -0.3887, -0.3887],
         [-1.5469, -1.5469, -1.5469,  ..., -0.3887, -0.3887, -0.3887],
         ...,
         [-1.6937, -1.6937, -1.6937,  ..., -1.0531, -1.0531, -1.0531],
         [-1.7334, -1.7334, -1.7334,  ..., -1.1865, -1.1865, -1.1865],
         [-1.7334, -1.7334, -1.7334,  ..., -1.1865, -1.1865, -1.1865]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Seafood dishes often include a tangy condiment that enhances the flavor. What item in the picture can be squeezed onto the seafood as a tangy flavor enhancer? Please output segmentation mask. ASSISTANT: seafood dishes often include a tangy condiment that enhances the flavor. what item in the picture can be squeezed onto the seafood as a tangy flavor enhancer</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[96]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1080, 1080]) | end - start: 1
mask_positions_in_input_ids:  [[351]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1080, 1080])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1080, 1080])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1080, 1080])):  [tensor([[[-1.5000, -1.5000, -1.4966,  ..., -2.4205, -2.4375, -2.4375],
         [-1.5000, -1.5000, -1.4966,  ..., -2.4205, -2.4375, -2.4375],
         [-1.5314, -1.5314, -1.5267,  ..., -2.4581, -2.4749, -2.4749],
         ...,
         [-1.4075, -1.4075, -1.4055,  ..., -1.2999, -1.2935, -1.2935],
         [-1.3828, -1.3828, -1.3854,  ..., -1.3037, -1.2969, -1.2969],
         [-1.3828, -1.3828, -1.3854,  ..., -1.3037, -1.2969, -1.2969]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Dogs often like to find a comfortable place to rest. What object in the picture can offer a soft and comfortable surface for the dog to lie on? Please output segmentation mask. ASSISTANT: dogs often like to find a comfortable place to rest. what object in the picture can offer a soft and comfortable surface for the dog to lie on</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[82]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 299, 400]) | end - start: 1
mask_positions_in_input_ids:  [[337]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 299, 400])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 299, 400])):  [tensor([[[1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 0., 0., 1.],
         ...,
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 299, 400])):  [tensor([[[-1.2812, -1.3711, -1.4653,  ..., -2.4502, -2.4822, -2.5469],
         [ 1.4898,  1.6592,  1.8986,  ..., -2.6183, -2.5148, -2.4177],
         [ 4.5948,  5.0780,  5.7016,  ..., -2.6997, -2.4753, -2.2334],
         ...,
         [ 4.6375,  5.0729,  5.5251,  ...,  3.0034,  2.8607,  2.7053],
         [ 1.3793,  1.4671,  1.5737,  ...,  0.8186,  0.5607,  0.2642],
         [-2.9408, -3.1659, -3.3881,  ..., -3.5078, -3.7189, -3.9884]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the area that people can walk on in this image? Please output segmentation mask. ASSISTANT: the area that people can walk on</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 300, 400]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 300, 400])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 300, 400])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 300, 400])):  [tensor([[[-3.4531, -3.1656, -2.9045,  ..., -1.7155, -1.4720, -1.1953],
         [-3.5538, -3.2993, -3.0737,  ..., -1.9202, -1.7526, -1.5619],
         [-3.5303, -3.3218, -3.1473,  ..., -2.0822, -1.9884, -1.8820],
         ...,
         [-3.4451, -3.6776, -4.0265,  ..., -3.6770, -3.1263, -2.6260],
         [-3.2147, -3.4102, -3.7184,  ..., -3.6932, -3.1980, -2.7709],
         [-3.8965, -4.0078, -4.2342,  ..., -4.2802, -3.8309, -3.4478]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When admiring a beautiful sunset, what part of the picture would we most likely focus on? Please output segmentation mask. ASSISTANT: when admiring a beautiful sunset, what part of the picture would we most likely focus on</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[71]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1542, 3494]) | end - start: 1
mask_positions_in_input_ids:  [[326]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1542, 3494])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1542, 3494])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1542, 3494])):  [tensor([[[-6.5625, -6.5625, -6.5625,  ..., -7.1562, -7.1562, -7.1562],
         [-6.5625, -6.5625, -6.5625,  ..., -7.1562, -7.1562, -7.1562],
         [-6.5625, -6.5625, -6.5625,  ..., -7.1562, -7.1562, -7.1562],
         ...,
         [-0.9552, -0.9552, -0.9552,  ..., -2.7966, -2.7966, -2.7966],
         [-1.2092, -1.2092, -1.2092,  ..., -2.9443, -2.9443, -2.9443],
         [-1.2092, -1.2092, -1.2092,  ..., -2.9443, -2.9443, -2.9443]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n As a speaker, relying solely on verbal explanations may not effectively convey the intended message to the audience. What area of the picture should be used to project the key content and make it more understandable for the audience during the presentation? Please output segmentation mask. ASSISTANT: as a speaker, relying solely on verbal explanations may not effectively convey the intended message to the audience. what area of the picture should be used to project the key content and make it more understandable for the audience during the presentation</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[101]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2848, 4288]) | end - start: 1
mask_positions_in_input_ids:  [[356]]

 27%|██▋       | 54/200 [00:23<00:54,  2.67it/s]
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2848, 4288])):  [tensor([[[0., 0., 0.,  ..., 1., 1., 1.],
         [0., 0., 0.,  ..., 1., 1., 1.],
         [0., 0., 0.,  ..., 1., 1., 1.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2848, 4288])):  [tensor([[[-1.6250, -1.6250, -1.6250,  ..., -1.5000, -1.5000, -1.5000],
         [-1.6250, -1.6250, -1.6250,  ..., -1.5000, -1.5000, -1.5000],
         [-1.6250, -1.6250, -1.6250,  ..., -1.5000, -1.5000, -1.5000],
         ...,
         [-2.1035, -2.1035, -2.1035,  ..., -1.1939, -1.1939, -1.1939],
         [-2.1387, -2.1387, -2.1387,  ..., -1.2173, -1.2173, -1.2173],
         [-2.1387, -2.1387, -2.1387,  ..., -1.2173, -1.2173, -1.2173]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a modern office, what object in the picture is commonly used for inputting data and controlling the computer? Please output segmentation mask. ASSISTANT: in a modern office, what object in the picture is commonly used for inputting data and controlling the computer</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[74]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1024, 1280]) | end - start: 1
mask_positions_in_input_ids:  [[329]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1024, 1280])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1024, 1280])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1024, 1280])):  [tensor([[[-3.0938, -3.0938, -3.0791,  ..., -4.1016, -4.0625, -4.0625],
         [-3.0938, -3.0938, -3.0791,  ..., -4.1016, -4.0625, -4.0625],
         [-3.0459, -3.0459, -3.0339,  ..., -4.0749, -4.0371, -4.0371],
         ...,
         [-0.6604, -0.6604, -0.6299,  ..., -1.6680, -1.6388, -1.6388],
         [-1.0757, -1.0757, -1.0563,  ..., -1.9721, -1.9381, -1.9381],
         [-1.5479, -1.5479, -1.5382,  ..., -2.3697, -2.3330, -2.3330]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a zoo, there are separate areas designated for different animals. What structure in the picture is used to confine and display animals? Please output segmentation mask. ASSISTANT: in a zoo, there are separate areas designated for different animals. what structure in the picture is used to confine and display animals</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[78]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1944, 2592]) | end - start: 1
mask_positions_in_input_ids:  [[333]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1944, 2592])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[0., 0., 1.,  ..., 0., 0., 0.],
         [0., 0., 1.,  ..., 0., 0., 0.],
         [0., 0., 1.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[-4.2812, -4.2812, -4.2812,  ..., -2.4062, -2.4062, -2.4062],
         [-4.2812, -4.2812, -4.2812,  ..., -2.4062, -2.4062, -2.4062],
         [-4.2812, -4.2812, -4.2812,  ..., -2.4062, -2.4062, -2.4062],
         ...,
         [-4.9132, -4.9132, -4.9132,  ..., -4.5497, -4.5497, -4.5497],
         [-5.1354, -5.1354, -5.1354,  ..., -5.0142, -5.0142, -5.0142],
         [-5.1875, -5.1875, -5.1875,  ..., -5.1230, -5.1230, -5.1230]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that tastes spicy in this image? Please output segmentation mask. ASSISTANT: something that tastes spicy</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]

 30%|██▉       | 59/200 [00:26<00:59,  2.39it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[-6.2812, -6.2812, -6.2891,  ..., -4.9297, -4.9062, -4.9062],
         [-6.2812, -6.2812, -6.2891,  ..., -4.9297, -4.9062, -4.9062],
         [-6.4727, -6.4727, -6.4941,  ..., -4.9712, -4.9453, -4.9453],
         ...,
         [-0.1890, -0.1890, -0.1756,  ..., -0.5691, -0.6265, -0.6265],
         [-1.5991, -1.5991, -1.6288,  ..., -1.7995, -1.8530, -1.8530],
         [-3.6958, -3.6958, -3.8330,  ..., -3.9528, -4.0200, -4.0200]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When going fishing on a calm sea, what type of boat shown in the picture would be an ideal choice for a peaceful fishing experience? Please output segmentation mask. ASSISTANT: when going fishing on a calm sea, what type of boat shown in the picture would be an ideal choice for a peaceful fishing experience</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[336]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-3.2065, -3.1133, -3.1641,  ..., -3.0355, -3.0960, -3.1084],
         [-2.6299, -2.7287, -2.7344,  ..., -2.8422, -2.9628, -3.0638],
         [-2.7584, -2.7906, -2.7500,  ..., -2.6562, -2.7305, -2.8110],
         ...,
         [-1.1756, -1.1635, -1.1963,  ..., -0.4731, -0.4641, -0.4265],
         [-1.5133, -1.5166, -1.5105,  ..., -0.7169, -0.7501, -0.6347],
         [-2.0155, -2.1182, -2.1228,  ..., -1.7120, -1.7397, -1.6616]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Insects have various ways to protect themselves from predators. What characteristics can a moth use to deter potential threats? Please output segmentation mask. ASSISTANT: insects have various ways to protect themselves from predators. what characteristics can a moth use to deter potential threats</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[77]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3872, 2592]) | end - start: 1
mask_positions_in_input_ids:  [[332]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3872, 2592])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3872, 2592])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3872, 2592])):  [tensor([[[-1.8438, -1.8438, -1.8438,  ..., -0.6908, -0.7192, -0.7192],
         [-1.8438, -1.8438, -1.8438,  ..., -0.6908, -0.7192, -0.7192],
         [-1.8438, -1.8438, -1.8438,  ..., -0.6908, -0.7192, -0.7192],
         ...,
         [-2.2344, -2.2344, -2.2344,  ..., -2.3066, -2.3223, -2.3223],
         [-2.2344, -2.2344, -2.2344,  ..., -2.3066, -2.3223, -2.3223],
         [-2.2344, -2.2344, -2.2344,  ..., -2.3066, -2.3223, -2.3223]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Fishing is a popular activity for relaxation and leisure. What tool is the man in the picture using to catch fish? Please output segmentation mask. ASSISTANT: fishing is a popular activity for relaxation and leisure. what tool is the man in the picture using to catch fish</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[78]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[333]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[-1.5781, -1.5781, -1.5865,  ..., -1.7852, -1.7891, -1.7891],
         [-1.5781, -1.5781, -1.5865,  ..., -1.7852, -1.7891, -1.7891],
         [-1.4967, -1.4967, -1.5048,  ..., -1.6853, -1.6894, -1.6894],
         ...,
         [-5.3894, -5.3894, -5.3972,  ..., -2.7772, -2.7835, -2.7835],
         [-6.2125, -6.2125, -6.2210,  ..., -4.6867, -4.6921, -4.6921],
         [-6.8594, -6.8594, -6.8684,  ..., -6.1340, -6.1387, -6.1387]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In some cultures, people use sculptures and figurines to represent various aspects of life, including celebrations, rituals, and art. What object in the picture can be considered a representation of a human figure? Please output segmentation mask. ASSISTANT: in some cultures, people use sculptures and figurines to represent various aspects of life, including celebrations, rituals, and art. what object in the picture can be considered a representation of a human figure</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[95]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2868, 4309]) | end - start: 1
mask_positions_in_input_ids:  [[350]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2868, 4309])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2868, 4309])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2868, 4309])):  [tensor([[[-0.8164, -0.8164, -0.8164,  ..., -0.8984, -0.8984, -0.8984],
         [-0.8164, -0.8164, -0.8164,  ..., -0.8984, -0.8984, -0.8984],
         [-0.8164, -0.8164, -0.8164,  ..., -0.8984, -0.8984, -0.8984],
         ...,
         [-2.8279, -2.8279, -2.8279,  ..., -1.2162, -1.2162, -1.2162],
         [-2.8701, -2.8701, -2.8701,  ..., -1.2576, -1.2576, -1.2576],
         [-2.8701, -2.8701, -2.8701,  ..., -1.2576, -1.2576, -1.2576]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the shadow of the red car in this image? Please output segmentation mask. ASSISTANT: the shadow of the red car</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]

 32%|███▏      | 64/200 [00:28<00:52,  2.60it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2736, 3648]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2736, 3648])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2736, 3648])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2736, 3648])):  [tensor([[[-2.8594, -2.8594, -2.8594,  ..., -2.9062, -2.9062, -2.9062],
         [-2.8594, -2.8594, -2.8594,  ..., -2.9062, -2.9062, -2.9062],
         [-2.8594, -2.8594, -2.8594,  ..., -2.9062, -2.9062, -2.9062],
         ...,
         [-2.0262, -2.0262, -2.0262,  ..., -2.4503, -2.4503, -2.4503],
         [-2.3323, -2.3323, -2.3323,  ..., -2.8787, -2.8787, -2.8787],
         [-2.3323, -2.3323, -2.3323,  ..., -2.8787, -2.8787, -2.8787]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the part of this animal's body that comes into contact with the air in this image? Please output segmentation mask. ASSISTANT: the part of this animal's body that comes into contact with the air</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[72]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1000, 1504]) | end - start: 1
mask_positions_in_input_ids:  [[327]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1000, 1504])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1000, 1504])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1000, 1504])):  [tensor([[[-1.1641, -1.1641, -1.1599,  ..., -1.5293, -1.5312, -1.5312],
         [-1.1641, -1.1641, -1.1599,  ..., -1.5293, -1.5312, -1.5312],
         [-1.1515, -1.1515, -1.1475,  ..., -1.5202, -1.5220, -1.5220],
         ...,
         [-1.2914, -1.2914, -1.2942,  ..., -1.2059, -1.2042, -1.2042],
         [-1.4444, -1.4444, -1.4462,  ..., -1.3343, -1.3319, -1.3319],
         [-1.5615, -1.5615, -1.5626,  ..., -1.4326, -1.4297, -1.4297]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Many people use bags to carry their belongings when they go out. What part of the bag in the picture can be used to carry the bag comfortably over the shoulder? Please output segmentation mask. ASSISTANT: many people use bags to carry their belongings when they go out. what part of the bag in the picture can be used to carry the bag comfortably over the shoulder</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1920, 2560]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1920, 2560])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1920, 2560])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1920, 2560])):  [tensor([[[-1.1406, -1.1406, -1.1406,  ..., -0.9492, -0.9492, -0.9492],
         [-1.1406, -1.1406, -1.1406,  ..., -0.9492, -0.9492, -0.9492],
         [-1.1406, -1.1406, -1.1406,  ..., -0.9492, -0.9492, -0.9492],
         ...,
         [-1.2871, -1.2871, -1.2871,  ..., -1.4404, -1.4404, -1.4404],
         [-1.4363, -1.4363, -1.4363,  ..., -1.6776, -1.6776, -1.6776],
         [-1.4736, -1.4736, -1.4736,  ..., -1.7368, -1.7368, -1.7368]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n During a meal, people typically use utensils to bring food to their mouths. What tool in the picture can be used to fulfill this need? Please output segmentation mask. ASSISTANT: during a meal, people typically use utensils to bring food to their mouths. what tool in the picture can be used to fulfill this need</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[84]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[339]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-2.5938, -2.5650, -2.4297,  ..., -1.7211, -1.6418, -1.6250],
         [-2.5954, -2.5687, -2.4431,  ..., -1.7436, -1.6681, -1.6521],
         [-2.6031, -2.5862, -2.5066,  ..., -1.8498, -1.7920, -1.7797],
         ...,
         [-1.4086, -1.4195, -1.4712,  ..., -1.0748, -1.0408, -1.0336],
         [-1.4518, -1.4634, -1.5179,  ..., -1.2630, -1.2346, -1.2286],
         [-1.7525, -1.7589, -1.7892,  ..., -1.6723, -1.6280, -1.6186]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n During the move, what object can be used to store and transport various sundries and small household items, which is sturdy and relatively easy to carry? Please output segmentation mask. ASSISTANT: during the move, what object can be used to store and transport various sundries and small household items, which is sturdy and relatively easy to carry</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[84]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[339]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-0.2080, -0.1187, -0.0752,  ...,  0.0962,  0.0997,  0.1024],
         [ 0.6162,  0.7649,  0.8229,  ...,  1.0382,  0.9577,  1.0894],
         [ 0.8014,  0.9438,  1.0732,  ...,  1.1367,  1.1053,  1.2302],
         ...,
         [-3.9828, -3.8969, -3.5625,  ..., -1.8320, -1.9762, -2.0648],
         [-3.6510, -3.6209, -3.2195,  ..., -1.9191, -2.1709, -2.2440],
         [-3.4923, -3.3923, -3.3506,  ..., -2.6131, -2.7984, -2.7401]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n If we were to take a flight in the sky, what part of the plane in the picture would be spinning to generate lift and propel the aircraft forward? Please output segmentation mask. ASSISTANT: if we were to take a flight in the sky, what part of the plane in the picture would be spinning to generate lift and propel the aircraft forward</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[84]]

 34%|███▍      | 69/200 [00:30<00:44,  2.92it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2499, 3680]) | end - start: 1
mask_positions_in_input_ids:  [[339]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2499, 3680])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2499, 3680])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2499, 3680])):  [tensor([[[-3.3281, -3.3281, -3.3281,  ..., -3.2812, -3.2812, -3.2812],
         [-3.3281, -3.3281, -3.3281,  ..., -3.2812, -3.2812, -3.2812],
         [-3.3281, -3.3281, -3.3281,  ..., -3.2812, -3.2812, -3.2812],
         ...,
         [-0.7919, -0.7919, -0.7919,  ..., -0.5560, -0.5560, -0.5560],
         [-0.9984, -0.9984, -0.9984,  ..., -0.7634, -0.7634, -0.7634],
         [-0.9984, -0.9984, -0.9984,  ..., -0.7634, -0.7634, -0.7634]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something used by a Jedi warrior to attack enemies in this image? Please output segmentation mask. ASSISTANT: something used by a jedi warrior to attack enemies</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 720, 502]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 720, 502])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 720, 502])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 720, 502])):  [tensor([[[-1.5391, -1.4775, -1.2367,  ..., -0.9162, -1.2026, -1.4998],
         [-1.5508, -1.4917, -1.2606,  ..., -0.9644, -1.2359, -1.5175],
         [-1.5968, -1.5474, -1.3541,  ..., -1.1529, -1.3662, -1.5868],
         ...,
         [-0.8646, -0.8651, -0.8673,  ..., -1.2660, -1.2981, -1.3309],
         [-0.7049, -0.7104, -0.7321,  ..., -1.3012, -1.2727, -1.2417],
         [-0.6641, -0.6709, -0.6975,  ..., -1.3102, -1.2662, -1.2189]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What object in the picture should be used with water to create foam and effectively remove oil and dirt when your hands are very dirty? Please output segmentation mask. ASSISTANT: what object in the picture should be used with water to create foam and effectively remove oil and dirt when your hands are very dirty</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[79]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1704, 2272]) | end - start: 1
mask_positions_in_input_ids:  [[334]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1704, 2272])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[-3.2812, -3.2812, -3.2812,  ..., -2.8906, -2.8906, -2.8906],
         [-3.2812, -3.2812, -3.2812,  ..., -2.8906, -2.8906, -2.8906],
         [-3.2812, -3.2812, -3.2812,  ..., -2.8906, -2.8906, -2.8906],
         ...,
         [-3.0236, -3.0236, -3.0236,  ..., -3.5840, -3.5840, -3.5840],
         [-3.5923, -3.5923, -3.5923,  ..., -4.5629, -4.5629, -4.5629],
         [-3.8145, -3.8145, -3.8145,  ..., -4.9453, -4.9453, -4.9453]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a concert or public speaking event, what object in the picture would be used by the speaker or performer to amplify their voice? Please output segmentation mask. ASSISTANT: in a concert or public speaking event, what object in the picture would be used by the speaker or performer to amplify their voice</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[79]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 482, 720]) | end - start: 1
mask_positions_in_input_ids:  [[334]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 482, 720])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 482, 720])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 482, 720])):  [tensor([[[-2.7031, -2.6771, -2.5755,  ..., -2.5260, -2.6422, -2.6719],
         [-2.5736, -2.5504, -2.4597,  ..., -2.5410, -2.6383, -2.6632],
         [-2.0671, -2.0549, -2.0070,  ..., -2.5994, -2.6232, -2.6293],
         ...,
         [ 1.1234,  1.1655,  1.3298,  ...,  1.0468,  0.9582,  0.9355],
         [-0.9456, -0.9270, -0.8539,  ..., -0.9269, -0.9776, -0.9906],
         [-3.0444, -3.0497, -3.0706,  ..., -2.9276, -2.9413, -2.9448]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In the living room, people often sit on the sofa to watch TV or chat. What object can they use to adjust the TV screen or change channels? Please output segmentation mask. ASSISTANT: in the living room, people often sit on the sofa to watch tv or chat. what object can they use to adjust the tv screen or change channels</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[83]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[338]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-3.2622, -2.7956, -3.0295,  ..., -3.0292, -3.1367, -2.7669],
         [-2.6882, -2.5539, -2.5031,  ..., -2.4867, -2.4900, -2.4599],
         [-2.6358, -2.3727, -2.3125,  ..., -2.3262, -2.4281, -2.2992],
         ...,
         [-1.5421, -1.2803, -0.4172,  ..., -2.3379, -2.4422, -2.4529],
         [-1.4548, -1.2472, -0.6316,  ..., -2.4773, -2.5328, -2.5328],
         [-2.1152, -1.9487, -1.6184,  ..., -2.7255, -2.8933, -2.8184]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that produces pollen in this image? Please output segmentation mask. ASSISTANT: something that produces pollen</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[62]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1023, 1392]) | end - start: 1
mask_positions_in_input_ids:  [[317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1023, 1392])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1023, 1392])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1023, 1392])):  [tensor([[[-1.1484, -1.1484, -1.1350,  ..., -2.2859, -2.2812, -2.2812],
         [-1.1484, -1.1484, -1.1350,  ..., -2.2859, -2.2812, -2.2812],
         [-1.1092, -1.1092, -1.0963,  ..., -2.2931, -2.2886, -2.2886],
         ...,
         [-2.9794, -2.9794, -2.9930,  ..., -2.7954, -2.7958, -2.7958],
         [-2.9564, -2.9564, -2.9674,  ..., -2.8458, -2.8447, -2.8447],
         [-2.9375, -2.9375, -2.9463,  ..., -2.8871, -2.8848, -2.8848]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the part that can transmit traction and braking torque, coming into contact with the ground in this image? Please output segmentation mask. ASSISTANT: the part that can transmit traction and braking torque, coming into contact with the ground</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[76]]

 38%|███▊      | 75/200 [00:32<00:43,  2.86it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 752, 1169]) | end - start: 1
mask_positions_in_input_ids:  [[331]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 752, 1169])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 752, 1169])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 752, 1169])):  [tensor([[[-2.8438, -2.8438, -2.7952,  ..., -1.6324, -1.5859, -1.5859],
         [-2.8438, -2.8438, -2.7952,  ..., -1.6324, -1.5859, -1.5859],
         [-2.8964, -2.8964, -2.8497,  ..., -1.7160, -1.6703, -1.6703],
         ...,
         [-0.9602, -0.9602, -0.9631,  ..., -0.0529, -0.0822, -0.0822],
         [-1.2201, -1.2201, -1.2343,  ..., -0.5693, -0.5660, -0.5660],
         [-1.8223, -1.8223, -1.8490,  ..., -1.2376, -1.2183, -1.2183]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the area where people can stand without getting wet in this image? Please output segmentation mask. ASSISTANT: the area where people can stand without getting wet</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-5.4062, -5.4112, -5.4344,  ..., -5.5406, -5.6102, -5.6250],
         [-5.4194, -5.4249, -5.4509,  ..., -5.5188, -5.5969, -5.6135],
         [-5.4812, -5.4896, -5.5291,  ..., -5.4159, -5.5343, -5.5594],
         ...,
         [ 0.7789,  0.8058,  0.9324,  ...,  0.5373,  0.2758,  0.2203],
         [-0.9555, -0.9487, -0.9165,  ..., -1.8489, -2.0579, -2.1022],
         [-3.1258, -3.1452, -3.2369,  ..., -5.1282, -5.2970, -5.3328]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a motorcycle race, there are often sharp turns that require skilled maneuvering. What part of the race track in the picture indicates a sharp turn? Please output segmentation mask. ASSISTANT: in a motorcycle race, there are often sharp turns that require skilled maneuvering. what part of the race track in the picture indicates a sharp turn</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[85]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 682, 1023]) | end - start: 1
mask_positions_in_input_ids:  [[340]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 682, 1023])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 682, 1023])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         [0., 0., 0.,  ..., 1., 1., 1.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 682, 1023])):  [tensor([[[-6.9062, -6.9063, -6.9102,  ..., -3.8397, -3.8593, -3.8594],
         [-6.9061, -6.9061, -6.9100,  ..., -3.8399, -3.8595, -3.8595],
         [-6.8197, -6.8197, -6.8290,  ..., -3.8867, -3.9085, -3.9086],
         ...,
         [-1.5387, -1.5386, -1.4761,  ..., -0.2842, -0.2732, -0.2732],
         [-3.2404, -3.2403, -3.1999,  ..., -1.9708, -1.9436, -1.9436],
         [-5.0104, -5.0104, -4.9984,  ..., -3.7250, -3.6824, -3.6823]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the region showing current time in this image? Please output segmentation mask. ASSISTANT: the region showing current time</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[62]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[-2.9062, -2.9062, -2.8828,  ..., -2.7461, -2.7500, -2.7500],
         [-2.9062, -2.9062, -2.8828,  ..., -2.7461, -2.7500, -2.7500],
         [-2.8672, -2.8672, -2.8477,  ..., -2.6647, -2.6719, -2.6719],
         ...,
         [-3.5254, -3.5254, -3.5681,  ..., -2.5757, -2.5830, -2.5830],
         [-3.7441, -3.7441, -3.7871,  ..., -3.1963, -3.2031, -3.2031],
         [-4.1387, -4.1387, -4.1816,  ..., -4.1670, -4.1719, -4.1719]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the reflection of the object in this image? Please output segmentation mask. ASSISTANT: the reflection of the object</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[62]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2820, 3760]) | end - start: 1
mask_positions_in_input_ids:  [[317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2820, 3760])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2820, 3760])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2820, 3760])):  [tensor([[[-2.5469, -2.5469, -2.5469,  ..., -2.4688, -2.4688, -2.4688],
         [-2.5469, -2.5469, -2.5469,  ..., -2.4688, -2.4688, -2.4688],
         [-2.5469, -2.5469, -2.5469,  ..., -2.4688, -2.4688, -2.4688],
         ...,
         [-1.5762, -1.5762, -1.5762,  ..., -1.6379, -1.6379, -1.6379],
         [-1.7007, -1.7007, -1.7007,  ..., -1.8057, -1.8057, -1.8057],
         [-1.7007, -1.7007, -1.7007,  ..., -1.8057, -1.8057, -1.8057]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Dogs use their mouths to perform various tasks, including eating and vocalizing. What part of the dog's body is primarily responsible for these actions? Please output segmentation mask. ASSISTANT: dogs use their mouths to perform various tasks, including eating and vocalizing. what part of the dog's body is primarily responsible for these actions</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[84]]

 40%|███▉      | 79/200 [00:33<00:44,  2.74it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3264, 4928]) | end - start: 1
mask_positions_in_input_ids:  [[339]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3264, 4928])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3264, 4928])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3264, 4928])):  [tensor([[[-3.8594, -3.8594, -3.8594,  ...,  0.0786,  0.0786,  0.0786],
         [-3.8594, -3.8594, -3.8594,  ...,  0.0786,  0.0786,  0.0786],
         [-3.8594, -3.8594, -3.8594,  ...,  0.0786,  0.0786,  0.0786],
         ...,
         [-4.2255, -4.2255, -4.2255,  ..., -2.6719, -2.6719, -2.6719],
         [-4.2148, -4.2148, -4.2148,  ..., -2.6777, -2.6777, -2.6777],
         [-4.2148, -4.2148, -4.2148,  ..., -2.6777, -2.6777, -2.6777]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that protects the persons' heads in this image? Please output segmentation mask. ASSISTANT: something that protects the persons' heads</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1360, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1360, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1360, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1360, 2048])):  [tensor([[[-3.2500, -3.2500, -3.2500,  ..., -2.9375, -2.9375, -2.9375],
         [-3.2500, -3.2500, -3.2500,  ..., -2.9375, -2.9375, -2.9375],
         [-3.2500, -3.2500, -3.2500,  ..., -2.9375, -2.9375, -2.9375],
         ...,
         [-0.0791, -0.0791, -0.0791,  ..., -0.8741, -0.8741, -0.8741],
         [-0.5693, -0.5693, -0.5693,  ..., -1.2108, -1.2108, -1.2108],
         [-0.8145, -0.8145, -0.8145,  ..., -1.3792, -1.3792, -1.3792]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the transportation vehicle that does not require electricity or gasoline in this image? Please output segmentation mask. ASSISTANT: the transportation vehicle that does not require electricity or gasoline</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3456, 5184]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 5184])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3456, 5184])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3456, 5184])):  [tensor([[[-4.2500, -4.2500, -4.2500,  ..., -3.7188, -3.7188, -3.7188],
         [-4.2500, -4.2500, -4.2500,  ..., -3.7188, -3.7188, -3.7188],
         [-4.2500, -4.2500, -4.2500,  ..., -3.7188, -3.7188, -3.7188],
         ...,
         [-4.3301, -4.3301, -4.3301,  ..., -3.3340, -3.3340, -3.3340],
         [-4.3301, -4.3301, -4.3301,  ..., -3.3340, -3.3340, -3.3340],
         [-4.3301, -4.3301, -4.3301,  ..., -3.3340, -3.3340, -3.3340]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When constructing a house, what part of the building process involves assembling a sturdy base and framework? Please output segmentation mask. ASSISTANT: when constructing a house, what part of the building process involves assembling a sturdy base and framework</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[74]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[329]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[-4.1875, -4.1875, -4.1781,  ..., -2.6057, -2.5938, -2.5938],
         [-4.1875, -4.1875, -4.1781,  ..., -2.6057, -2.5938, -2.5938],
         [-4.1867, -4.1867, -4.1775,  ..., -2.6214, -2.6096, -2.6096],
         ...,
         [-2.0570, -2.0570, -2.0596,  ..., -3.4733, -3.4678, -3.4678],
         [-2.6395, -2.6395, -2.6417,  ..., -4.0092, -4.0015, -4.0015],
         [-3.0986, -3.0986, -3.1005,  ..., -4.4332, -4.4238, -4.4238]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n The office is a place where people focus on their work. What structure in the room can help block noise and reduces Interruptions from the outside environment? Please output segmentation mask. ASSISTANT: the office is a place where people focus on their work. what structure in the room can help block noise and reduces interruptions from the outside environment</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[82]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[337]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]

(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-1.7463, -1.5136, -1.6737,  ..., -0.8785, -0.9808, -0.6564],
         [-1.7821, -2.0442, -1.9906,  ..., -1.2867, -1.0420, -1.1903],
         [-1.4204, -1.7668, -1.5312,  ..., -0.8994, -0.8580, -1.1413],
         ...,
         [-1.1765, -1.2141,  0.0430,  ..., -1.7109, -1.7152, -1.1164],
         [-0.8225, -0.9847,  0.0957,  ..., -1.7836, -1.6987, -0.9687],
         [-1.2878, -1.4570, -0.7395,  ..., -2.1263, -2.1494, -1.8298]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the camera lens that is more suitable for photographing nearby objects in this image? Please output segmentation mask. ASSISTANT: the camera lens that is more suitable for photographing nearby objects</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1620, 2160]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1620, 2160])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1620, 2160])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1620, 2160])):  [tensor([[[-0.4336, -0.4336, -0.4336,  ..., -1.0469, -1.0469, -1.0469],
         [-0.4336, -0.4336, -0.4336,  ..., -1.0469, -1.0469, -1.0469],
         [-0.4336, -0.4336, -0.4336,  ..., -1.0469, -1.0469, -1.0469],
         ...,
         [-1.9026, -1.9026, -1.9026,  ..., -2.7549, -2.7549, -2.7549],
         [-2.4845, -2.4845, -2.4845,  ..., -3.7123, -3.7123, -3.7123],
         [-2.7437, -2.7437, -2.7437,  ..., -4.1387, -4.1387, -4.1387]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the part of the house that can be opened in this image? Please output segmentation mask. ASSISTANT: the part of the house that can be opened</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1704, 2272]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1704, 2272])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[-1.2266, -1.2266, -1.2266,  ...,  0.0275,  0.0275,  0.0275],
         [-1.2266, -1.2266, -1.2266,  ...,  0.0275,  0.0275,  0.0275],
         [-1.2266, -1.2266, -1.2266,  ...,  0.0275,  0.0275,  0.0275],
         ...,
         [-1.2504, -1.2504, -1.2504,  ..., -0.8771, -0.8771, -0.8771],
         [-1.3878, -1.3878, -1.3878,  ..., -1.1110, -1.1110, -1.1110],
         [-1.4414, -1.4414, -1.4414,  ..., -1.2024, -1.2024, -1.2024]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the source of power for the ship in this image? Please output segmentation mask. ASSISTANT: the source of power for the ship</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1536, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1536, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[-5.7500, -5.7500, -5.7500,  ..., -5.6875, -5.6875, -5.6875],
         [-5.7500, -5.7500, -5.7500,  ..., -5.6875, -5.6875, -5.6875],
         [-5.7500, -5.7500, -5.7500,  ..., -5.6875, -5.6875, -5.6875],
         ...,
         [-2.8877, -2.8877, -2.8877,  ..., -3.3230, -3.3230, -3.3230],
         [-4.0107, -4.0107, -4.0107,  ..., -5.0618, -5.0618, -5.0618],
         [-4.5723, -4.5723, -4.5723,  ..., -5.9312, -5.9312, -5.9312]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When hanging laundry outside to dry, what material in the picture would be suitable for holding the clothes securely in place? Please output segmentation mask. ASSISTANT: when hanging laundry outside to dry, what material in the picture would be suitable for holding the clothes securely in place</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[78]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2592, 3872]) | end - start: 1
mask_positions_in_input_ids:  [[333]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 3872])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2592, 3872])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2592, 3872])):  [tensor([[[-1.5234, -1.5234, -1.5234,  ..., -2.0469, -2.0469, -2.0469],
         [-1.5234, -1.5234, -1.5234,  ..., -2.0469, -2.0469, -2.0469],
         [-1.5234, -1.5234, -1.5234,  ..., -2.0469, -2.0469, -2.0469],
         ...,
         [-3.2474, -3.2474, -3.2474,  ..., -2.7315, -2.7315, -2.7315],
         [-3.4321, -3.4321, -3.4321,  ..., -2.9480, -2.9480, -2.9480],
         [-3.4321, -3.4321, -3.4321,  ..., -2.9480, -2.9480, -2.9480]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the friend of humans in this image? Please output segmentation mask. ASSISTANT: the friend of humans</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[61]]

 44%|████▍     | 88/200 [00:38<00:41,  2.67it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[316]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[-3.3594, -3.3594, -3.2852,  ..., -3.5625, -3.5781, -3.5781],
         [-3.3594, -3.3594, -3.2852,  ..., -3.5625, -3.5781, -3.5781],
         [-3.5137, -3.5137, -3.4395,  ..., -3.7451, -3.7402, -3.7402],
         ...,
         [-1.6396, -1.6396, -1.5914,  ..., -4.0291, -4.0332, -4.0332],
         [-2.1865, -2.1865, -2.1339,  ..., -4.0198, -4.0605, -4.0605],
         [-3.4189, -3.4189, -3.3724,  ..., -5.0164, -5.0254, -5.0254]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Dogs have keen sense of smell, which is why they can be used as drug-sniffing dogs. Which part in the picture gives dogs this characteristic? Please output segmentation mask. ASSISTANT: dogs have keen sense of smell, which is why they can be used as drug-sniffing dogs. which part in the picture gives dogs this characteristic</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[85]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[340]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[-2.1094, -2.1094, -2.0342,  ..., -1.3008, -1.2734, -1.2734],
         [-2.1094, -2.1094, -2.0342,  ..., -1.3008, -1.2734, -1.2734],
         [-2.1016, -2.1016, -2.0360,  ..., -1.3733, -1.3516, -1.3516],
         ...,
         [-1.1270, -1.1270, -1.1650,  ..., -1.1995, -1.2158, -1.2158],
         [-1.4131, -1.4131, -1.4470,  ..., -1.4523, -1.4639, -1.4639],
         [-2.0049, -2.0049, -2.0208,  ..., -1.9174, -1.9072, -1.9072]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the place where the patient lies down to receive examination in this image? Please output segmentation mask. ASSISTANT: the place where the patient lies down to receive examination</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2428, 3636]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2428, 3636])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2428, 3636])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2428, 3636])):  [tensor([[[-3.7344, -3.7344, -3.7344,  ..., -0.1631, -0.1631, -0.1631],
         [-3.7344, -3.7344, -3.7344,  ..., -0.1631, -0.1631, -0.1631],
         [-3.7344, -3.7344, -3.7344,  ..., -0.1631, -0.1631, -0.1631],
         ...,
         [-3.1179, -3.1179, -3.1179,  ..., -2.9516, -2.9516, -2.9516],
         [-3.2129, -3.2129, -3.2129,  ..., -3.0449, -3.0449, -3.0449],
         [-3.2129, -3.2129, -3.2129,  ..., -3.0449, -3.0449, -3.0449]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In an intense dragon boat race. What object in the picture should be struck to boost the morale of the competing team and cheer them on? Please output segmentation mask. ASSISTANT: in an intense dragon boat race. what object in the picture should be struck to boost the morale of the competing team and cheer them on</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[83]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 986, 1544]) | end - start: 1
mask_positions_in_input_ids:  [[338]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 986, 1544])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 986, 1544])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 986, 1544])):  [tensor([[[-0.4824, -0.4824, -0.4900,  ..., -0.3018, -0.3105, -0.3105],
         [-0.4824, -0.4824, -0.4900,  ..., -0.3018, -0.3105, -0.3105],
         [-0.4724, -0.4724, -0.4797,  ..., -0.2769, -0.2855, -0.2855],
         ...,
         [-1.8675, -1.8675, -1.8688,  ..., -1.8689, -1.8702, -1.8702],
         [-2.0955, -2.0955, -2.0971,  ..., -2.2074, -2.2097, -2.2097],
         [-2.2656, -2.2656, -2.2675,  ..., -2.4599, -2.4629, -2.4629]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the equipment for sweeping away rain on rainy days in this image? Please output segmentation mask. ASSISTANT: the equipment for sweeping away rain on rainy days</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1944, 2592]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1944, 2592])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[-0.7383, -0.7383, -0.7383,  ...,  0.1611,  0.1611,  0.1611],
         [-0.7383, -0.7383, -0.7383,  ...,  0.1611,  0.1611,  0.1611],
         [-0.7383, -0.7383, -0.7383,  ...,  0.1611,  0.1611,  0.1611],
         ...,
         [-0.9787, -0.9787, -0.9787,  ..., -1.2605, -1.2605, -1.2605],
         [-1.1427, -1.1427, -1.1427,  ..., -1.4078, -1.4078, -1.4078],
         [-1.1812, -1.1812, -1.1812,  ..., -1.4424, -1.4424, -1.4424]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Soldiers are often equipped with various tools and weapons to carry out their duties. What item in the picture can be classified as a weapon? Please output segmentation mask. ASSISTANT: soldiers are often equipped with various tools and weapons to carry out their duties. what item in the picture can be classified as a weapon</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 300, 400]) | end - start: 1
mask_positions_in_input_ids:  [[336]]

 47%|████▋     | 94/200 [00:40<00:30,  3.46it/s]
(PLUM.py) >> gt_masks (shape: torch.Size([1, 300, 400])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 300, 400])):  [tensor([[[-2.3125, -1.9927, -1.6707,  ..., -3.0230, -2.6453, -2.2500],
         [-2.4634, -2.1915, -1.9258,  ..., -3.0718, -2.7950, -2.5087],
         [-2.6348, -2.4106, -2.2033,  ..., -3.1120, -2.9256, -2.7387],
         ...,
         [-0.5162, -0.3038, -0.0900,  ..., -0.4009, -0.1836,  0.0226],
         [-0.6464, -0.4261, -0.2058,  ..., -0.4676, -0.3784, -0.3052],
         [-1.1473, -0.9816, -0.8222,  ..., -1.1207, -1.1344, -1.1672]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What object is used to cover the entrance of the bathroom and ensure privacy? Please output segmentation mask. ASSISTANT: what object is used to cover the entrance of the bathroom and ensure privacy</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-4.7109e-01, -3.3078e-01, -4.0630e-01,  ..., -1.7163e+00,
          -1.7188e+00, -2.0238e+00],
         [-9.6131e-02,  6.5576e-03, -1.4077e-01,  ..., -1.5793e+00,
          -1.6791e+00, -1.9175e+00],
         [ 2.4621e-02,  1.4006e-01,  1.4648e-03,  ..., -1.4844e+00,
          -1.5992e+00, -1.6476e+00],
         ...,
         [-1.0709e+00, -9.9844e-01, -1.0693e+00,  ..., -2.3418e+00,
          -2.3715e+00, -2.3366e+00],
         [-1.2833e+00, -1.1823e+00, -1.2766e+00,  ..., -2.5273e+00,
          -2.5925e+00, -2.4679e+00],
         [-1.7313e+00, -1.6680e+00, -1.8315e+00,  ..., -2.6829e+00,
          -2.6880e+00, -2.6152e+00]]], device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the person in the air in this image? Please output segmentation mask. ASSISTANT: the person in the air</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[62]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3034, 2148]) | end - start: 1
mask_positions_in_input_ids:  [[317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3034, 2148])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3034, 2148])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3034, 2148])):  [tensor([[[-3.9688, -3.9688, -3.9688,  ..., -2.8956, -2.9233, -2.9238],
         [-3.9688, -3.9688, -3.9688,  ..., -2.8956, -2.9233, -2.9238],
         [-3.9688, -3.9688, -3.9688,  ..., -2.8956, -2.9233, -2.9238],
         ...,
         [-2.7031, -2.7031, -2.7031,  ..., -2.1033, -2.2675, -2.2705],
         [-2.7031, -2.7031, -2.7031,  ..., -2.1033, -2.2675, -2.2705],
         [-2.7031, -2.7031, -2.7031,  ..., -2.1033, -2.2675, -2.2705]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is a place where bees can suck nectar from flowers in this image? Please output segmentation mask. ASSISTANT: a place where bees can suck nectar from flowers</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 566, 939]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 566, 939])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 566, 939])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 566, 939])):  [tensor([[[-1.8203, -1.8109, -1.7196,  ..., -0.7829, -0.6716, -0.6602],
         [-1.8103, -1.8009, -1.7099,  ..., -0.7881, -0.6779, -0.6666],
         [-1.7127, -1.7036, -1.6157,  ..., -0.8393, -0.7392, -0.7289],
         ...,
         [-0.9809, -0.9871, -1.0467,  ..., -0.6519, -0.6334, -0.6315],
         [-1.1867, -1.1923, -1.2470,  ..., -0.7025, -0.6707, -0.6674],
         [-1.4294, -1.4342, -1.4800,  ..., -0.7494, -0.6972, -0.6919]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n I want to take a trip around the world, but I need some transportation to help me cross the oceans. What type of transportation in the picture can fulfill this requirement? Please output segmentation mask. ASSISTANT: i want to take a trip around the world, but i need some transportation to help me cross the oceans. what type of transportation in the picture can fulfill this requirement</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[90]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 960, 1280]) | end - start: 1
mask_positions_in_input_ids:  [[345]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 960, 1280])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 960, 1280])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 960, 1280])):  [tensor([[[-3.7812, -3.7812, -3.7646,  ..., -2.0103, -1.9766, -1.9766],
         [-3.7812, -3.7812, -3.7646,  ..., -2.0103, -1.9766, -1.9766],
         [-3.7910, -3.7910, -3.7773,  ..., -2.0302, -1.9985, -1.9985],
         ...,
         [-0.4147, -0.4147, -0.3920,  ..., -1.2956, -1.2771, -1.2771],
         [-1.1742, -1.1742, -1.1681,  ..., -2.2513, -2.2344, -2.2344],
         [-2.0385, -2.0385, -2.0529,  ..., -3.4627, -3.4478, -3.4478]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is where we can see the speed of the car in this image? Please output segmentation mask. ASSISTANT: where we can see the speed of the car</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1536, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1536, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[-3.0312, -3.0312, -3.0312,  ..., -2.0469, -2.0469, -2.0469],
         [-3.0312, -3.0312, -3.0312,  ..., -2.0469, -2.0469, -2.0469],
         [-3.0312, -3.0312, -3.0312,  ..., -2.0469, -2.0469, -2.0469],
         ...,
         [-2.0679, -2.0679, -2.0679,  ..., -2.5000, -2.5000, -2.5000],
         [-2.5142, -2.5142, -2.5142,  ..., -2.7500, -2.7500, -2.7500],
         [-2.7373, -2.7373, -2.7373,  ..., -2.8750, -2.8750, -2.8750]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When a photographer wants to adjust the focus of a camera lens, what part in the picture could they manipulate to achieve this? Please output segmentation mask. ASSISTANT: when a photographer wants to adjust the focus of a camera lens, what part in the picture could they manipulate to achieve this</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[78]]

 50%|█████     | 100/200 [00:42<00:27,  3.60it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1584, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[333]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1584, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1584, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1584, 1600])):  [tensor([[[-5.2188, -5.2188, -5.2164,  ..., -3.5471, -3.5469, -3.5469],
         [-5.2188, -5.2188, -5.2164,  ..., -3.5471, -3.5469, -3.5469],
         [-5.2066, -5.2066, -5.2044,  ..., -3.5345, -3.5343, -3.5343],
         ...,
         [-4.5937, -4.5937, -4.5987,  ..., -4.1795, -4.1750, -4.1750],
         [-4.7437, -4.7437, -4.7489,  ..., -4.2355, -4.2300, -4.2300],
         [-4.8516, -4.8516, -4.8569,  ..., -4.2758, -4.2695, -4.2695]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is unopened flower bud in this image? Please output segmentation mask. ASSISTANT: unopened flower bud</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[62]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 566, 850]) | end - start: 1
mask_positions_in_input_ids:  [[317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 566, 850])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 566, 850])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 566, 850])):  [tensor([[[-0.8555, -0.8541, -0.8466,  ..., -0.3818, -0.3843, -0.3848],
         [-0.8594, -0.8577, -0.8485,  ..., -0.3656, -0.3648, -0.3647],
         [-0.8812, -0.8778, -0.8590,  ..., -0.2750, -0.2557, -0.2523],
         ...,
         [-1.3252, -1.3219, -1.3036,  ..., -0.5167, -0.5124, -0.5117],
         [-1.6076, -1.6029, -1.5765,  ..., -0.7025, -0.7063, -0.7070],
         [-1.8900, -1.8839, -1.8494,  ..., -0.8883, -0.9002, -0.9023]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n This image depicts a forest. Which of the animals in the picture pose a threat to human safety? Please output segmentation mask. ASSISTANT: this image depicts a forest. which of the animals in the picture pose a threat to human safety</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[73]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 300, 400]) | end - start: 1
mask_positions_in_input_ids:  [[328]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 300, 400])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 300, 400])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 300, 400])):  [tensor([[[-5.2500, -5.1063, -4.9906,  ..., -1.9995, -1.8030, -1.6484],
         [-5.7962, -5.4674, -5.1750,  ..., -2.2431, -1.9315, -1.6844],
         [-6.2645, -5.7685, -5.3211,  ..., -2.4427, -2.0363, -1.7142],
         ...,
         [-2.3625, -2.2655, -2.2582,  ...,  0.4052,  0.6382,  0.7929],
         [-2.5184, -2.2663, -2.0787,  ...,  0.1386,  0.2568,  0.3371],
         [-3.4759, -3.1385, -2.8617,  ..., -1.7762, -1.7667, -1.7592]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a graduation ceremony, it is a tradition for the graduates to wear a specific type of clothing to signify their achievement. What item of clothing can be seen in the picture that is commonly worn by graduates? Please output segmentation mask. ASSISTANT: in a graduation ceremony, it is a tradition for the graduates to wear a specific type of clothing to signify their achievement. what item of clothing can be seen in the picture that is commonly worn by graduates</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[99]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3456, 2304]) | end - start: 1
mask_positions_in_input_ids:  [[354]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 2304])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3456, 2304])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3456, 2304])):  [tensor([[[-2.4844, -2.4844, -2.4844,  ..., -1.8557, -1.8799, -1.8799],
         [-2.4844, -2.4844, -2.4844,  ..., -1.8557, -1.8799, -1.8799],
         [-2.4844, -2.4844, -2.4844,  ..., -1.8557, -1.8799, -1.8799],
         ...,
         [-1.6094, -1.6094, -1.6094,  ..., -1.2612, -1.2676, -1.2676],
         [-1.6094, -1.6094, -1.6094,  ..., -1.2612, -1.2676, -1.2676],
         [-1.6094, -1.6094, -1.6094,  ..., -1.2612, -1.2676, -1.2676]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When visiting a library or bookstore, people often browse through the shelves to find interesting books to read. Which area in the picture could provide a variety of reading materials for visitors? Please output segmentation mask. ASSISTANT: when visiting a library or bookstore, people often browse through the shelves to find interesting books to read. which area in the picture could provide a variety of reading materials for visitors</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[91]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 4000, 2683]) | end - start: 1
mask_positions_in_input_ids:  [[346]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 4000, 2683])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 4000, 2683])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 4000, 2683])):  [tensor([[[-10.0625, -10.0625, -10.0625,  ...,  -6.3968,  -6.4805,  -6.4805],
         [-10.0625, -10.0625, -10.0625,  ...,  -6.3968,  -6.4805,  -6.4805],
         [-10.0625, -10.0625, -10.0625,  ...,  -6.3968,  -6.4805,  -6.4805],
         ...,
         [ -8.6250,  -8.6250,  -8.6250,  ...,  -7.8883,  -7.9414,  -7.9414],
         [ -8.6250,  -8.6250,  -8.6250,  ...,  -7.8883,  -7.9414,  -7.9414],
         [ -8.6250,  -8.6250,  -8.6250,  ...,  -7.8883,  -7.9414,  -7.9414]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the person who appears to have already won in the battle in this image? Please output segmentation mask. ASSISTANT: the person who appears to have already won in the battle</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]

 52%|█████▏    | 104/200 [00:44<00:33,  2.90it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1504, 2256]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1504, 2256])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1504, 2256])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1504, 2256])):  [tensor([[[-2.0156, -2.0156, -2.0156,  ..., -1.1953, -1.1953, -1.1953],
         [-2.0156, -2.0156, -2.0156,  ..., -1.1953, -1.1953, -1.1953],
         [-2.0156, -2.0156, -2.0156,  ..., -1.1953, -1.1953, -1.1953],
         ...,
         [-0.3342, -0.3342, -0.3342,  ..., -0.7196, -0.7196, -0.7196],
         [-0.5638, -0.5638, -0.5638,  ..., -0.8642, -0.8642, -0.8642],
         [-0.6554, -0.6554, -0.6554,  ..., -0.9219, -0.9219, -0.9219]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a healthy meal, vegetables are often included to provide essential nutrients. What in the picture can be used to eat the vegetables? Please output segmentation mask. ASSISTANT: in a healthy meal, vegetables are often included to provide essential nutrients. what in the picture can be used to eat the vegetables</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[83]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 854, 1280]) | end - start: 1
mask_positions_in_input_ids:  [[338]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 854, 1280])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 854, 1280])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 854, 1280])):  [tensor([[[-1.9609, -1.9609, -1.9287,  ..., -1.6250, -1.6094, -1.6094],
         [-1.9609, -1.9609, -1.9287,  ..., -1.6250, -1.6094, -1.6094],
         [-1.9483, -1.9483, -1.9201,  ..., -1.6638, -1.6494, -1.6494],
         ...,
         [ 0.1644,  0.1644,  0.1763,  ..., -0.6800, -0.6622, -0.6622],
         [-0.7050, -0.7050, -0.6973,  ..., -0.9286, -0.9063, -0.9063],
         [-1.6069, -1.6069, -1.6054,  ..., -1.3500, -1.3271, -1.3271]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that prevents people from getting into the building in this image? Please output segmentation mask. ASSISTANT: something that prevents people from getting into the building</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         ...,
         [255., 255., 255.,  ..., 255., 255., 255.],
         [255., 255., 255.,  ..., 255., 255., 255.],
         [255., 255., 255.,  ..., 255., 255., 255.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-4.3125, -4.2748, -4.0969,  ..., -2.8203, -2.4529, -2.3750],
         [-4.2805, -4.2446, -4.0752,  ..., -2.8190, -2.4683, -2.3939],
         [-4.1297, -4.1023, -3.9731,  ..., -2.8128, -2.5406, -2.4828],
         ...,
         [-1.6859, -1.6861, -1.6871,  ..., -2.1101, -2.0341, -2.0180],
         [-1.8889, -1.8863, -1.8739,  ..., -2.3120, -2.2343, -2.2178],
         [-2.7455, -2.7377, -2.7010,  ..., -2.9918, -2.8563, -2.8275]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that the monkey uses to pierce its food in this image? Please output segmentation mask. ASSISTANT: something that the monkey uses to pierce its food</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1600, 1066]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1600, 1066])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1600, 1066])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1600, 1066])):  [tensor([[[-1.5625, -1.5625, -1.5526,  ..., -1.1064, -1.2419, -1.3394],
         [-1.5625, -1.5625, -1.5526,  ..., -1.1064, -1.2419, -1.3394],
         [-1.5622, -1.5622, -1.5524,  ..., -1.1122, -1.2459, -1.3420],
         ...,
         [-0.8336, -0.8336, -0.8233,  ..., -0.9552, -1.0409, -1.1025],
         [-0.8320, -0.8320, -0.8216,  ..., -0.9501, -1.0357, -1.0972],
         [-0.8320, -0.8320, -0.8216,  ..., -0.9501, -1.0357, -1.0972]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that avoids falling down in this image? Please output segmentation mask. ASSISTANT: something that avoids falling down</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1224, 1632]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1224, 1632])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1224, 1632])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1224, 1632])):  [tensor([[[-1.4297, -1.4297, -1.4267,  ..., -2.4072, -2.4062, -2.4062],
         [-1.4297, -1.4297, -1.4267,  ..., -2.4072, -2.4062, -2.4062],
         [-1.4261, -1.4261, -1.4231,  ..., -2.3981, -2.3971, -2.3971],
         ...,
         [-2.4994, -2.4994, -2.4987,  ..., -1.2305, -1.2239, -1.2239],
         [-2.8075, -2.8075, -2.8075,  ..., -1.8587, -1.8531, -1.8531],
         [-3.0332, -3.0332, -3.0338,  ..., -2.3160, -2.3110, -2.3110]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the container that can be used to hold soup currently in this image? Please output segmentation mask. ASSISTANT: the container that can be used to hold soup currently</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[67]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[322]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-3.8750, -3.9127, -4.0906,  ..., -1.8523, -1.8195, -1.8125],
         [-3.8930, -3.9331, -4.1220,  ..., -1.8685, -1.8345, -1.8273],
         [-3.9781, -4.0291, -4.2697,  ..., -1.9445, -1.9052, -1.8969],
         ...,
         [-2.5359, -2.5330, -2.5191,  ...,  0.0194, -0.0472, -0.0613],
         [-2.8457, -2.8501, -2.8709,  ..., -1.1792, -1.2315, -1.2426],
         [-4.1365, -4.1667, -4.3089,  ..., -3.3798, -3.4070, -3.4127]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When you look closely into a person's eye, what is the part that surrounds the dark-colored iris and helps protect the eye from dust and debris? Please output segmentation mask. ASSISTANT: when you look closely into a person's eye, what is the part that surrounds the dark-colored iris and helps protect the eye from dust and debris</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]

 55%|█████▌    | 110/200 [00:46<00:29,  3.01it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1944, 2592]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1944, 2592])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[-1.9219, -1.9219, -1.9219,  ..., -1.4062, -1.4062, -1.4062],
         [-1.9219, -1.9219, -1.9219,  ..., -1.4062, -1.4062, -1.4062],
         [-1.9219, -1.9219, -1.9219,  ..., -1.4062, -1.4062, -1.4062],
         ...,
         [-1.5877, -1.5877, -1.5877,  ..., -1.1941, -1.1941, -1.1941],
         [-1.7682, -1.7682, -1.7682,  ..., -1.5321, -1.5321, -1.5321],
         [-1.8105, -1.8105, -1.8105,  ..., -1.6113, -1.6113, -1.6113]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the object that reaches the sky in this image? Please output segmentation mask. ASSISTANT: the object that reaches the sky</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2112, 2816]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2112, 2816])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2112, 2816])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2112, 2816])):  [tensor([[[-8.0625, -8.0625, -8.0625,  ..., -5.8438, -5.8438, -5.8438],
         [-8.0625, -8.0625, -8.0625,  ..., -5.8438, -5.8438, -5.8438],
         [-8.0625, -8.0625, -8.0625,  ..., -5.8438, -5.8438, -5.8438],
         ...,
         [-3.2302, -3.2302, -3.2302,  ..., -3.5654, -3.5654, -3.5654],
         [-3.7991, -3.7991, -3.7991,  ..., -4.0924, -4.0924, -4.0924],
         [-3.8701, -3.8701, -3.8701,  ..., -4.1582, -4.1582, -4.1582]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In an orchestra, musicians play different instruments. What object in the picture is commonly played with a bow to produce sound? Please output segmentation mask. ASSISTANT: in an orchestra, musicians play different instruments. what object in the picture is commonly played with a bow to produce sound</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[77]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 280, 330]) | end - start: 1
mask_positions_in_input_ids:  [[332]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 280, 330])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 280, 330])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 280, 330])):  [tensor([[[-1.6012, -1.2040, -1.4507,  ..., -2.3909, -2.5451, -1.8429],
         [-1.1705, -1.1057, -1.2044,  ..., -2.6924, -2.6987, -2.6378],
         [-0.9942, -0.8511, -0.9636,  ..., -2.7427, -2.7729, -2.5883],
         ...,
         [-0.5417, -0.1780, -0.1659,  ..., -2.0976, -2.1475, -1.9644],
         [-0.3893, -0.1398, -0.0142,  ..., -1.9991, -1.9966, -1.7121],
         [-1.0466, -1.0596, -0.9452,  ..., -2.2742, -2.2075, -1.8818]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What object in a typical modern kitchen can be used to quickly heat up leftovers, boil water, or cook frozen food? Please output segmentation mask. ASSISTANT: what object in a typical modern kitchen can be used to quickly heat up leftovers, boil water, or cook frozen food</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[80]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[335]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-1.0824, -0.9112, -0.8570,  ..., -3.0999, -3.1527, -3.1280],
         [-0.6332, -0.6457, -0.5133,  ..., -3.4383, -3.4728, -3.2709],
         [-0.8140, -0.7354, -0.5684,  ..., -3.4883, -3.4156, -3.2223],
         ...,
         [ 0.7490,  0.9061,  0.9512,  ..., -1.9941, -2.0191, -2.0809],
         [ 0.1670,  0.3340,  0.3622,  ..., -2.2074, -2.2670, -2.3240],
         [-0.7958, -0.7996, -0.8655,  ..., -2.5461, -2.6957, -2.6244]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When plants grow excessively in unwanted areas, it is necessary to remove them to maintain the aesthetics of the surroundings. What part of the plants in the picture may need to be removed in this situation? Please output segmentation mask. ASSISTANT: when plants grow excessively in unwanted areas, it is necessary to remove them to maintain the aesthetics of the surroundings. what part of the plants in the picture may need to be removed in this situation</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[97]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 853, 1280]) | end - start: 1
mask_positions_in_input_ids:  [[352]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 853, 1280])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 853, 1280])):  [tensor([[[1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         ...,
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 853, 1280])):  [tensor([[[-0.9375, -0.9375, -0.9314,  ...,  0.0341,  0.0762,  0.0762],
         [-0.9375, -0.9375, -0.9314,  ...,  0.0341,  0.0762,  0.0762],
         [-0.9166, -0.9166, -0.9110,  ..., -0.0133,  0.0268,  0.0268],
         ...,
         [-0.7948, -0.7948, -0.7959,  ..., -0.7627, -0.7501, -0.7501],
         [-1.0550, -1.0550, -1.0513,  ..., -0.8307, -0.8094, -0.8094],
         [-1.2826, -1.2826, -1.2748,  ..., -0.8901, -0.8613, -0.8613]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a television studio, various equipment is used to capture and record video footage. What in the picture could be used to stabilize and hold the camera steady during filming? Please output segmentation mask. ASSISTANT: in a television studio, various equipment is used to capture and record video footage. what in the picture could be used to stabilize and hold the camera steady during filming</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]

 57%|█████▊    | 115/200 [00:48<00:34,  2.50it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2573, 3593]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2573, 3593])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2573, 3593])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2573, 3593])):  [tensor([[[-0.0708, -0.0708, -0.0708,  ..., -0.0535, -0.0535, -0.0535],
         [-0.0708, -0.0708, -0.0708,  ..., -0.0535, -0.0535, -0.0535],
         [-0.0708, -0.0708, -0.0708,  ..., -0.0535, -0.0535, -0.0535],
         ...,
         [-1.1593, -1.1593, -1.1593,  ..., -1.3795, -1.3795, -1.3795],
         [-1.1890, -1.1890, -1.1890,  ..., -1.4419, -1.4419, -1.4419],
         [-1.1890, -1.1890, -1.1890,  ..., -1.4419, -1.4419, -1.4419]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n There are two washing machines as shown in the picture. If I need to do laundry, where in the picture would I put the clothes? Please output segmentation mask. ASSISTANT: there are two washing machines as shown in the picture. if i need to do laundry, where in the picture would i put the clothes</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[82]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3254, 2168]) | end - start: 1
mask_positions_in_input_ids:  [[337]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3254, 2168])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3254, 2168])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3254, 2168])):  [tensor([[[-1.5234, -1.5234, -1.5234,  ..., -0.8421, -0.9480, -0.9480],
         [-1.5234, -1.5234, -1.5234,  ..., -0.8421, -0.9480, -0.9480],
         [-1.5234, -1.5234, -1.5234,  ..., -0.8421, -0.9480, -0.9480],
         ...,
         [-1.0859, -1.0859, -1.0859,  ..., -1.3597, -1.3994, -1.3994],
         [-1.0859, -1.0859, -1.0859,  ..., -1.3597, -1.3994, -1.3994],
         [-1.0859, -1.0859, -1.0859,  ..., -1.3597, -1.3994, -1.3994]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Insects are often found on or near trees, where they can find shelter and food. What part of the tree in this picture could insects commonly be found on or around? Please output segmentation mask. ASSISTANT: insects are often found on or near trees, where they can find shelter and food. what part of the tree in this picture could insects commonly be found on or around</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1728, 2304]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1728, 2304])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1728, 2304])):  [tensor([[[1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.],
         ...,
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1728, 2304])):  [tensor([[[ 0.1885,  0.1885,  0.1885,  ..., -0.0957, -0.0957, -0.0957],
         [ 0.1885,  0.1885,  0.1885,  ..., -0.0957, -0.0957, -0.0957],
         [ 0.1885,  0.1885,  0.1885,  ..., -0.0957, -0.0957, -0.0957],
         ...,
         [ 0.0502,  0.0502,  0.0502,  ..., -0.5113, -0.5113, -0.5113],
         [-0.0247, -0.0247, -0.0247,  ..., -0.5247, -0.5247, -0.5247],
         [-0.0529, -0.0529, -0.0529,  ..., -0.5298, -0.5298, -0.5298]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n If the person in the picture is the owner of the blue car and wants to drive it, which car door is least likely to be the one he enters based on the picture shown? Please output segmentation mask. ASSISTANT: if the person in the picture is the owner of the blue car and wants to drive it, which car door is least likely to be the one he enters based on the picture shown</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1536, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1536, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[-2.7812, -2.7812, -2.7812,  ..., -2.1719, -2.1719, -2.1719],
         [-2.7812, -2.7812, -2.7812,  ..., -2.1719, -2.1719, -2.1719],
         [-2.7812, -2.7812, -2.7812,  ..., -2.1719, -2.1719, -2.1719],
         ...,
         [-0.6366, -0.6366, -0.6366,  ..., -0.5365, -0.5365, -0.5365],
         [-1.0050, -1.0050, -1.0050,  ..., -0.9251, -0.9251, -0.9251],
         [-1.1892, -1.1892, -1.1892,  ..., -1.1194, -1.1194, -1.1194]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the keys on a piano used to play notes of half-steps or semitones in this image? Please output segmentation mask. ASSISTANT: the keys on a piano used to play notes of half-steps or semitones</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[74]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1941, 2919]) | end - start: 1
mask_positions_in_input_ids:  [[329]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1941, 2919])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1941, 2919])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 1., 1.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1941, 2919])):  [tensor([[[-2.7031, -2.7031, -2.7031,  ..., -0.9453, -0.9453, -0.9453],
         [-2.7031, -2.7031, -2.7031,  ..., -0.9453, -0.9453, -0.9453],
         [-2.7031, -2.7031, -2.7031,  ..., -0.9453, -0.9453, -0.9453],
         ...,
         [-2.3494, -2.3494, -2.3494,  ..., -1.4845, -1.4845, -1.4845],
         [-2.4214, -2.4214, -2.4214,  ..., -1.5516, -1.5516, -1.5516],
         [-2.4268, -2.4268, -2.4268,  ..., -1.5566, -1.5566, -1.5566]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n The general steps for brewing tea are to put tea leaves into a teacup and then pour hot water over them. What container in the picture is most likely to be used next for pouring hot water to make tea? Please output segmentation mask. ASSISTANT: the general steps for brewing tea are to put tea leaves into a teacup and then pour hot water over them. what container in the picture is most likely to be used next for pouring hot water to make tea</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[97]]

 60%|██████    | 120/200 [00:50<00:28,  2.80it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3056, 4592]) | end - start: 1
mask_positions_in_input_ids:  [[352]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3056, 4592])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3056, 4592])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3056, 4592])):  [tensor([[[-0.8008, -0.8008, -0.8008,  ..., -0.6133, -0.6133, -0.6133],
         [-0.8008, -0.8008, -0.8008,  ..., -0.6133, -0.6133, -0.6133],
         [-0.8008, -0.8008, -0.8008,  ..., -0.6133, -0.6133, -0.6133],
         ...,
         [-0.8468, -0.8468, -0.8468,  ..., -1.5193, -1.5193, -1.5193],
         [-0.9258, -0.9258, -0.9258,  ..., -1.5679, -1.5679, -1.5679],
         [-0.9258, -0.9258, -0.9258,  ..., -1.5679, -1.5679, -1.5679]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that is noticeably different from the other plants in the picture in this image? Please output segmentation mask. ASSISTANT: something that is noticeably different from the other plants in the picture</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3456, 5184]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 5184])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3456, 5184])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3456, 5184])):  [tensor([[[-1.3281, -1.3281, -1.3281,  ..., -0.5781, -0.5781, -0.5781],
         [-1.3281, -1.3281, -1.3281,  ..., -0.5781, -0.5781, -0.5781],
         [-1.3281, -1.3281, -1.3281,  ..., -0.5781, -0.5781, -0.5781],
         ...,
         [-0.9863, -0.9863, -0.9863,  ..., -0.4495, -0.4495, -0.4495],
         [-0.9863, -0.9863, -0.9863,  ..., -0.4495, -0.4495, -0.4495],
         [-0.9863, -0.9863, -0.9863,  ..., -0.4495, -0.4495, -0.4495]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When the weather is very cold outside, what equipment do we need to use to increase the indoor temperature in the room? Please output segmentation mask. ASSISTANT: when the weather is very cold outside, what equipment do we need to use to increase the indoor temperature in the room</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[76]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[331]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-4.1735, -3.5844, -3.7029,  ..., -2.6583, -2.7692, -3.1835],
         [-3.9926, -3.4995, -3.2625,  ..., -2.3414, -2.6242, -3.3708],
         [-5.0790, -3.8383, -2.9844,  ..., -1.7051, -2.3938, -3.4035],
         ...,
         [-4.6987, -3.5977, -2.8477,  ...,  0.4753, -0.5434, -1.7246],
         [-4.0422, -3.0120, -2.5008,  ...,  0.0904, -0.6875, -1.5983],
         [-3.6548, -3.2101, -3.0103,  ..., -1.4480, -1.9253, -2.4772]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n If we wanted to identify the specific vehicle shown in the picture, what part of the car should we look at? Please output segmentation mask. ASSISTANT: if we wanted to identify the specific vehicle shown in the picture, what part of the car should we look at</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[74]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 800, 1200]) | end - start: 1
mask_positions_in_input_ids:  [[329]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 800, 1200])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 800, 1200])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 800, 1200])):  [tensor([[[-1.9375, -1.9375, -1.9053,  ..., -1.9084, -1.9375, -1.9375],
         [-1.9375, -1.9375, -1.9053,  ..., -1.9084, -1.9375, -1.9375],
         [-1.8923, -1.8923, -1.8637,  ..., -1.8779, -1.9059, -1.9059],
         ...,
         [-0.7057, -0.7057, -0.6752,  ..., -0.3687, -0.3722, -0.3722],
         [-1.0742, -1.0742, -1.0405,  ..., -0.6105, -0.6085, -0.6085],
         [-1.4111, -1.4111, -1.3836,  ..., -0.8492, -0.8452, -0.8452]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something hot and light in this image? Please output segmentation mask. ASSISTANT: something hot and light</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[61]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 616, 816]) | end - start: 1
mask_positions_in_input_ids:  [[316]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 616, 816])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 616, 816])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 616, 816])):  [tensor([[[-2.2188, -2.1893, -2.0433,  ..., -1.6802, -1.5823, -1.5625],
         [-2.2232, -2.1950, -2.0553,  ..., -1.7071, -1.6048, -1.5842],
         [-2.2454, -2.2234, -2.1148,  ..., -1.8400, -1.7163, -1.6913],
         ...,
         [-0.7069, -0.7228, -0.8017,  ..., -1.2494, -1.1422, -1.1205],
         [-0.9975, -1.0113, -1.0799,  ..., -1.5452, -1.4492, -1.4298],
         [-1.3455, -1.3592, -1.4268,  ..., -1.9414, -1.8808, -1.8686]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is objects that can help women appear taller in this image? Please output segmentation mask. ASSISTANT: objects that can help women appear taller</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]

 62%|██████▎   | 125/200 [00:52<00:24,  3.02it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 465, 500]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 465, 500])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 465, 500])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 465, 500])):  [tensor([[[-4.6875, -5.1565, -6.0525,  ..., -0.5203, -0.5993, -0.6406],
         [-4.7544, -5.2885, -6.3087,  ...,  1.1808,  0.9216,  0.7859],
         [-4.8824, -5.5407, -6.7985,  ...,  4.4326,  3.8290,  3.5130],
         ...,
         [-4.1912, -3.9760, -3.5649,  ..., -1.8459, -1.9596, -2.0192],
         [-4.1272, -3.9763, -3.6881,  ..., -2.5035, -2.5005, -2.4990],
         [-5.3065, -5.1811, -4.9415,  ..., -3.5456, -3.5441, -3.5433]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What container in the picture is used for arranging the flowers to make them look more beautiful? Please output segmentation mask. ASSISTANT: what container in the picture is used for arranging the flowers to make them look more beautiful</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-2.7671, -2.4914, -2.4307,  ..., -2.7966, -2.8254, -2.8392],
         [-2.2658, -2.1895, -2.0574,  ..., -2.3508, -2.4161, -2.5998],
         [-2.1595, -1.9098, -1.6387,  ..., -2.0371, -2.1953, -2.4102],
         ...,
         [-1.6682, -1.6789, -1.5488,  ..., -1.6973, -2.0492, -2.1083],
         [-1.8435, -1.7844, -1.7625,  ..., -1.8098, -2.0469, -2.1328],
         [-2.5271, -2.5267, -2.5431,  ..., -2.5619, -2.6713, -2.7041]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the places where the driver can observe the speed in this image? Please output segmentation mask. ASSISTANT: the places where the driver can observe the speed</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 944, 1417]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 944, 1417])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 944, 1417])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 944, 1417])):  [tensor([[[-5.6250, -5.6250, -5.6202,  ..., -1.4329, -1.3984, -1.3984],
         [-5.6250, -5.6250, -5.6202,  ..., -1.4329, -1.3984, -1.3984],
         [-5.6513, -5.6513, -5.6463,  ..., -1.4719, -1.4382, -1.4382],
         ...,
         [-4.6301, -4.6301, -4.6154,  ..., -2.1718, -2.1613, -2.1613],
         [-4.7656, -4.7656, -4.7553,  ..., -2.2584, -2.2530, -2.2530],
         [-4.8750, -4.8750, -4.8683,  ..., -2.3283, -2.3271, -2.3271]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something indicating that someone is celerating the birthday in this image? Please output segmentation mask. ASSISTANT: something indicating that someone is celerating the birthday</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 651, 383]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 651, 383])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 651, 383])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 651, 383])):  [tensor([[[-5.1562, -4.9569, -4.2593,  ..., -2.0630, -2.2731, -2.5494],
         [-5.0992, -4.9295, -4.3359,  ..., -2.2246, -2.4132, -2.6565],
         [-4.8996, -4.8338, -4.6035,  ..., -2.7896, -2.9031, -3.0311],
         ...,
         [-3.5276, -3.4498, -3.1775,  ..., -3.8210, -3.8348, -3.8979],
         [-3.4454, -3.3512, -3.0217,  ..., -3.2711, -3.4656, -3.7709],
         [-3.4219, -3.3230, -2.9772,  ..., -3.1139, -3.3601, -3.7346]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that we use to control computer games in this image? Please output segmentation mask. ASSISTANT: something that we use to control computer games</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-0.6914, -0.6764, -0.6059,  ..., -0.9410, -0.8511, -0.8320],
         [-0.6446, -0.6295, -0.5582,  ..., -0.9487, -0.8617, -0.8433],
         [-0.4239, -0.4081, -0.3335,  ..., -0.9847, -0.9119, -0.8965],
         ...,
         [-1.0531, -1.0520, -1.0467,  ..., -1.1333, -1.0904, -1.0812],
         [-1.1283, -1.1249, -1.1088,  ..., -1.2462, -1.2082, -1.2001],
         [-1.3786, -1.3748, -1.3567,  ..., -1.6978, -1.6379, -1.6252]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When serving wine, it is common to pour it into a glass from a container. What object in the picture could be used to pour wine? Please output segmentation mask. ASSISTANT: when serving wine, it is common to pour it into a glass from a container. what object in the picture could be used to pour wine</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[80]]

 65%|██████▌   | 130/200 [00:54<00:24,  2.86it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 370, 658]) | end - start: 1
mask_positions_in_input_ids:  [[335]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 370, 658])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 370, 658])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 370, 658])):  [tensor([[[-0.8633, -0.8437, -0.7747,  ..., -0.6742, -0.7059, -0.7148],
         [-0.7949, -0.7781, -0.7189,  ..., -0.6682, -0.6934, -0.7006],
         [-0.5534, -0.5465, -0.5221,  ..., -0.6471, -0.6495, -0.6502],
         ...,
         [-0.0305, -0.0279, -0.0190,  ..., -0.2738, -0.2731, -0.2729],
         [-0.3639, -0.3617, -0.3540,  ..., -0.5769, -0.5787, -0.5792],
         [-1.6881, -1.7090, -1.7829,  ..., -2.1482, -2.1004, -2.0869]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the container that contains the vegetable in this image? Please output segmentation mask. ASSISTANT: the container that contains the vegetable</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1568, 2352]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1568, 2352])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1568, 2352])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1568, 2352])):  [tensor([[[-0.7695, -0.7695, -0.7695,  ...,  0.5430,  0.5430,  0.5430],
         [-0.7695, -0.7695, -0.7695,  ...,  0.5430,  0.5430,  0.5430],
         [-0.7695, -0.7695, -0.7695,  ...,  0.5430,  0.5430,  0.5430],
         ...,
         [-1.0973, -1.0973, -1.0973,  ...,  0.3503,  0.3503,  0.3503],
         [-1.1647, -1.1647, -1.1647,  ...,  0.1869,  0.1869,  0.1869],
         [-1.1885, -1.1885, -1.1885,  ...,  0.1294,  0.1294,  0.1294]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In the animal kingdom, the males of certain species have a distinctive feature that sets them apart from the females. What part of the lion in this picture is a defining characteristic of male lions? Please output segmentation mask. ASSISTANT: in the animal kingdom, the males of certain species have a distinctive feature that sets them apart from the females. what part of the lion in this picture is a defining characteristic of male lions</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[92]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 533, 800]) | end - start: 1
mask_positions_in_input_ids:  [[347]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[-1.9609, -1.9454, -1.8719,  ..., -2.5781, -2.5395, -2.5312],
         [-1.9527, -1.9384, -1.8706,  ..., -2.5790, -2.5450, -2.5378],
         [-1.9141, -1.9054, -1.8644,  ..., -2.5833, -2.5713, -2.5687],
         ...,
         [ 0.4180,  0.4345,  0.5122,  ..., -1.6679, -1.7343, -1.7484],
         [-0.4305, -0.4161, -0.3486,  ..., -1.7188, -1.7309, -1.7334],
         [-1.2789, -1.2667, -1.2094,  ..., -1.7698, -1.7274, -1.7184]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n During times of war, armored vehicles are commonly used to protect soldiers and engage in combat. What object in the picture can provide such protection? Please output segmentation mask. ASSISTANT: during times of war, armored vehicles are commonly used to protect soldiers and engage in combat. what object in the picture can provide such protection</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1536, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[336]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1536, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[-6.0625, -6.0625, -6.0625,  ..., -4.4062, -4.4062, -4.4062],
         [-6.0625, -6.0625, -6.0625,  ..., -4.4062, -4.4062, -4.4062],
         [-6.0625, -6.0625, -6.0625,  ..., -4.4062, -4.4062, -4.4062],
         ...,
         [-2.2461, -2.2461, -2.2461,  ..., -2.8691, -2.8691, -2.8691],
         [-2.7852, -2.7852, -2.7852,  ..., -3.3027, -3.3027, -3.3027],
         [-3.0547, -3.0547, -3.0547,  ..., -3.5195, -3.5195, -3.5195]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n It is common for some bird species to live near bodies of water and rely on them as their primary habitat. What in the picture can be considered as the habitat for the birds mentioned? Please output segmentation mask. ASSISTANT: it is common for some bird species to live near bodies of water and rely on them as their primary habitat. what in the picture can be considered as the habitat for the birds mentioned</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1193, 1271]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1193, 1271])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1193, 1271])):  [tensor([[[1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         [1., 1., 1.,  ..., 1., 1., 1.],
         ...,
         [1., 1., 1.,  ..., 1., 0., 0.],
         [1., 1., 1.,  ..., 1., 0., 0.],
         [1., 1., 1.,  ..., 1., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1193, 1271])):  [tensor([[[-4.5625, -4.5625, -4.5384,  ..., -3.6809, -3.6719, -3.6719],
         [-4.5625, -4.5625, -4.5384,  ..., -3.6809, -3.6719, -3.6719],
         [-3.8640, -3.8640, -3.8286,  ..., -2.9936, -2.9925, -2.9925],
         ...,
         [-4.3120, -4.3120, -4.2845,  ..., -2.1428, -2.2112, -2.2112],
         [-6.5005, -6.5005, -6.4932,  ..., -3.6359, -3.7000, -3.7000],
         [-8.4248, -8.4248, -8.4353,  ..., -4.9488, -5.0090, -5.0090]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In historical architecture, a building often has a grand entrance that consists of a large opening with a curved or pointed top. What feature in the picture resembles such an entrance? Please output segmentation mask. ASSISTANT: in historical architecture, a building often has a grand entrance that consists of a large opening with a curved or pointed top. what feature in the picture resembles such an entrance</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]

 68%|██████▊   | 135/200 [00:56<00:22,  2.89it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 576]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 576])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 576])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 576])):  [tensor([[[-1.3594, -1.2773, -0.9216,  ..., -0.5143, -0.4788, -0.8412],
         [-1.3730, -1.2897, -0.9288,  ..., -0.5601, -0.5255, -0.8902],
         [-1.4323, -1.3437, -0.9598,  ..., -0.7587, -0.7282, -1.1024],
         ...,
         [-1.6667, -1.6078, -1.3529,  ..., -1.0191, -1.0195, -1.5018],
         [-1.6392, -1.5771, -1.3084,  ..., -1.0374, -1.0505, -1.5109],
         [-1.6328, -1.5701, -1.2982,  ..., -1.0417, -1.0576, -1.5130]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the people who are about to get on the vehicle in this image? Please output segmentation mask. ASSISTANT: the people who are about to get on the vehicle</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[67]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[322]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-2.8750, -2.8438, -2.6969,  ..., -2.2656, -2.1496, -2.1250],
         [-2.8537, -2.8241, -2.6847,  ..., -2.2671, -2.1539, -2.1299],
         [-2.7531, -2.7311, -2.6270,  ..., -2.2741, -2.1743, -2.1531],
         ...,
         [-1.6102, -1.5714, -1.3884,  ..., -2.0217, -1.9393, -1.9219],
         [-1.7950, -1.7603, -1.5965,  ..., -2.2150, -2.1378, -2.1214],
         [-2.3897, -2.3693, -2.2730,  ..., -2.7976, -2.7362, -2.7231]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something indicating the identity of the bus in this image? Please output segmentation mask. ASSISTANT: something indicating the identity of the bus</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2048, 1536]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2048, 1536])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2048, 1536])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2048, 1536])):  [tensor([[[-7.4062, -7.4062, -7.4062,  ..., -6.2598, -6.2871, -6.3008],
         [-7.4062, -7.4062, -7.4062,  ..., -6.2598, -6.2871, -6.3008],
         [-7.4062, -7.4062, -7.4062,  ..., -6.2598, -6.2871, -6.3008],
         ...,
         [-4.9375, -4.9375, -4.9375,  ..., -3.2236, -3.6748, -3.9004],
         [-4.9375, -4.9375, -4.9375,  ..., -3.2236, -3.6748, -3.9004],
         [-4.9375, -4.9375, -4.9375,  ..., -3.2236, -3.6748, -3.9004]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the object that can be used by the owner to lead the dog in this image? Please output segmentation mask. ASSISTANT: the object that can be used by the owner to lead the dog</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 762, 1000]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 762, 1000])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 762, 1000])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 762, 1000])):  [tensor([[[-2.3750, -2.3770, -2.4362,  ..., -0.4588, -0.6234, -0.6289],
         [-2.3422, -2.3441, -2.4026,  ..., -0.4565, -0.6219, -0.6273],
         [-1.3399, -1.3410, -1.3748,  ..., -0.3846, -0.5735, -0.5798],
         ...,
         [-2.4270, -2.4241, -2.3377,  ..., -1.4460, -1.4772, -1.4783],
         [-3.5397, -3.5375, -3.4703,  ..., -3.3625, -3.3771, -3.3776],
         [-4.5972, -4.5960, -4.5615,  ..., -5.2813, -5.2770, -5.2769]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the rabbit on the woman's back in this image? Please output segmentation mask. ASSISTANT: the rabbit on the woman's back</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 802, 1089]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 802, 1089])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 802, 1089])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 802, 1089])):  [tensor([[[-1.4688, -1.4688, -1.4671,  ..., -1.9039, -1.8906, -1.8906],
         [-1.4688, -1.4688, -1.4671,  ..., -1.9039, -1.8906, -1.8906],
         [-1.4696, -1.4696, -1.4693,  ..., -1.9401, -1.9305, -1.9305],
         ...,
         [-1.5998, -1.5998, -1.6152,  ..., -0.9956, -1.0119, -1.0119],
         [-1.6255, -1.6255, -1.6364,  ..., -1.1599, -1.1634, -1.1634],
         [-1.6504, -1.6504, -1.6569,  ..., -1.3190, -1.3101, -1.3101]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What musical instrument in the picture is usually played with both hands on a keyboard? Please output segmentation mask. ASSISTANT: what musical instrument in the picture is usually played with both hands on a keyboard</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[67]]

 70%|███████   | 140/200 [00:58<00:21,  2.85it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[322]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-2.4082, -2.3027, -2.3706,  ..., -1.8737, -1.9629, -1.9133],
         [-2.6250, -2.6228, -2.5586,  ..., -1.8012, -1.9392, -1.8232],
         [-2.7346, -2.7453, -2.6484,  ..., -1.7090, -1.6660, -1.6526],
         ...,
         [-2.7110, -2.7164, -2.5195,  ...,  1.3477,  1.3691,  1.1677],
         [-2.9037, -2.9359, -2.7367,  ...,  0.7368,  0.7570,  0.6979],
         [-3.2431, -3.5186, -3.4290,  ..., -1.2530, -1.2789, -1.2563]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When eating scrambled eggs for breakfast, people often add a side dish made of potatoes. What item in the picture can be used to serve the potatoes? Please output segmentation mask. ASSISTANT: when eating scrambled eggs for breakfast, people often add a side dish made of potatoes. what item in the picture can be used to serve the potatoes</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1000, 667]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1000, 667])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1000, 667])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1000, 667])):  [tensor([[[-4.0625, -4.0582, -3.9291,  ..., -5.3294, -5.4414, -5.2465],
         [-4.0621, -4.0579, -3.9292,  ..., -5.3297, -5.4409, -5.2462],
         [-4.0516, -4.0477, -3.9325,  ..., -5.3390, -5.4274, -5.2353],
         ...,
         [-3.3906, -3.3872, -3.2854,  ..., -2.8192, -2.8681, -3.1780],
         [-3.3906, -3.3873, -3.2877,  ..., -2.7276, -2.7950, -3.1023],
         [-3.3906, -3.3873, -3.2878,  ..., -2.7245, -2.7925, -3.0998]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that can control the fan speed in this image? Please output segmentation mask. ASSISTANT: something that can control the fan speed</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2304, 3456]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2304, 3456])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2304, 3456])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2304, 3456])):  [tensor([[[-0.9844, -0.9844, -0.9844,  ..., -0.6211, -0.6211, -0.6211],
         [-0.9844, -0.9844, -0.9844,  ..., -0.6211, -0.6211, -0.6211],
         [-0.9844, -0.9844, -0.9844,  ..., -0.6211, -0.6211, -0.6211],
         ...,
         [-0.7156, -0.7156, -0.7156,  ..., -0.5390, -0.5390, -0.5390],
         [-0.7866, -0.7866, -0.7866,  ..., -0.5571, -0.5571, -0.5571],
         [-0.7866, -0.7866, -0.7866,  ..., -0.5571, -0.5571, -0.5571]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What structure separates two areas in the room and is commonly used to hold onto for support when going up and down? Please output segmentation mask. ASSISTANT: what structure separates two areas in the room and is commonly used to hold onto for support when going up and down</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[75]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[330]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[255.,   1.,   1.,  ...,   0.,   0.,   0.],
         [255.,   1.,   1.,  ...,   0.,   0.,   0.],
         [255., 255.,   1.,  ...,   0.,   0.,   0.],
         ...,
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-1.7573, -1.4509, -1.5525,  ..., -1.8292, -1.9212, -1.4004],
         [-1.6120, -1.5862, -1.6492,  ..., -1.6762, -1.6252, -1.4109],
         [-1.6508, -1.5676, -1.6094,  ..., -1.5859, -1.5711, -1.2864],
         ...,
         [-1.1523, -0.9348, -0.9268,  ..., -2.1836, -2.1977, -1.9345],
         [-1.1981, -0.9636, -0.9371,  ..., -2.2492, -2.3184, -1.9274],
         [-1.3939, -1.0952, -1.2144,  ..., -2.6065, -2.5763, -2.3974]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In urban areas, there are designated areas for bicycles to ride safely. What area in the picture would a cyclist use to navigate through the city? Please output segmentation mask. ASSISTANT: in urban areas, there are designated areas for bicycles to ride safely. what area in the picture would a cyclist use to navigate through the city</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[83]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2304, 3072]) | end - start: 1
mask_positions_in_input_ids:  [[338]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2304, 3072])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2304, 3072])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2304, 3072])):  [tensor([[[-2.1250, -2.1250, -2.1250,  ..., -2.5312, -2.5312, -2.5312],
         [-2.1250, -2.1250, -2.1250,  ..., -2.5312, -2.5312, -2.5312],
         [-2.1250, -2.1250, -2.1250,  ..., -2.5312, -2.5312, -2.5312],
         ...,
         [-1.3076, -1.3076, -1.3076,  ..., -1.4400, -1.4400, -1.4400],
         [-1.5361, -1.5361, -1.5361,  ..., -1.6382, -1.6382, -1.6382],
         [-1.5361, -1.5361, -1.5361,  ..., -1.6382, -1.6382, -1.6382]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a mechanical workshop, there are various machines and tools used for different purposes. What in the picture could be used to rotate or spin other parts or objects? Please output segmentation mask. ASSISTANT: in a mechanical workshop, there are various machines and tools used for different purposes. what in the picture could be used to rotate or spin other parts or objects</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[84]]

 72%|███████▎  | 145/200 [01:00<00:20,  2.73it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1606, 1610]) | end - start: 1
mask_positions_in_input_ids:  [[339]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1606, 1610])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1606, 1610])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1606, 1610])):  [tensor([[[-6.5625, -6.5625, -6.5597,  ..., -6.9020, -6.9062, -6.9062],
         [-6.5625, -6.5625, -6.5597,  ..., -6.9020, -6.9062, -6.9062],
         [-6.5625, -6.5625, -6.5599,  ..., -6.9171, -6.9213, -6.9213],
         ...,
         [-5.2115, -5.2115, -5.2317,  ..., -6.1729, -6.1674, -6.1674],
         [-5.1519, -5.1519, -5.1723,  ..., -6.0924, -6.0879, -6.0879],
         [-5.1094, -5.1094, -5.1300,  ..., -6.0350, -6.0312, -6.0312]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the boxes inside the refrigerator in this image? Please output segmentation mask. ASSISTANT: the boxes inside the refrigerator</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2048, 1536]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2048, 1536])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2048, 1536])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2048, 1536])):  [tensor([[[-4.0000, -4.0000, -4.0000,  ..., -3.4062, -3.6562, -3.7812],
         [-4.0000, -4.0000, -4.0000,  ..., -3.4062, -3.6562, -3.7812],
         [-4.0000, -4.0000, -4.0000,  ..., -3.4062, -3.6562, -3.7812],
         ...,
         [-4.8750, -4.8750, -4.8750,  ..., -4.7676, -4.8418, -4.8789],
         [-4.8750, -4.8750, -4.8750,  ..., -4.7676, -4.8418, -4.8789],
         [-4.8750, -4.8750, -4.8750,  ..., -4.7676, -4.8418, -4.8789]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the stronger Mario in this image? Please output segmentation mask. ASSISTANT: the stronger mario</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[60]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2448, 3264]) | end - start: 1
mask_positions_in_input_ids:  [[315]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2448, 3264])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2448, 3264])):  [tensor([[[-1.2109, -1.2109, -1.2109,  ..., -1.2734, -1.2734, -1.2734],
         [-1.2109, -1.2109, -1.2109,  ..., -1.2734, -1.2734, -1.2734],
         [-1.2109, -1.2109, -1.2109,  ..., -1.2734, -1.2734, -1.2734],
         ...,
         [-1.7884, -1.7884, -1.7884,  ..., -1.3828, -1.3828, -1.3828],
         [-1.8467, -1.8467, -1.8467,  ..., -1.5591, -1.5591, -1.5591],
         [-1.8467, -1.8467, -1.8467,  ..., -1.5591, -1.5591, -1.5591]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is where to wash hands in this image? Please output segmentation mask. ASSISTANT: where to wash hands</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[62]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 5953, 4793]) | end - start: 1
mask_positions_in_input_ids:  [[317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 5953, 4793])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 5953, 4793])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 5953, 4793])):  [tensor([[[-1.6328, -1.6328, -1.6328,  ..., -1.2314, -1.2314, -1.2314],
         [-1.6328, -1.6328, -1.6328,  ..., -1.2314, -1.2314, -1.2314],
         [-1.6328, -1.6328, -1.6328,  ..., -1.2314, -1.2314, -1.2314],
         ...,
         [-1.8984, -1.8984, -1.8984,  ..., -1.6963, -1.6963, -1.6963],
         [-1.8984, -1.8984, -1.8984,  ..., -1.6963, -1.6963, -1.6963],
         [-1.8984, -1.8984, -1.8984,  ..., -1.6963, -1.6963, -1.6963]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the food that the bird likes to eat in this image? Please output segmentation mask. ASSISTANT: the food that the bird likes to eat</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[-1.8750, -1.8750, -1.8703,  ..., -0.6827, -0.6836, -0.6836],
         [-1.8750, -1.8750, -1.8703,  ..., -0.6827, -0.6836, -0.6836],
         [-1.8707, -1.8707, -1.8661,  ..., -0.6723, -0.6732, -0.6732],
         ...,
         [-2.3906, -2.3906, -2.3956,  ..., -1.1608, -1.1577, -1.1577],
         [-2.7006, -2.7006, -2.7052,  ..., -1.8976, -1.8948, -1.8948],
         [-2.9414, -2.9414, -2.9456,  ..., -2.4625, -2.4600, -2.4600]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a large building, it is common to have designated areas for swimming. What area in the picture could be used for swimming? Please output segmentation mask. ASSISTANT: in a large building, it is common to have designated areas for swimming. what area in the picture could be used for swimming</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[79]]

 75%|███████▌  | 150/200 [01:02<00:17,  2.88it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1704, 2272]) | end - start: 1
mask_positions_in_input_ids:  [[334]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1704, 2272])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[-5.3125, -5.3125, -5.3125,  ..., -1.9844, -1.9844, -1.9844],
         [-5.3125, -5.3125, -5.3125,  ..., -1.9844, -1.9844, -1.9844],
         [-5.3125, -5.3125, -5.3125,  ..., -1.9844, -1.9844, -1.9844],
         ...,
         [-1.2645, -1.2645, -1.2645,  ..., -1.8305, -1.8305, -1.8305],
         [-1.6903, -1.6903, -1.6903,  ..., -2.2873, -2.2873, -2.2873],
         [-1.8567, -1.8567, -1.8567,  ..., -2.4658, -2.4658, -2.4658]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In order to shape and carve hard materials, such as wood or stone, what part of the tool in the picture would be used to provide precise control and force? Please output segmentation mask. ASSISTANT: in order to shape and carve hard materials, such as wood or stone, what part of the tool in the picture would be used to provide precise control and force</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[85]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 790, 916]) | end - start: 1
mask_positions_in_input_ids:  [[340]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 790, 916])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 790, 916])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 790, 916])):  [tensor([[[-3.7656, -3.7705, -3.8091,  ..., -4.2376, -4.2486, -4.2500],
         [-3.5446, -3.5484, -3.5788,  ..., -3.9584, -3.9760, -3.9782],
         [-1.7768, -1.7724, -1.7376,  ..., -1.7260, -1.7962, -1.8050],
         ...,
         [-3.5219, -3.5211, -3.5149,  ..., -2.1277, -2.2057, -2.2155],
         [-5.5133, -5.5199, -5.5725,  ..., -3.8699, -3.8546, -3.8527],
         [-7.3024, -7.3135, -7.4029,  ..., -5.2773, -5.2294, -5.2234]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In the picture, there is a legal requirement for vehicles to display identifying information. What part of the car is used to display this information? Please output segmentation mask. ASSISTANT: in the picture, there is a legal requirement for vehicles to display identifying information. what part of the car is used to display this information</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[80]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2762, 3948]) | end - start: 1
mask_positions_in_input_ids:  [[335]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2762, 3948])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2762, 3948])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2762, 3948])):  [tensor([[[-2.2969, -2.2969, -2.2969,  ..., -1.0859, -1.0859, -1.0859],
         [-2.2969, -2.2969, -2.2969,  ..., -1.0859, -1.0859, -1.0859],
         [-2.2969, -2.2969, -2.2969,  ..., -1.0859, -1.0859, -1.0859],
         ...,
         [-1.2494, -1.2494, -1.2494,  ..., -1.1021, -1.1021, -1.1021],
         [-1.3281, -1.3281, -1.3281,  ..., -1.1794, -1.1794, -1.1794],
         [-1.3281, -1.3281, -1.3281,  ..., -1.1794, -1.1794, -1.1794]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the ship that is most likely to carry a fleet commander in this image? Please output segmentation mask. ASSISTANT: the ship that is most likely to carry a fleet commander</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[68]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2448, 3264]) | end - start: 1
mask_positions_in_input_ids:  [[323]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2448, 3264])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2448, 3264])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2448, 3264])):  [tensor([[[-2.1406, -2.1406, -2.1406,  ..., -2.4375, -2.4375, -2.4375],
         [-2.1406, -2.1406, -2.1406,  ..., -2.4375, -2.4375, -2.4375],
         [-2.1406, -2.1406, -2.1406,  ..., -2.4375, -2.4375, -2.4375],
         ...,
         [-2.2869, -2.2869, -2.2869,  ..., -2.3611, -2.3611, -2.3611],
         [-2.4746, -2.4746, -2.4746,  ..., -2.6338, -2.6338, -2.6338],
         [-2.4746, -2.4746, -2.4746,  ..., -2.6338, -2.6338, -2.6338]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In outdoor recreational activities, people can experience the thrill of flying in the sky with the help of equipment. What object in the picture can provide this experience? Please output segmentation mask. ASSISTANT: in outdoor recreational activities, people can experience the thrill of flying in the sky with the help of equipment. what object in the picture can provide this experience</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[85]]

 77%|███████▋  | 154/200 [01:04<00:18,  2.47it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 533, 800]) | end - start: 1
mask_positions_in_input_ids:  [[340]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[-3.2344, -3.2196, -3.1500,  ..., -2.5844, -2.4374, -2.4062],
         [-3.2131, -3.1985, -3.1299,  ..., -2.5845, -2.4408, -2.4103],
         [-3.1126, -3.0991, -3.0353,  ..., -2.5853, -2.4569, -2.4297],
         ...,
         [-0.0714, -0.0710, -0.0693,  ..., -0.1588, -0.1747, -0.1781],
         [-0.4225, -0.4215, -0.4166,  ..., -0.6303, -0.6135, -0.6100],
         [-0.7737, -0.7719, -0.7639,  ..., -1.1018, -1.0524, -1.0419]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n We are currently watching a game and it's halftime. Who are the cheerleaders who come out to liven up the atmosphere? Please output segmentation mask. ASSISTANT: we are currently watching a game and it's halftime. who are the cheerleaders who come out to liven up the atmosphere</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 272, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[336]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 272, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 272, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 272, 1024])):  [tensor([[[-7.4062, -7.4062, -7.2891,  ..., -4.2441, -4.2812, -4.2812],
         [-7.4062, -7.4062, -7.2891,  ..., -4.2441, -4.2812, -4.2812],
         [-7.6055, -7.6055, -7.5049,  ..., -4.4070, -4.4258, -4.4258],
         ...,
         [-3.1094, -3.1094, -2.9346,  ..., -3.6404, -3.4355, -3.4355],
         [-3.6973, -3.6973, -3.5186,  ..., -3.6550, -3.4512, -3.4512],
         [-4.9980, -4.9980, -4.8682,  ..., -3.7034, -3.5098, -3.5098]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In an educational setting, children often use different materials to learn about letters, numbers, and words. What object in the picture could be used as a visual aid for learning about letters and words? Please output segmentation mask. ASSISTANT: in an educational setting, children often use different materials to learn about letters, numbers, and words. what object in the picture could be used as a visual aid for learning about letters and words</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[90]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1274, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[345]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1274, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1274, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1274, 2048])):  [tensor([[[-0.9336, -0.9336, -0.9336,  ..., -0.8477, -0.8477, -0.8477],
         [-0.9336, -0.9336, -0.9336,  ..., -0.8477, -0.8477, -0.8477],
         [-0.9336, -0.9336, -0.9336,  ..., -0.8477, -0.8477, -0.8477],
         ...,
         [-2.9038, -2.9038, -2.9038,  ..., -2.0664, -2.0664, -2.0664],
         [-3.2446, -3.2446, -3.2446,  ..., -2.3398, -2.3398, -2.3398],
         [-3.4150, -3.4150, -3.4150,  ..., -2.4766, -2.4766, -2.4766]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is a car with a color that is closer to lipstick color in this image? Please output segmentation mask. ASSISTANT: a car with a color that is closer to lipstick color</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 1600])):  [tensor([[[-1.9141, -1.9141, -1.9111,  ..., -0.7296, -0.7148, -0.7148],
         [-1.9141, -1.9141, -1.9111,  ..., -0.7296, -0.7148, -0.7148],
         [-1.9138, -1.9138, -1.9108,  ..., -0.7295, -0.7149, -0.7149],
         ...,
         [-0.3489, -0.3489, -0.3485,  ..., -0.7229, -0.7244, -0.7244],
         [-0.6669, -0.6669, -0.6656,  ..., -1.0171, -1.0170, -1.0170],
         [-0.9202, -0.9202, -0.9181,  ..., -1.2368, -1.2354, -1.2354]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n If you want to play table tennis indoors, what furniture in the picture should be used as the playing surface? Please output segmentation mask. ASSISTANT: if you want to play table tennis indoors, what furniture in the picture should be used as the playing surface</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[76]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[331]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         ...,
         [  0.,   0.,   0.,  ..., 255., 255., 255.],
         [  0.,   0.,   0.,  ..., 255., 255., 255.],
         [  0.,   0.,   0.,  ..., 255., 255., 255.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-0.2327, -0.2157, -0.1536,  ..., -0.2860, -0.2794, -0.1701],
         [-0.1586, -0.1670, -0.1286,  ..., -0.1717, -0.2083, -0.0685],
         [-0.0341, -0.1215, -0.0734,  ..., -0.1399, -0.1542,  0.0196],
         ...,
         [-0.5188, -0.5832, -0.6055,  ..., -1.1475, -1.2465, -1.1847],
         [-0.6319, -0.6437, -0.7047,  ..., -1.2574, -1.3923, -1.3101],
         [-1.1464, -1.1783, -1.2738,  ..., -1.4297, -1.5161, -1.4533]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a military airfield, what area is specifically designed for aircraft to take off and land? Please output segmentation mask. ASSISTANT: in a military airfield, what area is specifically designed for aircraft to take off and land</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[70]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2848, 4288]) | end - start: 1
mask_positions_in_input_ids:  [[325]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2848, 4288])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2848, 4288])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2848, 4288])):  [tensor([[[-2.9219, -2.9219, -2.9219,  ..., -0.8984, -0.8984, -0.8984],
         [-2.9219, -2.9219, -2.9219,  ..., -0.8984, -0.8984, -0.8984],
         [-2.9219, -2.9219, -2.9219,  ..., -0.8984, -0.8984, -0.8984],
         ...,
         [-1.0765, -1.0765, -1.0765,  ..., -1.1210, -1.1210, -1.1210],
         [-1.1267, -1.1267, -1.1267,  ..., -1.1660, -1.1660, -1.1660],
         [-1.1267, -1.1267, -1.1267,  ..., -1.1660, -1.1660, -1.1660]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Generally speaking, dogs do not have horns on their heads, only a pair of ears. What part of the dog's head in this picture looks strange? Please output segmentation mask. ASSISTANT: generally speaking, dogs do not have horns on their heads, only a pair of ears. what part of the dog's head in this picture looks strange</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[85]]

 80%|███████▉  | 159/200 [01:06<00:16,  2.50it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1533, 1039]) | end - start: 1
mask_positions_in_input_ids:  [[340]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1533, 1039])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1533, 1039])):  [tensor([[[  0.,   0.,   0.,  ..., 255., 255.,   0.],
         [  0.,   0.,   0.,  ..., 255., 255.,   0.],
         [  0.,   0.,   0.,  ..., 255.,   0.,   0.],
         ...,
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1533, 1039])):  [tensor([[[-0.8398, -0.8398, -0.8184,  ..., -0.4102, -0.3985, -0.3896],
         [-0.8398, -0.8398, -0.8184,  ..., -0.4102, -0.3985, -0.3896],
         [-0.8328, -0.8328, -0.8123,  ..., -0.4175, -0.4070, -0.3991],
         ...,
         [-0.6428, -0.6428, -0.6493,  ..., -0.6863, -0.7550, -0.8066],
         [-0.6328, -0.6328, -0.6395,  ..., -0.6849, -0.7547, -0.8071],
         [-0.6328, -0.6328, -0.6395,  ..., -0.6849, -0.7547, -0.8071]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In an organized workspace, one might have a designated area to store important documents and files. What piece of furniture in the picture could be used for this purpose? Please output segmentation mask. ASSISTANT: in an organized workspace, one might have a designated area to store important documents and files. what piece of furniture in the picture could be used for this purpose</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[85]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 750, 1000]) | end - start: 1
mask_positions_in_input_ids:  [[340]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 750, 1000])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 750, 1000])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 750, 1000])):  [tensor([[[-0.2246, -0.2235, -0.1889,  ...,  0.6114,  0.7077,  0.7109],
         [-0.2240, -0.2228, -0.1885,  ...,  0.6087,  0.7048,  0.7079],
         [-0.2046, -0.2037, -0.1764,  ...,  0.5276,  0.6148,  0.6177],
         ...,
         [-0.3272, -0.3260, -0.2894,  ...,  0.4326,  0.4158,  0.4152],
         [-0.5701, -0.5692, -0.5394,  ...,  0.0677,  0.0540,  0.0536],
         [-1.0287, -1.0277, -0.9967,  ..., -0.5060, -0.4897, -0.4892]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that ensures the person to land safely in this image? Please output segmentation mask. ASSISTANT: something that ensures the person to land safely</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1920, 2560]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1920, 2560])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1920, 2560])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1920, 2560])):  [tensor([[[-3.0781, -3.0781, -3.0781,  ..., -3.9844, -3.9844, -3.9844],
         [-3.0781, -3.0781, -3.0781,  ..., -3.9844, -3.9844, -3.9844],
         [-3.0781, -3.0781, -3.0781,  ..., -3.9844, -3.9844, -3.9844],
         ...,
         [-4.0039, -4.0039, -4.0039,  ..., -5.4609, -5.4609, -5.4609],
         [-4.8618, -4.8618, -4.8618,  ..., -6.8329, -6.8329, -6.8329],
         [-5.0762, -5.0762, -5.0762,  ..., -7.1758, -7.1758, -7.1758]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n A bride and groom often walk together down the aisle during a wedding ceremony. What object in the picture is the bride most likely holding during this moment? Please output segmentation mask. ASSISTANT: a bride and groom often walk together down the aisle during a wedding ceremony. what object in the picture is the bride most likely holding during this moment</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]

 82%|████████▏ | 163/200 [01:08<00:17,  2.16it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1200, 900]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1200, 900])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1200, 900])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1200, 900])):  [tensor([[[-3.4062, -3.4062, -3.2974,  ..., -0.9483, -1.1629, -1.5552],
         [-3.4062, -3.4062, -3.2974,  ..., -0.9483, -1.1629, -1.5552],
         [-3.4248, -3.4248, -3.3236,  ..., -1.0174, -1.2379, -1.6326],
         ...,
         [-3.1387, -3.1387, -3.0947,  ..., -2.3576, -2.7080, -3.2007],
         [-3.0781, -3.0781, -3.0150,  ..., -2.3566, -2.7128, -3.1973],
         [-3.0781, -3.0781, -3.0150,  ..., -2.3566, -2.7128, -3.1973]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Some dishes are baked in the oven to enhance their flavors. What object in the picture is commonly used to place the dishes in the oven for baking? Please output segmentation mask. ASSISTANT: some dishes are baked in the oven to enhance their flavors. what object in the picture is commonly used to place the dishes in the oven for baking</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[89]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 900, 1200]) | end - start: 1
mask_positions_in_input_ids:  [[344]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 900, 1200])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 900, 1200])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 900, 1200])):  [tensor([[[-0.9102, -0.9102, -0.9507,  ..., -0.6018, -0.6211, -0.6211],
         [-0.9102, -0.9102, -0.9507,  ..., -0.6018, -0.6211, -0.6211],
         [-0.8061, -0.8061, -0.8438,  ..., -0.4762, -0.4946, -0.4946],
         ...,
         [-2.6443, -2.6443, -2.6430,  ..., -1.6845, -1.6905, -1.6905],
         [-2.9850, -2.9850, -2.9930,  ..., -2.2666, -2.2752, -2.2752],
         [-3.3750, -3.3750, -3.3970,  ..., -2.9931, -3.0049, -3.0049]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the object that might reflect this person's marital status in this image? Please output segmentation mask. ASSISTANT: the object that might reflect this person's marital status</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[69]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1066, 1600]) | end - start: 1
mask_positions_in_input_ids:  [[324]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1066, 1600])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1066, 1600])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1066, 1600])):  [tensor([[[-3.8125, -3.8125, -3.8143,  ..., -1.0273, -1.0312, -1.0312],
         [-3.8125, -3.8125, -3.8143,  ..., -1.0273, -1.0312, -1.0312],
         [-3.8146, -3.8146, -3.8166,  ..., -1.0082, -1.0122, -1.0122],
         ...,
         [-5.9187, -5.9187, -5.9246,  ..., -1.9074, -1.9052, -1.9052],
         [-5.9137, -5.9137, -5.9193,  ..., -2.5352, -2.5306, -2.5306],
         [-5.9102, -5.9102, -5.9155,  ..., -2.9863, -2.9800, -2.9800]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is knobs without screws in the center in this image? Please output segmentation mask. ASSISTANT: knobs without screws in the center</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2,
         2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[66]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 615, 461]) | end - start: 1
mask_positions_in_input_ids:  [[321]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 615, 461])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 615, 461])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 615, 461])):  [tensor([[[-2.1562, -1.0403,  2.6809,  ...,  2.9940,  1.2578, -1.1548],
         [-2.1446, -0.9974,  2.8275,  ...,  3.0678,  1.3172, -1.1453],
         [-2.1056, -0.8546,  3.3168,  ...,  3.3138,  1.5151, -1.1139],
         ...,
         [-3.0000, -1.8554,  1.9611,  ...,  2.8476,  0.1138, -2.8762],
         [-3.0000, -1.9285,  1.6445,  ...,  1.7859, -0.5370, -3.0906],
         [-3.0000, -1.9504,  1.5496,  ...,  1.4677, -0.7320, -3.1549]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is where the garbage should be put in this image? Please output segmentation mask. ASSISTANT: where the garbage should be put</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]

 84%|████████▍ | 168/200 [01:10<00:12,  2.57it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1944, 2592]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1944, 2592])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1944, 2592])):  [tensor([[[-2.1562, -2.1562, -2.1562,  ..., -0.1797, -0.1797, -0.1797],
         [-2.1562, -2.1562, -2.1562,  ..., -0.1797, -0.1797, -0.1797],
         [-2.1562, -2.1562, -2.1562,  ..., -0.1797, -0.1797, -0.1797],
         ...,
         [-3.2013, -3.2013, -3.2013,  ..., -3.0864, -3.0864, -3.0864],
         [-3.5177, -3.5177, -3.5177,  ..., -3.3519, -3.3519, -3.3519],
         [-3.5918, -3.5918, -3.5918,  ..., -3.4141, -3.4141, -3.4141]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Dogs are faithful companions to humans, and humans often play fetch games with them. What object will the dog likely retrieve and bring back to the human for the next round of fetch in the picture? Please output segmentation mask. ASSISTANT: dogs are faithful companions to humans, and humans often play fetch games with them. what object will the dog likely retrieve and bring back to the human for the next round of fetch in the picture</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[92]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1816, 3003]) | end - start: 1
mask_positions_in_input_ids:  [[347]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1816, 3003])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1816, 3003])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1816, 3003])):  [tensor([[[-1.9453, -1.9453, -1.9453,  ..., -1.3672, -1.3672, -1.3672],
         [-1.9453, -1.9453, -1.9453,  ..., -1.3672, -1.3672, -1.3672],
         [-1.9453, -1.9453, -1.9453,  ..., -1.3672, -1.3672, -1.3672],
         ...,
         [-1.8681, -1.8681, -1.8681,  ..., -1.3471, -1.3471, -1.3471],
         [-1.9816, -1.9816, -1.9816,  ..., -1.3741, -1.3741, -1.3741],
         [-1.9854, -1.9854, -1.9854,  ..., -1.3750, -1.3750, -1.3750]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n People often add gas to water to improve its taste. What part of the picture will be consumed as a beverage? Please output segmentation mask. ASSISTANT: people often add gas to water to improve its taste. what part of the picture will be consumed as a beverage</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[76]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2331, 1749]) | end - start: 1
mask_positions_in_input_ids:  [[331]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2331, 1749])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2331, 1749])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2331, 1749])):  [tensor([[[-2.2344, -2.2344, -2.2344,  ..., -0.5936, -0.9303, -1.0519],
         [-2.2344, -2.2344, -2.2344,  ..., -0.5936, -0.9303, -1.0519],
         [-2.2344, -2.2344, -2.2344,  ..., -0.5936, -0.9303, -1.0519],
         ...,
         [-2.9844, -2.9844, -2.9844,  ..., -2.5641, -2.7322, -2.7930],
         [-2.9844, -2.9844, -2.9844,  ..., -2.5641, -2.7322, -2.7930],
         [-2.9844, -2.9844, -2.9844,  ..., -2.5641, -2.7322, -2.7930]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When people want to take their pets to the park and enjoy some outdoor activities, they often want to make sure their pets are safe and cannot run away. What in the picture could help with this? Please output segmentation mask. ASSISTANT: when people want to take their pets to the park and enjoy some outdoor activities, they often want to make sure their pets are safe and cannot run away. what in the picture could help with this</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[94]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2705, 3269]) | end - start: 1
mask_positions_in_input_ids:  [[349]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2705, 3269])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2705, 3269])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2705, 3269])):  [tensor([[[-0.6172, -0.6172, -0.6172,  ..., -1.1172, -1.1172, -1.1172],
         [-0.6172, -0.6172, -0.6172,  ..., -1.1172, -1.1172, -1.1172],
         [-0.6172, -0.6172, -0.6172,  ..., -1.1172, -1.1172, -1.1172],
         ...,
         [-0.7046, -0.7046, -0.7046,  ..., -0.6284, -0.6284, -0.6284],
         [-0.8235, -0.8235, -0.8235,  ..., -0.7231, -0.7231, -0.7231],
         [-0.8235, -0.8235, -0.8235,  ..., -0.7231, -0.7231, -0.7231]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n I feel my commute is too slow now and I'm hoping to find a convenient mode of transportation that can also help me exercise. Can you help me find the corresponding part in the picture? Please output segmentation mask. ASSISTANT: i feel my commute is too slow now and i'm hoping to find a convenient mode of transportation that can also help me exercise. can you help me find the corresponding part in the picture</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[92]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1189, 1656]) | end - start: 1
mask_positions_in_input_ids:  [[347]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1189, 1656])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1189, 1656])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1189, 1656])):  [tensor([[[-1.3672, -1.3672, -1.3625,  ..., -0.3834, -0.3789, -0.3789],
         [-1.3672, -1.3672, -1.3625,  ..., -0.3834, -0.3789, -0.3789],
         [-1.3608, -1.3608, -1.3561,  ..., -0.3875, -0.3830, -0.3830],
         ...,
         [-0.8409, -0.8409, -0.8392,  ..., -0.6226, -0.6225, -0.6225],
         [-1.0331, -1.0331, -1.0316,  ..., -0.8177, -0.8175, -0.8175],
         [-1.1787, -1.1787, -1.1773,  ..., -0.9573, -0.9570, -0.9570]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n If we were to have a friendly competition to see who can paddle the fastest in the water, what would be the most suitable vessels for this activity in the picture? Please output segmentation mask. ASSISTANT: if we were to have a friendly competition to see who can paddle the fastest in the water, what would be the most suitable vessels for this activity in the picture</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[86]]

 87%|████████▋ | 174/200 [01:12<00:08,  3.02it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2112, 2816]) | end - start: 1
mask_positions_in_input_ids:  [[341]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2112, 2816])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2112, 2816])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2112, 2816])):  [tensor([[[-3.5625, -3.5625, -3.5625,  ..., -3.2344, -3.2344, -3.2344],
         [-3.5625, -3.5625, -3.5625,  ..., -3.2344, -3.2344, -3.2344],
         [-3.5625, -3.5625, -3.5625,  ..., -3.2344, -3.2344, -3.2344],
         ...,
         [-2.3466, -2.3466, -2.3466,  ..., -3.0455, -3.0455, -3.0455],
         [-2.9244, -2.9244, -2.9244,  ..., -3.9149, -3.9149, -3.9149],
         [-2.9966, -2.9966, -2.9966,  ..., -4.0234, -4.0234, -4.0234]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the man who seems to lose in this image? Please output segmentation mask. ASSISTANT: the man who seems to lose</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1000, 1500]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1000, 1500])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1000, 1500])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1000, 1500])):  [tensor([[[-3.6562, -3.6562, -3.6240,  ..., -1.4662, -1.4531, -1.4531],
         [-3.6562, -3.6562, -3.6240,  ..., -1.4662, -1.4531, -1.4531],
         [-3.6615, -3.6615, -3.6302,  ..., -1.4804, -1.4673, -1.4673],
         ...,
         [-0.9598, -0.9598, -0.9630,  ..., -1.1067, -1.0976, -1.0976],
         [-1.4747, -1.4747, -1.4797,  ..., -1.2481, -1.2360, -1.2360],
         [-1.9941, -1.9941, -2.0018,  ..., -1.4242, -1.4102, -1.4102]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a dark cave, there is no natural light source. What object in the picture can be used to provide light to navigate and explore the cave? Please output segmentation mask. ASSISTANT: in a dark cave, there is no natural light source. what object in the picture can be used to provide light to navigate and explore the cave</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[81]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 480, 640]) | end - start: 1
mask_positions_in_input_ids:  [[336]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 480, 640])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 480, 640])):  [tensor([[[-3.6250, -3.5336, -3.2188,  ..., -2.8125, -2.5461, -2.4688],
         [-3.6268, -3.5433, -3.2557,  ..., -2.8424, -2.6005, -2.5303],
         [-3.6328, -3.5766, -3.3828,  ..., -2.9453, -2.7879, -2.7422],
         ...,
         [-1.4688, -1.4679, -1.4648,  ..., -2.7031, -2.6002, -2.5703],
         [-1.6216, -1.6218, -1.6227,  ..., -2.7659, -2.7071, -2.6901],
         [-2.2492, -2.2446, -2.2285,  ..., -3.5227, -3.4131, -3.3813]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the car that may need repair in this image? Please output segmentation mask. ASSISTANT: the car that may need repair</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1632, 2176]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1632, 2176])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1632, 2176])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1632, 2176])):  [tensor([[[-3.5938, -3.5938, -3.5938,  ..., -3.2969, -3.2969, -3.2969],
         [-3.5938, -3.5938, -3.5938,  ..., -3.2969, -3.2969, -3.2969],
         [-3.5938, -3.5938, -3.5938,  ..., -3.2969, -3.2969, -3.2969],
         ...,
         [-1.3482, -1.3482, -1.3482,  ..., -1.7089, -1.7089, -1.7089],
         [-2.0142, -2.0142, -2.0142,  ..., -2.6594, -2.6594, -2.6594],
         [-2.3055, -2.3055, -2.3055,  ..., -3.0753, -3.0753, -3.0753]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In ancient times, people used different methods to measure time during the day. What object in the picture could have been used as a timekeeping device based on the position of the sun? Please output segmentation mask. ASSISTANT: in ancient times, people used different methods to measure time during the day. what object in the picture could have been used as a timekeeping device based on the position of the sun</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[89]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[344]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.],
         [1., 1., 1.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-3.0312, -3.0214, -2.9750,  ..., -2.4406, -2.3091, -2.2812],
         [-3.0411, -3.0337, -2.9989,  ..., -2.4603, -2.3329, -2.3059],
         [-3.0875, -3.0917, -3.1114,  ..., -2.5531, -2.4448, -2.4219],
         ...,
         [-0.1769, -0.1714, -0.1457,  ..., -1.2416, -1.2298, -1.2273],
         [-0.6782, -0.6763, -0.6675,  ..., -1.6705, -1.6473, -1.6424],
         [-2.1052, -2.1176, -2.1758,  ..., -2.9175, -2.8904, -2.8847]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In a busy and bustling city, it is important for businesses to have eye-catching signs to attract customers. What feature in the picture can serve this purpose? Please output segmentation mask. ASSISTANT: in a busy and bustling city, it is important for businesses to have eye-catching signs to attract customers. what feature in the picture can serve this purpose</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2592, 1944]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 1944])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2592, 1944])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2592, 1944])):  [tensor([[[-2.7656, -2.7656, -2.7656,  ..., -2.0673, -2.1576, -2.1787],
         [-2.7656, -2.7656, -2.7656,  ..., -2.0673, -2.1576, -2.1787],
         [-2.7656, -2.7656, -2.7656,  ..., -2.0673, -2.1576, -2.1787],
         ...,
         [-2.0000, -2.0000, -2.0000,  ..., -2.4818, -2.5234, -2.5332],
         [-2.0000, -2.0000, -2.0000,  ..., -2.4818, -2.5234, -2.5332],
         [-2.0000, -2.0000, -2.0000,  ..., -2.4818, -2.5234, -2.5332]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When taking pictures with a camera, what part of the camera is responsible for focusing the image and adjusting the depth of field? Please output segmentation mask. ASSISTANT: when taking pictures with a camera, what part of the camera is responsible for focusing the image and adjusting the depth of field</s>"]

>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[78]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1664, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[333]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1664, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1664, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1664, 2048])):  [tensor([[[ 0.2100,  0.2100,  0.2100,  ..., -0.7500, -0.7500, -0.7500],
         [ 0.2100,  0.2100,  0.2100,  ..., -0.7500, -0.7500, -0.7500],
         [ 0.2100,  0.2100,  0.2100,  ..., -0.7500, -0.7500, -0.7500],
         ...,
         [-0.7467, -0.7467, -0.7467,  ..., -1.7029, -1.7029, -1.7029],
         [-1.2520, -1.2520, -1.2520,  ..., -2.3303, -2.3303, -2.3303],
         [-1.5047, -1.5047, -1.5047,  ..., -2.6440, -2.6440, -2.6440]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Birds often need a place to rest or observe their surroundings. What part of a tree in the picture offers a suitable spot for birds to do so? Please output segmentation mask. ASSISTANT: birds often need a place to rest or observe their surroundings. what part of a tree in the picture offers a suitable spot for birds to do so</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[84]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 612, 612]) | end - start: 1
mask_positions_in_input_ids:  [[339]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 612, 612])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 612, 612])):  [tensor([[[  0.,   0.,   0.,  ..., 255., 255., 255.],
         [  0.,   0.,   0.,  ..., 255., 255., 255.],
         [  0.,   0.,   0.,  ..., 255., 255., 255.],
         ...,
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
         [  0.,   0.,   0.,  ...,   0.,   0.,   0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 612, 612])):  [tensor([[[ 0.0302,  0.0426,  0.0835,  ..., -0.2394, -0.2378, -0.2373],
         [ 0.0569,  0.0670,  0.1002,  ..., -0.2312, -0.2245, -0.2225],
         [ 0.1448,  0.1471,  0.1548,  ..., -0.2042, -0.1810, -0.1739],
         ...,
         [-0.6431, -0.6218, -0.5517,  ..., -0.0086,  0.0394,  0.0540],
         [-0.6023, -0.5805, -0.5090,  ...,  0.0393,  0.1273,  0.1541],
         [-0.5898, -0.5679, -0.4960,  ...,  0.0539,  0.1540,  0.1846]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that we can sit on in this image? Please output segmentation mask. ASSISTANT: something that we can sit on</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 540, 720]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 540, 720])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 540, 720])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 540, 720])):  [tensor([[[-2.0938e+00, -2.0715e+00, -1.9844e+00,  ..., -1.2296e+00,
          -1.1836e+00, -1.1719e+00],
         [-2.0845e+00, -2.0644e+00, -1.9859e+00,  ..., -1.2269e+00,
          -1.1905e+00, -1.1812e+00],
         [-2.0482e+00, -2.0367e+00, -1.9920e+00,  ..., -1.2161e+00,
          -1.2172e+00, -1.2174e+00],
         ...,
         [ 2.4837e-01,  2.8867e-01,  4.4634e-01,  ...,  1.0957e+00,
           9.4718e-01,  9.0923e-01],
         [-4.2182e-01, -3.8736e-01, -2.5253e-01,  ...,  1.2895e-01,
           1.6738e-03, -3.0856e-02],
         [-1.8746e+00, -1.8738e+00, -1.8707e+00,  ..., -2.1112e+00,
          -2.1717e+00, -2.1871e+00]]], device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n To keep bread fresh and protected, it is often placed in a protective covering. What item in the picture is commonly used for this purpose? Please output segmentation mask. ASSISTANT: to keep bread fresh and protected, it is often placed in a protective covering. what item in the picture is commonly used for this purpose</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[80]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 612, 612]) | end - start: 1
mask_positions_in_input_ids:  [[335]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 612, 612])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 612, 612])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 612, 612])):  [tensor([[[1.5469, 1.6703, 2.0756,  ..., 2.8452, 2.7603, 2.7344],
         [1.6066, 1.7476, 2.2103,  ..., 3.0283, 2.9541, 2.9315],
         [1.8027, 2.0012, 2.6525,  ..., 3.6289, 3.5903, 3.5786],
         ...,
         [0.9843, 1.1688, 1.7744,  ..., 1.9211, 1.7731, 1.7280],
         [1.0742, 1.2172, 1.6868,  ..., 1.7829, 1.7033, 1.6790],
         [1.1016, 1.2320, 1.6601,  ..., 1.7408, 1.6820, 1.6641]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Sometimes, when a car is parked on the side of the road, the driver may accidentally leave the car door open. What part in the picture can indicate that the car door is open? Please output segmentation mask. ASSISTANT: sometimes, when a car is parked on the side of the road, the driver may accidentally leave the car door open. what part in the picture can indicate that the car door is open</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[91]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2592, 1936]) | end - start: 1
mask_positions_in_input_ids:  [[346]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2592, 1936])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2592, 1936])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2592, 1936])):  [tensor([[[-1.6406, -1.6406, -1.6406,  ..., -1.0485, -0.9736, -0.9561],
         [-1.6406, -1.6406, -1.6406,  ..., -1.0485, -0.9736, -0.9561],
         [-1.6406, -1.6406, -1.6406,  ..., -1.0485, -0.9736, -0.9561],
         ...,
         [-0.7852, -0.7852, -0.7852,  ..., -0.9548, -1.0088, -1.0215],
         [-0.7852, -0.7852, -0.7852,  ..., -0.9548, -1.0088, -1.0215],
         [-0.7852, -0.7852, -0.7852,  ..., -0.9548, -1.0088, -1.0215]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something that produces pollen in this image? Please output segmentation mask. ASSISTANT: something that produces pollen</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[62]]

 92%|█████████▏| 184/200 [01:16<00:05,  2.90it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 533, 800]) | end - start: 1
mask_positions_in_input_ids:  [[317]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 533, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 533, 800])):  [tensor([[[-5.6250, -5.6086, -5.5312,  ..., -4.3156, -4.0295, -3.9688],
         [-5.6496, -5.6339, -5.5602,  ..., -4.4013, -4.1228, -4.0638],
         [-5.7655, -5.7535, -5.6970,  ..., -4.8055, -4.5634, -4.5120],
         ...,
         [-4.0126, -4.0168, -4.0369,  ..., -3.8839, -3.7810, -3.7591],
         [-4.1076, -4.1095, -4.1184,  ..., -3.6659, -3.5284, -3.4992],
         [-4.2025, -4.2021, -4.1999,  ..., -3.4480, -3.2759, -3.2393]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When purchasing meat from a grocery store, it is often stored and sold in a certain type of container. What object in the picture could be used for this purpose? Please output segmentation mask. ASSISTANT: when purchasing meat from a grocery store, it is often stored and sold in a certain type of container. what object in the picture could be used for this purpose</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1920, 2560]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1920, 2560])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1920, 2560])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1920, 2560])):  [tensor([[[-0.8047, -0.8047, -0.8047,  ..., -0.7852, -0.7852, -0.7852],
         [-0.8047, -0.8047, -0.8047,  ..., -0.7852, -0.7852, -0.7852],
         [-0.8047, -0.8047, -0.8047,  ..., -0.7852, -0.7852, -0.7852],
         ...,
         [-1.8457, -1.8457, -1.8457,  ..., -1.7559, -1.7559, -1.7559],
         [-1.9309, -1.9309, -1.9309,  ..., -1.8613, -1.8613, -1.8613],
         [-1.9521, -1.9521, -1.9521,  ..., -1.8877, -1.8877, -1.8877]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What object in the picture could be used for defense and firepower in an ancient fort? Please output segmentation mask. ASSISTANT: what object in the picture could be used for defense and firepower in an ancient fort</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[69]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[324]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-2.9844, -2.9762, -2.9375,  ..., -2.7234, -2.6809, -2.6719],
         [-2.9877, -2.9799, -2.9432,  ..., -2.7369, -2.6968, -2.6883],
         [-3.0031, -2.9974, -2.9703,  ..., -2.8003, -2.7717, -2.7656],
         ...,
         [-0.7496, -0.7495, -0.7490,  ..., -0.1595, -0.1840, -0.1892],
         [-0.9053, -0.9062, -0.9103,  ..., -0.4100, -0.4317, -0.4363],
         [-1.4564, -1.4547, -1.4466,  ..., -1.0534, -1.0462, -1.0446]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something showing that they are skating in this image? Please output segmentation mask. ASSISTANT: something showing that they are skating</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 580, 435]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 580, 435])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 580, 435])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 580, 435])):  [tensor([[[-1.8750, -1.7167, -1.2857,  ..., -1.2198, -1.0819, -1.3804],
         [-1.9256, -1.7750, -1.3646,  ..., -1.2231, -1.1226, -1.4260],
         [-2.0636, -1.9336, -1.5795,  ..., -1.2319, -1.2334, -1.5502],
         ...,
         [-2.2829, -2.2240, -2.0638,  ..., -2.3786, -2.3328, -2.5138],
         [-2.0760, -2.0278, -1.8964,  ..., -2.2845, -2.2722, -2.3943],
         [-2.0000, -1.9557, -1.8350,  ..., -2.2500, -2.2500, -2.3504]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Dogs have keen sense of smell, which is why they can be used as drug-sniffing dogs. Which part in the picture gives dogs this characteristic? Please output segmentation mask. ASSISTANT: dogs have keen sense of smell, which is why they can be used as drug-sniffing dogs. which part in the picture gives dogs this characteristic</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[85]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1704, 2272]) | end - start: 1
mask_positions_in_input_ids:  [[340]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1704, 2272])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[-2.5156, -2.5156, -2.5156,  ..., -1.7500, -1.7500, -1.7500],
         [-2.5156, -2.5156, -2.5156,  ..., -1.7500, -1.7500, -1.7500],
         [-2.5156, -2.5156, -2.5156,  ..., -1.7500, -1.7500, -1.7500],
         ...,
         [-2.0456, -2.0456, -2.0456,  ..., -2.2695, -2.2695, -2.2695],
         [-2.3070, -2.3070, -2.3070,  ..., -2.5820, -2.5820, -2.5820],
         [-2.4092, -2.4092, -2.4092,  ..., -2.7041, -2.7041, -2.7041]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n Some birds have long bills that they use to catch food from the water. What part of the bird's body in the picture may have this characteristic? Please output segmentation mask. ASSISTANT: some birds have long bills that they use to catch food from the water. what part of the bird's body in the picture may have this characteristic</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[83]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 800, 1200]) | end - start: 1
mask_positions_in_input_ids:  [[338]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 800, 1200])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 800, 1200])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 800, 1200])):  [tensor([[[-3.3125, -3.3125, -3.2667,  ..., -1.1452, -1.1094, -1.1094],
         [-3.3125, -3.3125, -3.2667,  ..., -1.1452, -1.1094, -1.1094],
         [-3.3521, -3.3521, -3.3092,  ..., -1.1944, -1.1589, -1.1589],
         ...,
         [-2.6500, -2.6500, -2.6715,  ..., -2.2746, -2.2656, -2.2656],
         [-2.6863, -2.6863, -2.7079,  ..., -2.2058, -2.1849, -2.1849],
         [-3.3008, -3.3008, -3.3308,  ..., -2.5254, -2.4883, -2.4883]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n After cooking, consuming food, and preparing for food, where can we throw away the rest of the food and scraps? Please output segmentation mask. ASSISTANT: after cooking, consuming food, and preparing for food, where can we throw away the rest of the food and scraps</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[79]]

 94%|█████████▍| 189/200 [01:18<00:03,  2.85it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 240, 320]) | end - start: 1
mask_positions_in_input_ids:  [[334]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 240, 320])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 240, 320])):  [tensor([[[-5.8433, -4.7010, -4.9687,  ..., -4.8949, -4.9029, -4.8826],
         [-5.2381, -3.8964, -3.2445,  ..., -3.4125, -3.5139, -3.5601],
         [-5.4757, -3.2816, -2.0449,  ..., -2.8125, -2.8625, -3.0666],
         ...,
         [-4.4530, -1.8668,  0.3027,  ...,  2.5898,  2.5051,  2.0512],
         [-4.4282, -2.0268, -0.4484,  ...,  2.1217,  2.0984,  1.5515],
         [-4.7265, -3.1304, -2.3997,  ..., -0.6155, -0.5596, -0.9511]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the person who is most likely to be the girl's trainer in this image? Please output segmentation mask. ASSISTANT: the person who is most likely to be the girl's trainer</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[71]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3456, 2304]) | end - start: 1
mask_positions_in_input_ids:  [[326]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 2304])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3456, 2304])):  [tensor([[[0., 0., 0.,  ..., 1., 1., 0.],
         [0., 0., 0.,  ..., 1., 1., 0.],
         [0., 0., 0.,  ..., 1., 1., 0.],
         ...,
         [0., 0., 0.,  ..., 1., 1., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3456, 2304])):  [tensor([[[-2.5000, -2.5000, -2.5000,  ..., -3.4142, -3.3516, -3.3516],
         [-2.5000, -2.5000, -2.5000,  ..., -3.4142, -3.3516, -3.3516],
         [-2.5000, -2.5000, -2.5000,  ..., -3.4142, -3.3516, -3.3516],
         ...,
         [-1.6406, -1.6406, -1.6406,  ..., -2.8124, -2.7764, -2.7764],
         [-1.6406, -1.6406, -1.6406,  ..., -2.8124, -2.7764, -2.7764],
         [-1.6406, -1.6406, -1.6406,  ..., -2.8124, -2.7764, -2.7764]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n At a car show, visitors can get close to the displayed vehicles to admire their design and features. What part of the car in this picture is open, allowing viewers to see the engine compartment? Please output segmentation mask. ASSISTANT: at a car show, visitors can get close to the displayed vehicles to admire their design and features. what part of the car in this picture is open, allowing viewers to see the engine compartment</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[93]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2356, 3141]) | end - start: 1
mask_positions_in_input_ids:  [[348]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2356, 3141])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2356, 3141])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2356, 3141])):  [tensor([[[-3.1250, -3.1250, -3.1250,  ..., -1.7734, -1.7734, -1.7734],
         [-3.1250, -3.1250, -3.1250,  ..., -1.7734, -1.7734, -1.7734],
         [-3.1250, -3.1250, -3.1250,  ..., -1.7734, -1.7734, -1.7734],
         ...,
         [-0.0229, -0.0229, -0.0229,  ..., -1.2250, -1.2250, -1.2250],
         [-0.2896, -0.2896, -0.2896,  ..., -1.4883, -1.4883, -1.4883],
         [-0.2896, -0.2896, -0.2896,  ..., -1.4883, -1.4883, -1.4883]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When snorkeling or scuba diving, it is important to wear certain equipment to protect the eyes and aid in vision. What object in the picture can be used for this purpose? Please output segmentation mask. ASSISTANT: when snorkeling or scuba diving, it is important to wear certain equipment to protect the eyes and aid in vision. what object in the picture can be used for this purpose</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[89]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 768, 1024]) | end - start: 1
mask_positions_in_input_ids:  [[344]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 768, 1024])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 768, 1024])):  [tensor([[[-2.3750, -2.3750, -2.3057,  ..., -1.7178, -1.6484, -1.6484],
         [-2.3750, -2.3750, -2.3057,  ..., -1.7178, -1.6484, -1.6484],
         [-2.3340, -2.3340, -2.2709,  ..., -1.7118, -1.6484, -1.6484],
         ...,
         [-0.0572, -0.0572, -0.0551,  ..., -0.4029, -0.4217, -0.4217],
         [-0.3194, -0.3194, -0.3186,  ..., -0.7506, -0.7698, -0.7698],
         [-0.8531, -0.8531, -0.8470,  ..., -1.3436, -1.3445, -1.3445]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the places for further exploration in this image? Please output segmentation mask. ASSISTANT: the places for further exploration</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 600, 800]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 600, 800])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 600, 800])):  [tensor([[[-1.8906, -1.8824, -1.8438,  ..., -1.7109, -1.7109, -1.7109],
         [-1.8890, -1.8815, -1.8460,  ..., -1.6888, -1.6891, -1.6892],
         [-1.8813, -1.8770, -1.8569,  ..., -1.5846, -1.5863, -1.5867],
         ...,
         [-0.2203, -0.2073, -0.1461,  ..., -0.5525, -0.5452, -0.5437],
         [-0.6934, -0.6843, -0.6414,  ..., -1.0661, -1.0635, -1.0630],
         [-1.6757, -1.6781, -1.6894,  ..., -2.3126, -2.3093, -2.3087]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n When enjoying an ice cream sundae, what can we use to scoop up the whipped cream and place it on top of the ice cream? Please output segmentation mask. ASSISTANT: when enjoying an ice cream sundae, what can we use to scoop up the whipped cream and place it on top of the ice cream</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[86]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2048, 1536]) | end - start: 1
mask_positions_in_input_ids:  [[341]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2048, 1536])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2048, 1536])):  [tensor([[[0., 0., 0.,  ..., 1., 1., 1.],
         [0., 0., 0.,  ..., 1., 1., 0.],
         [0., 0., 0.,  ..., 1., 1., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2048, 1536])):  [tensor([[[-1.2891, -1.2891, -1.2891,  ..., -2.3354, -2.2778, -2.2490],
         [-1.2891, -1.2891, -1.2891,  ..., -2.3354, -2.2778, -2.2490],
         [-1.2891, -1.2891, -1.2891,  ..., -2.3354, -2.2778, -2.2490],
         ...,
         [-1.0859, -1.0859, -1.0859,  ..., -0.5858, -0.8995, -1.0564],
         [-1.0859, -1.0859, -1.0859,  ..., -0.5858, -0.8995, -1.0564],
         [-1.0859, -1.0859, -1.0859,  ..., -0.5858, -0.8995, -1.0564]]],

 98%|█████████▊| 196/200 [01:20<00:01,  3.30it/s]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the person who is speaking currently in this image? Please output segmentation mask. ASSISTANT: the person who is speaking currently</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[63]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 3456, 4608]) | end - start: 1
mask_positions_in_input_ids:  [[318]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 3456, 4608])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 3456, 4608])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 3456, 4608])):  [tensor([[[-9.3750, -9.3750, -9.3750,  ..., -3.7969, -3.7969, -3.7969],
         [-9.3750, -9.3750, -9.3750,  ..., -3.7969, -3.7969, -3.7969],
         [-9.3750, -9.3750, -9.3750,  ..., -3.7969, -3.7969, -3.7969],
         ...,
         [-7.1467, -7.1467, -7.1467,  ..., -5.4965, -5.4965, -5.4965],
         [-7.1992, -7.1992, -7.1992,  ..., -5.5469, -5.5469, -5.5469],
         [-7.1992, -7.1992, -7.1992,  ..., -5.5469, -5.5469, -5.5469]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the ball that can only be hit into the hole at last in this image? Please output segmentation mask. ASSISTANT: the ball that can only be hit into the hole at last</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[69]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 960, 1280]) | end - start: 1
mask_positions_in_input_ids:  [[324]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 960, 1280])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 960, 1280])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 960, 1280])):  [tensor([[[ -4.4062,  -4.4062,  -4.4004,  ...,  -4.7598,  -4.7812,  -4.7812],
         [ -4.4062,  -4.4062,  -4.4004,  ...,  -4.7598,  -4.7812,  -4.7812],
         [ -3.5762,  -3.5762,  -3.5580,  ...,  -3.7990,  -3.8340,  -3.8340],
         ...,
         [ -2.5332,  -2.5332,  -2.5016,  ...,  -3.2448,  -3.3301,  -3.3301],
         [ -4.8000,  -4.8000,  -4.8168,  ...,  -6.6781,  -6.7499,  -6.7499],
         [ -7.1133,  -7.1133,  -7.1828,  ..., -10.1870, -10.2500, -10.2500]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the reflection of the camera in the mirror in this image? Please output segmentation mask. ASSISTANT: the reflection of the camera in the mirror</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2,
         2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[65]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2880, 1920]) | end - start: 1
mask_positions_in_input_ids:  [[320]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2880, 1920])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2880, 1920])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2880, 1920])):  [tensor([[[-1.3203, -1.3203, -1.3203,  ..., -0.9510, -0.9645, -0.9658],
         [-1.3203, -1.3203, -1.3203,  ..., -0.9510, -0.9645, -0.9658],
         [-1.3203, -1.3203, -1.3203,  ..., -0.9510, -0.9645, -0.9658],
         ...,
         [-0.7188, -0.7188, -0.7188,  ..., -1.1499, -1.2574, -1.2676],
         [-0.7188, -0.7188, -0.7188,  ..., -1.1499, -1.2574, -1.2676],
         [-0.7188, -0.7188, -0.7188,  ..., -1.1499, -1.2574, -1.2676]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In some rural areas, horse-drawn carts are still used for transportation and carrying goods. What is the main source of power that drives the cart in the picture? Please output segmentation mask. ASSISTANT: in some rural areas, horse-drawn carts are still used for transportation and carrying goods. what is the main source of power that drives the cart in the picture</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[87]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 2304, 3456]) | end - start: 1
mask_positions_in_input_ids:  [[342]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 2304, 3456])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 2304, 3456])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 2304, 3456])):  [tensor([[[-4.9688, -4.9688, -4.9688,  ..., -4.4688, -4.4688, -4.4688],
         [-4.9688, -4.9688, -4.9688,  ..., -4.4688, -4.4688, -4.4688],
         [-4.9688, -4.9688, -4.9688,  ..., -4.4688, -4.4688, -4.4688],
         ...,
         [-1.0828, -1.0828, -1.0828,  ..., -2.3708, -2.3708, -2.3708],
         [-1.1992, -1.1992, -1.1992,  ..., -2.5088, -2.5088, -2.5088],
         [-1.1992, -1.1992, -1.1992,  ..., -2.5088, -2.5088, -2.5088]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n In case of a fire, it is important to have access to fire safety equipment. What object in the picture is specifically designed to store and release fire extinguishing substances? Please output segmentation mask. ASSISTANT: in case of a fire, it is important to have access to fire safety equipment. what object in the picture is specifically designed to store and release fire extinguishing substances</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 0]], device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[88]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 509, 763]) | end - start: 1
mask_positions_in_input_ids:  [[343]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 509, 763])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 509, 763])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 509, 763])):  [tensor([[[-1.1641, -1.1302, -0.9854,  ..., -0.0412,  0.0147,  0.0277],
         [-1.1253, -1.0927, -0.9533,  ..., -0.0075,  0.0422,  0.0539],
         [-0.9590, -0.9319, -0.8160,  ...,  0.1370,  0.1604,  0.1658],
         ...,
         [ 0.6377,  0.6346,  0.6212,  ...,  0.5780,  0.4969,  0.4780],
         [ 0.2340,  0.2307,  0.2170,  ...,  0.1675,  0.1542,  0.1511],
         [-0.2855, -0.2880, -0.2988,  ..., -0.5647, -0.5271, -0.5183]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is the solitary tree in this image? Please output segmentation mask. ASSISTANT: the solitary tree</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[61]]

100%|██████████| 200/200 [01:22<00:00,  2.43it/s]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1536, 2048]) | end - start: 1
mask_positions_in_input_ids:  [[316]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1536, 2048])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1536, 2048])):  [tensor([[[-3.8281, -3.8281, -3.8281,  ..., -2.8125, -2.8125, -2.8125],
         [-3.8281, -3.8281, -3.8281,  ..., -2.8125, -2.8125, -2.8125],
         [-3.8281, -3.8281, -3.8281,  ..., -2.8125, -2.8125, -2.8125],
         ...,
         [-2.5312, -2.5312, -2.5312,  ..., -2.7920, -2.7920, -2.7920],
         [-3.0938, -3.0938, -3.0938,  ..., -3.7471, -3.7471, -3.7471],
         [-3.3750, -3.3750, -3.3750,  ..., -4.2246, -4.2246, -4.2246]]],
       device='cuda:0')]
>> (validate) input_dict[conversation_list]:  ["A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the human's questions. USER: <im_start><image><im_end>\n What is something used for contacting other people in this image? Please output segmentation mask. ASSISTANT: something used for contacting other people</s>"]
>> (validate) per_token_labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 0]],
       device='cuda:0')
>> (validate) mask_positions_in_input_ids:  [[64]]
>> (validate) sampled_classes_list:  [None]
>> offset:  tensor([0, 1], device='cuda:0')
>> is_mask_per_conv: True | masks_list[batch_idx].shape: torch.Size([1, 1704, 2272]) | end - start: 1
mask_positions_in_input_ids:  [[319]]
>> (is_mask_per_conv) gt_mask.shape:  torch.Size([1, 1704, 2272])
(PLUM.py) >> gt_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')]
(PLUM.py) >> pred_masks (shape: torch.Size([1, 1704, 2272])):  [tensor([[[-8.0625, -8.0625, -8.0625,  ..., -7.3750, -7.3750, -7.3750],
         [-8.0625, -8.0625, -8.0625,  ..., -7.3750, -7.3750, -7.3750],
         [-8.0625, -8.0625, -8.0625,  ..., -7.3750, -7.3750, -7.3750],
         ...,
         [-7.4522, -7.4522, -7.4522,  ..., -6.9973, -6.9973, -6.9973],
         [-7.9276, -7.9276, -7.9276,  ..., -7.6734, -7.6734, -7.6734],
         [-8.1133, -8.1133, -8.1133,  ..., -7.9375, -7.9375, -7.9375]]],
       device='cuda:0')]
giou: 0.0743, ciou: 0.0665 | BIO per cls acc: O=0.0004, B=0.0400, I=0.9378