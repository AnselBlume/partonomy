2025-05-11 20:33:13,330 INFO    StreamThr :2217255 [internal.py:wandb_internal():86] W&B internal server running at pid: 2217255, started at: 2025-05-11 20:33:13.329679
2025-05-11 20:33:13,331 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status
2025-05-11 20:33:13,332 INFO    WriterThread:2217255 [datastore.py:open_for_write():85] open: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/run-vmetjj4s.wandb
2025-05-11 20:33:13,333 DEBUG   SenderThread:2217255 [sender.py:send():380] send: header
2025-05-11 20:33:13,341 DEBUG   SenderThread:2217255 [sender.py:send():380] send: run
2025-05-11 20:33:13,572 INFO    SenderThread:2217255 [dir_watcher.py:__init__():211] watching files in: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files
2025-05-11 20:33:13,572 INFO    SenderThread:2217255 [sender.py:_start_run_threads():1124] run started: vmetjj4s with start time 1747013593.330052
2025-05-11 20:33:13,578 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: check_version
2025-05-11 20:33:13,578 DEBUG   SenderThread:2217255 [sender.py:send_request():407] send_request: check_version
2025-05-11 20:33:13,656 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: run_start
2025-05-11 20:33:14,208 DEBUG   HandlerThread:2217255 [system_info.py:__init__():32] System info init
2025-05-11 20:33:14,209 DEBUG   HandlerThread:2217255 [system_info.py:__init__():47] System info init done
2025-05-11 20:33:14,209 INFO    HandlerThread:2217255 [system_monitor.py:start():194] Starting system monitor
2025-05-11 20:33:14,209 INFO    SystemMonitor:2217255 [system_monitor.py:_start():158] Starting system asset monitoring threads
2025-05-11 20:33:14,209 INFO    HandlerThread:2217255 [system_monitor.py:probe():214] Collecting system info
2025-05-11 20:33:14,210 INFO    SystemMonitor:2217255 [interfaces.py:start():190] Started cpu monitoring
2025-05-11 20:33:14,210 INFO    SystemMonitor:2217255 [interfaces.py:start():190] Started disk monitoring
2025-05-11 20:33:14,211 INFO    SystemMonitor:2217255 [interfaces.py:start():190] Started gpu monitoring
2025-05-11 20:33:14,212 INFO    SystemMonitor:2217255 [interfaces.py:start():190] Started memory monitoring
2025-05-11 20:33:14,212 INFO    SystemMonitor:2217255 [interfaces.py:start():190] Started network monitoring
2025-05-11 20:33:14,285 DEBUG   HandlerThread:2217255 [system_info.py:probe():196] Probing system
2025-05-11 20:33:14,288 DEBUG   HandlerThread:2217255 [system_info.py:_probe_git():181] Probing git
2025-05-11 20:33:14,298 DEBUG   HandlerThread:2217255 [system_info.py:_probe_git():189] Probing git done
2025-05-11 20:33:14,298 DEBUG   HandlerThread:2217255 [system_info.py:probe():244] Probing system done
2025-05-11 20:33:14,298 DEBUG   HandlerThread:2217255 [system_monitor.py:probe():223] {'os': 'Linux-5.15.0-130-generic-x86_64-with-glibc2.35', 'python': '3.10.13', 'heartbeatAt': '2025-05-12T01:33:14.285243', 'startedAt': '2025-05-12T01:33:13.322050', 'docker': None, 'cuda': None, 'args': ('--local_rank=0', '--version=liuhaotian/llava-llama-2-13b-chat-lightning-preview', '--dataset_dir=/shared/nas/data/m1/jk100/code/OpenAttrLibrary/LISA/dataset', '--vision_pretrained=/shared/nas/data/m1/jk100/code/OpenAttrLibrary/LISA/weights/sam_vit_h_4b8939.pth', '--zero_shot_ckpt_path=runs/plum-13b_kld_0.1_focal_tversky_8_v1_0shot/plum-13b_kld_0.1_focal_tversky_8_v1_0shot_bidirbio_2048_accum_10_maxlen512_epochs25_segloss_2_bce_loss_2_kld_loss_0_dice_loss_8_bidir_bio_train_prompt_enc_ckpt_model', '--dataset=explanatory_seg', '--explanatory_seg_data', '--partonomy_dataset_split=partimagenet|paco_lvis|pascal_part', '--sample_one_question_per_image', '--random_seed=42', '--sample_rates=1', '--batch_size=8', '--grad_accumulation_steps', '10', '--ce_loss_weight=1.0', '--dice_type=focal_tversky', '--dice_loss_weight=8', '--bce_loss_weight=2.0', '--kld_loss_weight=0.1', '--seg_cls_loss_weight=2', '--exp_name=plum-13b_kld_0.1_focal_tversky_8_v1_partonomy_ft', '--precision=bf16', '--model_max_length', '512', '--dice_scale_factor', '1000.0', '--epochs', '20', '--train_mask_prompt_encoder', '--use_bidir_bio', '--focal_tversky_alpha=0.7', '--focal_tversky_beta=0.3', '--bidir_dim_feedforward', '2048', '--lr', '3e-4', '--use_feedback_loop', '--limit_batches', '500', '--auto_resume'), 'state': 'running', 'program': '/shared/nas2/jk100/partonomy_private/src/models/PLUM/plum_train_ds.py', 'codePathLocal': 'plum_train_ds.py', 'codePath': 'src/models/PLUM/plum_train_ds.py', 'git': {'remote': 'https://github.com/AnselBlume/partonomy_private.git', 'commit': '803bca9401deab7c9b870c6a5bd0c6e83d9743f0'}, 'email': 'jeonghwankim123@gmail.com', 'root': '/shared/nas2/jk100/partonomy_private', 'host': 'blender15.cs.illinois.edu', 'username': 'jk100', 'executable': '/shared/nas/data/m1/jk100/.conda/envs/llava/bin/python', 'cpu_count': 64, 'cpu_count_logical': 128, 'cpu_freq': {'current': 2332.2431171875005, 'min': 0.0, 'max': 0.0}, 'cpu_freq_per_core': [{'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2952.196, 'min': 0.0, 'max': 0.0}, {'current': 2935.328, 'min': 0.0, 'max': 0.0}, {'current': 2946.942, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2948.607, 'min': 0.0, 'max': 0.0}, {'current': 2943.243, 'min': 0.0, 'max': 0.0}, {'current': 2948.219, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2940.224, 'min': 0.0, 'max': 0.0}, {'current': 2941.002, 'min': 0.0, 'max': 0.0}, {'current': 2938.86, 'min': 0.0, 'max': 0.0}, {'current': 2943.447, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2955.333, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2867.019, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 3000.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2931.465, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2931.984, 'min': 0.0, 'max': 0.0}, {'current': 2897.824, 'min': 0.0, 'max': 0.0}, {'current': 2915.945, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2940.321, 'min': 0.0, 'max': 0.0}, {'current': 2905.817, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2928.374, 'min': 0.0, 'max': 0.0}, {'current': 2927.309, 'min': 0.0, 'max': 0.0}, {'current': 2920.42, 'min': 0.0, 'max': 0.0}, {'current': 2922.967, 'min': 0.0, 'max': 0.0}, {'current': 2936.525, 'min': 0.0, 'max': 0.0}, {'current': 2921.126, 'min': 0.0, 'max': 0.0}, {'current': 2883.995, 'min': 0.0, 'max': 0.0}, {'current': 2917.689, 'min': 0.0, 'max': 0.0}, {'current': 2922.158, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2905.468, 'min': 0.0, 'max': 0.0}, {'current': 2917.954, 'min': 0.0, 'max': 0.0}, {'current': 2914.189, 'min': 0.0, 'max': 0.0}, {'current': 2919.899, 'min': 0.0, 'max': 0.0}, {'current': 2923.326, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2912.221, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2933.518, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2905.609, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2869.739, 'min': 0.0, 'max': 0.0}, {'current': 2868.4, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2906.887, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2965.163, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2918.907, 'min': 0.0, 'max': 0.0}, {'current': 2874.75, 'min': 0.0, 'max': 0.0}, {'current': 2887.461, 'min': 0.0, 'max': 0.0}, {'current': 2888.267, 'min': 0.0, 'max': 0.0}, {'current': 2905.025, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2872.933, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 3000.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2873.864, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2885.344, 'min': 0.0, 'max': 0.0}, {'current': 2886.929, 'min': 0.0, 'max': 0.0}, {'current': 2880.34, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2866.01, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2874.265, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2861.556, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2879.62, 'min': 0.0, 'max': 0.0}, {'current': 2848.14, 'min': 0.0, 'max': 0.0}, {'current': 2869.105, 'min': 0.0, 'max': 0.0}, {'current': 2879.589, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2824.605, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2859.42, 'min': 0.0, 'max': 0.0}, {'current': 2868.567, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2877.954, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2877.496, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2878.028, 'min': 0.0, 'max': 0.0}, {'current': 2856.158, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}, {'current': 2900.043, 'min': 0.0, 'max': 0.0}, {'current': 2100.0, 'min': 0.0, 'max': 0.0}], 'disk': {'/': {'total': 428.1472702026367, 'used': 171.96131134033203}}, 'gpu': 'NVIDIA H100 80GB HBM3', 'gpu_count': 8, 'gpu_devices': [{'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}, {'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}, {'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}, {'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}, {'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}, {'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}, {'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}, {'name': 'NVIDIA H100 80GB HBM3', 'memory_total': 85520809984}], 'memory': {'total': 1007.3801879882812}}
2025-05-11 20:33:14,299 INFO    HandlerThread:2217255 [system_monitor.py:probe():224] Finished collecting system info
2025-05-11 20:33:14,299 INFO    HandlerThread:2217255 [system_monitor.py:probe():227] Publishing system info
2025-05-11 20:33:14,299 DEBUG   HandlerThread:2217255 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2025-05-11 20:33:14,300 DEBUG   HandlerThread:2217255 [system_info.py:_save_pip():68] Saving pip packages done
2025-05-11 20:33:14,300 DEBUG   HandlerThread:2217255 [system_info.py:_save_conda():75] Saving list of conda packages installed into the current environment
2025-05-11 20:33:14,573 INFO    Thread-12 :2217255 [dir_watcher.py:_on_file_created():271] file/dir created: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files/requirements.txt
2025-05-11 20:33:14,574 INFO    Thread-12 :2217255 [dir_watcher.py:_on_file_created():271] file/dir created: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files/conda-environment.yaml
2025-05-11 20:33:19,348 DEBUG   HandlerThread:2217255 [system_info.py:_save_conda():87] Saving conda packages done
2025-05-11 20:33:19,349 INFO    HandlerThread:2217255 [system_monitor.py:probe():229] Finished publishing system info
2025-05-11 20:33:19,355 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:33:19,356 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: keepalive
2025-05-11 20:33:19,356 DEBUG   SenderThread:2217255 [sender.py:send():380] send: files
2025-05-11 20:33:19,356 INFO    SenderThread:2217255 [sender.py:_save_file():1380] saving file wandb-metadata.json with policy now
2025-05-11 20:33:19,361 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: stop_status
2025-05-11 20:33:19,361 DEBUG   SenderThread:2217255 [sender.py:send_request():407] send_request: stop_status
2025-05-11 20:33:19,363 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: internal_messages
2025-05-11 20:33:19,465 DEBUG   SenderThread:2217255 [sender.py:send():380] send: telemetry
2025-05-11 20:33:19,576 INFO    Thread-12 :2217255 [dir_watcher.py:_on_file_modified():288] file/dir modified: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files/conda-environment.yaml
2025-05-11 20:33:19,576 INFO    Thread-12 :2217255 [dir_watcher.py:_on_file_created():271] file/dir created: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files/output.log
2025-05-11 20:33:19,576 INFO    Thread-12 :2217255 [dir_watcher.py:_on_file_created():271] file/dir created: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files/wandb-metadata.json
2025-05-11 20:33:19,650 INFO    wandb-upload_0:2217255 [upload_job.py:push():131] Uploaded file /tmp/tmpg_defk6lwandb/b2ae50bo-wandb-metadata.json
2025-05-11 20:33:21,578 INFO    Thread-12 :2217255 [dir_watcher.py:_on_file_modified():288] file/dir modified: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files/output.log
2025-05-11 20:33:24,466 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:33:29,467 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:33:34,362 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: stop_status
2025-05-11 20:33:34,363 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: internal_messages
2025-05-11 20:33:34,363 DEBUG   SenderThread:2217255 [sender.py:send_request():407] send_request: stop_status
2025-05-11 20:33:35,453 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:33:40,454 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:33:45,459 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:33:46,603 INFO    Thread-12 :2217255 [dir_watcher.py:_on_file_modified():288] file/dir modified: /shared/nas2/jk100/partonomy_private/src/models/PLUM/wandb/run-20250511_203313-vmetjj4s/files/config.yaml
2025-05-11 20:33:49,362 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: stop_status
2025-05-11 20:33:49,363 DEBUG   SenderThread:2217255 [sender.py:send_request():407] send_request: stop_status
2025-05-11 20:33:49,410 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: internal_messages
2025-05-11 20:33:51,456 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:33:56,457 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:34:01,458 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:34:04,362 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: stop_status
2025-05-11 20:34:04,362 DEBUG   SenderThread:2217255 [sender.py:send_request():407] send_request: stop_status
2025-05-11 20:34:04,406 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: internal_messages
2025-05-11 20:34:07,443 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:34:12,444 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:34:14,213 DEBUG   SystemMonitor:2217255 [system_monitor.py:_start():172] Starting system metrics aggregation loop
2025-05-11 20:34:14,216 DEBUG   SenderThread:2217255 [sender.py:send():380] send: stats
2025-05-11 20:34:18,217 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
2025-05-11 20:34:19,362 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: stop_status
2025-05-11 20:34:19,362 DEBUG   SenderThread:2217255 [sender.py:send_request():407] send_request: stop_status
2025-05-11 20:34:19,406 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: internal_messages
2025-05-11 20:34:23,517 DEBUG   HandlerThread:2217255 [handler.py:handle_request():146] handle_request: status_report
